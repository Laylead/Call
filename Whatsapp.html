<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camsilo - Premium Adult Entertainment</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #e91e63;
            --secondary: #9c27b0;
            --dark: #121212;
            --darker: #0a0a0a;
            --light: #f5f5f5;
            --gray: #6c757d;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --surface: #1e1e1e;
            --surface-light: #2d2d2d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Header Styles */
        header {
            background: rgba(18, 18, 18, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 0.5px;
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--light);
            text-decoration: none;
            transition: all 0.3s;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            font-size: 0.95rem;
        }

        .nav-links a:hover, .nav-links a.active {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
        }

        .auth-buttons {
            display: flex;
            gap: 0.8rem;
        }

        .btn {
            padding: 0.7rem 1.5rem;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(233, 30, 99, 0.4);
        }

        .btn-outline {
            border: 1px solid var(--primary);
            color: var(--primary);
            background: transparent;
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-2px);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: black;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        /* Hero Section */
        .hero {
            margin-top: 80px;
            padding: 8rem 2rem;
            text-align: center;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(18, 18, 18, 0.8), rgba(10, 10, 10, 0.9));
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
        }

        .hero p {
            font-size: 1.2rem;
            margin-bottom: 2.5rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        /* Models Grid */
        .models-section {
            padding: 5rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .section-title {
            text-align: center;
            margin-bottom: 3rem;
            font-size: 2.2rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
            padding-bottom: 1rem;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 3px;
        }

        .models-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2rem;
        }

        .model-card {
            background: var(--surface);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .model-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 30px rgba(233, 30, 99, 0.2);
            border-color: rgba(233, 30, 99, 0.3);
        }

        .model-image-container {
            position: relative;
            overflow: hidden;
        }

        .model-image {
            width: 100%;
            height: 380px;
            object-fit: cover;
            transition: transform 0.4s;
        }

        .model-card:hover .model-image {
            transform: scale(1.05);
        }

        .model-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.3rem;
        }

        .model-info {
            padding: 1.5rem;
        }

        .model-name {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.8rem;
            font-size: 1.3rem;
        }

        .verified {
            color: #1da1f2;
            font-size: 1.2rem;
        }

        .model-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.2rem;
            padding: 0.8rem 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .likes, .comments {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--light);
            font-weight: 500;
        }

        .like-btn, .comment-btn {
            background: none;
            border: none;
            color: var(--light);
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.2rem;
            padding: 0.5rem;
            border-radius: 50%;
        }

        .like-btn:hover {
            color: var(--primary);
            background: rgba(233, 30, 99, 0.1);
            transform: scale(1.2);
        }

        .comment-btn:hover {
            color: var(--secondary);
            background: rgba(156, 39, 176, 0.1);
            transform: scale(1.2);
        }

        .liked {
            color: var(--primary) !important;
            animation: pulse 0.6s ease-in-out;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.3); }
            100% { transform: scale(1); }
        }

        .book-btn {
            width: 100%;
            padding: 0.9rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            font-size: 1rem;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .book-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 18px rgba(233, 30, 99, 0.4);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 2000;
            backdrop-filter: blur(5px);
            animation: fadeIn 0.3s ease-out;
            overflow-y: auto;
            padding: 1rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            position: relative;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--surface);
            padding: 2.5rem;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 500px;
            width: 95%;
            text-align: center;
            animation: modalAppear 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        @keyframes modalAppear {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1);
            }
        }

        .modal-image {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 1.5rem;
            border: 3px solid var(--primary);
            box-shadow: 0 6px 18px rgba(233, 30, 99, 0.3);
        }

        .modal h2 {
            margin-bottom: 1rem;
            color: var(--primary);
            font-size: 1.8rem;
        }

        .modal p {
            margin-bottom: 2rem;
            line-height: 1.6;
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--light);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: var(--surface-light);
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(233, 30, 99, 0.2);
        }

        /* Admin Panel */
        .admin-panel {
            display: none;
            padding: 2rem;
            background: var(--surface);
            border-radius: 12px;
            margin: 2rem auto;
            max-width: 1400px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            background: var(--surface-light);
            padding: 1rem;
            border-radius: 8px;
        }

        .admin-tab {
            padding: 0.8rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: var(--light);
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .admin-tab:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .admin-tab.active {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
        }

        .admin-content {
            display: none;
            background: var(--surface-light);
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .admin-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Comments Section */
        .comments-section {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comment {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
        }

        .comment-form {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .comment-input {
            flex: 1;
            padding: 0.7rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: var(--surface-light);
            color: white;
        }

        .comment-submit {
            padding: 0.7rem 1.2rem;
            border-radius: 8px;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
        }

        /* Private Content */
        .private-content {
            display: none;
            padding: 4rem 2rem;
            background: linear-gradient(135deg, rgba(233, 30, 99, 0.1), rgba(156, 39, 176, 0.1));
            border-radius: 12px;
            margin: 2rem auto;
            max-width: 1400px;
            border: 1px solid rgba(233, 30, 99, 0.2);
        }

        /* User Info */
        .user-info {
            background: linear-gradient(135deg, rgba(233, 30, 99, 0.1), rgba(156, 39, 176, 0.1));
            padding: 2rem;
            border-radius: 12px;
            margin: 2rem auto;
            max-width: 1400px;
            border: 1px solid rgba(233, 30, 99, 0.2);
            text-align: center;
        }

        .account-timer {
            font-size: 1.3rem;
            color: var(--primary);
            margin-top: 1rem;
            font-weight: bold;
        }

        .expired {
            color: var(--danger);
            animation: pulse 2s infinite;
        }

        /* Session Management */
        .session-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary);
        }

        .session-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .session-status {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .status-pending {
            background: rgba(255, 152, 0, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .status-confirmed {
            background: rgba(76, 175, 80, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .status-cancelled {
            background: rgba(244, 67, 54, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .session-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* Fake Interaction Controls */
        .fake-interaction-controls {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        /* Model Dropdown */
        .model-dropdown {
            position: relative;
            margin-top: 1rem;
        }

        .dropdown-btn {
            width: 100%;
            padding: 0.7rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--light);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s;
        }

        .dropdown-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: var(--surface-light);
            border-radius: 8px;
            margin-top: 0.5rem;
            padding: 1rem;
            z-index: 10;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-height: 300px;
            overflow-y: auto;
        }

        .dropdown-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .public-post {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .public-post img {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        /* Responsive Design */
        @media (max-width: 1024px) {
            .models-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 768px) {
            header {
                padding: 1rem;
            }

            .nav-links {
                display: none;
            }

            .hero {
                padding: 6rem 1rem;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .models-section {
                padding: 3rem 1rem;
            }

            .models-grid {
                grid-template-columns: 1fr;
            }

            .admin-tabs {
                flex-direction: column;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 2rem 1.5rem;
                width: 95%;
            }

            .modal-buttons {
                flex-direction: column;
            }

            .auth-buttons {
                gap: 0.5rem;
            }

            .btn {
                padding: 0.6rem 1.2rem;
                font-size: 0.85rem;
            }

            .admin-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .session-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
        }

        @media (max-width: 480px) {
            .hero h1 {
                font-size: 2rem;
            }

            .section-title {
                font-size: 1.8rem;
            }

            .model-image {
                height: 300px;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }
        }

        /* Loading Spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast Overrides */
        .toast-success {
            background: var(--success) !important;
        }

        .toast-error {
            background: var(--danger) !important;
        }

        .toast-info {
            background: var(--secondary) !important;
        }

        /* Sexy Subscription Popup */
        .sexy-popup {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 2px solid var(--primary);
            box-shadow: 0 10px 30px rgba(233, 30, 99, 0.4);
        }

        .sexy-popup .modal-image {
            border: 3px solid var(--primary);
            box-shadow: 0 0 20px rgba(233, 30, 99, 0.5);
        }

        .sexy-popup h2 {
            color: var(--primary);
            text-shadow: 0 2px 10px rgba(233, 30, 99, 0.3);
        }

        .sexy-popup p {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.9);
        }

        /* Public Posts Modal */
        .public-posts-modal .modal-content {
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .public-posts-container {
            display: grid;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .public-post-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .public-post-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }

        .public-post-content {
            padding: 1rem;
        }

        .public-post-description {
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .public-post-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 0.8rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Chat Styles */
        .chat-modal .modal-content {
            max-width: 800px;
            max-height: 80vh;
            display: flex;
            flex-direction: column;
        }

        .chat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            margin-bottom: 1rem;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            max-height: 400px;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .message {
            margin-bottom: 1rem;
            padding: 0.8rem;
            border-radius: 8px;
            max-width: 80%;
        }

        .message.user {
            background: rgba(233, 30, 99, 0.2);
            margin-left: auto;
            border-bottom-right-radius: 2px;
        }

        .message.model {
            background: rgba(156, 39, 176, 0.2);
            margin-right: auto;
            border-bottom-left-radius: 2px;
        }

        .message.admin {
            background: rgba(76, 175, 80, 0.2);
            margin-right: auto;
            border-bottom-left-radius: 2px;
        }

        .message-sender {
            font-weight: bold;
            font-size: 0.8rem;
            margin-bottom: 0.3rem;
        }

        .message-text {
            font-size: 0.9rem;
        }

        .message-time {
            font-size: 0.7rem;
            opacity: 0.7;
            text-align: right;
            margin-top: 0.3rem;
        }

        .chat-input-container {
            display: flex;
            gap: 0.5rem;
        }

        .chat-input {
            flex: 1;
            padding: 0.8rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: var(--surface-light);
            color: white;
        }

        .chat-send {
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
        }

        .conversation-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .conversation-item {
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            cursor: pointer;
            transition: background 0.3s;
        }

        .conversation-item:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .conversation-item.active {
            background: rgba(233, 30, 99, 0.1);
            border-left: 3px solid var(--primary);
        }

        .conversation-user {
            font-weight: bold;
        }

        .conversation-preview {
            font-size: 0.8rem;
            opacity: 0.7;
            margin-top: 0.3rem;
        }

        .conversation-time {
            font-size: 0.7rem;
            opacity: 0.5;
            margin-top: 0.3rem;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="nav-container">
            <div class="logo">Camsilo</div>
            <nav class="nav-links">
                <a href="#home" class="active">Home</a>
                <a href="#models">Models</a>
                <a href="#premium">Premium</a>
                <a href="#about">About</a>
            </nav>
            <div class="auth-buttons" id="authButtons">
                <button class="btn btn-outline" onclick="openLoginModal()">
                    <i class="fas fa-user"></i>Login
                </button>
                <button class="btn btn-primary" onclick="openAdminLogin()">
                    <i class="fas fa-cog"></i>Admin
                </button>
            </div>
        </div>
    </header>

    <!-- Hero Section -->
    <section class="hero" id="home">
        <div class="hero-content">
            <h1>Premium Adult Entertainment</h1>
            <p>Experience the ultimate in adult entertainment with our exclusive models. Premium content, private shows, and unforgettable experiences.</p>
            <button class="btn btn-primary" onclick="scrollToModels()">
                <i class="fas fa-star"></i>Explore Models
            </button>
        </div>
    </section>

    <!-- Models Section -->
    <section class="models-section" id="models">
        <h2 class="section-title">Featured Models</h2>
        <div class="models-grid" id="modelsGrid">
            <!-- Models will be loaded here -->
        </div>
    </section>

    <!-- Private Content Section -->
    <section class="private-content" id="privateContent">
        <h2 class="section-title">Exclusive Members Content</h2>
        <div id="privateContentGrid" class="models-grid">
            <!-- Private content will be loaded here -->
        </div>
    </section>

    <!-- User Info Section -->
    <section class="user-info" id="userInfo" style="display: none;">
        <h2>Your Premium Account</h2>
        <div class="form-row">
            <div>
                <strong>Account Created:</strong> <span id="accountCreated">-</span>
            </div>
            <div>
                <strong>Expires:</strong> <span id="accountExpires">-</span>
            </div>
        </div>
        <div class="account-timer" id="accountTimer"></div>
        <button class="btn btn-primary" onclick="renewAccount()" style="margin-top: 1rem;">
            <i class="fas fa-sync-alt"></i>Renew Subscription
        </button>
    </section>

    <!-- Admin Panel -->
    <section class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h2 style="background: linear-gradient(45deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                <i class="fas fa-crown"></i> Admin Control Panel
            </h2>
            <button class="btn btn-danger" onclick="adminLogout()">
                <i class="fas fa-sign-out-alt"></i>Logout
            </button>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" onclick="switchAdminTab('models')">
                <i class="fas fa-users"></i>Manage Models
            </button>
            <button class="admin-tab" onclick="switchAdminTab('users')">
                <i class="fas fa-user-friends"></i>Manage Users
            </button>
            <button class="admin-tab" onclick="switchAdminTab('sessions')">
                <i class="fas fa-video"></i>Session Requests
            </button>
            <button class="admin-tab" onclick="switchAdminTab('content')">
                <i class="fas fa-photo-video"></i>Content Control
            </button>
            <button class="admin-tab" onclick="switchAdminTab('posts')">
                <i class="fas fa-bullhorn"></i>Broadcast Posts
            </button>
            <button class="admin-tab" onclick="switchAdminTab('chats')">
                <i class="fas fa-comments"></i>Chat Management
            </button>
            <button class="admin-tab" onclick="switchAdminTab('settings')">
                <i class="fas fa-cogs"></i>Website Settings
            </button>
        </div>

        <!-- Models Tab -->
        <div class="admin-content active" id="modelsTab">
            <h3><i class="fas fa-users"></i> Model Management</h3>
            <form id="modelForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>Model Name *</label>
                        <input type="text" id="modelName" required placeholder="Enter model name">
                    </div>
                    <div class="form-group">
                        <label>Verified</label>
                        <select id="modelVerified">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Image URL *</label>
                    <input type="text" id="modelImage" required placeholder="https://example.com/image.jpg">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Likes Count</label>
                        <input type="number" id="modelLikes" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label>Comments to Show</label>
                        <input type="number" id="modelCommentsCount" value="3" min="0" max="10">
                    </div>
                </div>

                <div class="form-group">
                    <label>Comments (one per line)</label>
                    <textarea id="modelComments" rows="4" placeholder="Add comments that will be displayed..."></textarea>
                </div>

                <div class="form-group">
                    <label>Public Posts (one per line, format: image_url|description)</label>
                    <textarea id="modelPublicPosts" rows="4" placeholder="https://example.com/image1.jpg|My sexy public post description"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Video Call Link</label>
                        <input type="text" id="videoCallLink" placeholder="https://zoom.us/j/...">
                    </div>
                    <div class="form-group">
                        <label>Content Type</label>
                        <select id="contentType">
                            <option value="public">Public</option>
                            <option value="private">Private (Members Only)</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Embed Video URL (Optional)</label>
                    <input type="text" id="embedVideo" placeholder="https://youtube.com/embed/...">
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Add Model
                </button>
            </form>

            <div class="card-grid" id="modelsList">
                <!-- Existing models will be listed here -->
            </div>
        </div>

        <!-- Users Tab -->
        <div class="admin-content" id="usersTab">
            <h3><i class="fas fa-user-friends"></i> User Management</h3>
            <form id="userForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>User Email *</label>
                        <input type="email" id="userEmail" required placeholder="user@example.com">
                    </div>
                    <div class="form-group">
                        <label>Initial Password *</label>
                        <input type="text" id="userPassword" required placeholder="Generate a strong password">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-user-plus"></i> Create User Account
                </button>
            </form>

            <h4 style="margin-top: 2rem;">Existing Users</h4>
            <div id="usersList" class="card-grid">
                <!-- Users list will be loaded here -->
            </div>
        </div>

        <!-- Sessions Tab -->
        <div class="admin-content" id="sessionsTab">
            <h3><i class="fas fa-video"></i> Session Requests Management</h3>
            <div id="sessionsList">
                <!-- Session requests will be loaded here -->
            </div>
        </div>

        <!-- Content Tab -->
        <div class="admin-content" id="contentTab">
            <h3><i class="fas fa-photo-video"></i> Content Control</h3>
            
            <div class="form-group">
                <label>Background Image URL</label>
                <input type="text" id="backgroundImage" placeholder="https://example.com/background.jpg">
            </div>
            
            <div class="form-group">
                <label>Subscription Popup Image URL</label>
                <input type="text" id="subscriptionImage" placeholder="https://example.com/sexy-subscription-image.jpg">
            </div>
            
            <div class="form-group">
                <label>Subscription Link</label>
                <input type="text" id="subscriptionLink" placeholder="https://your-payment-page.com">
            </div>

            <div class="form-group">
                <label>Renewal Popup Image URL</label>
                <input type="text" id="renewalImage" placeholder="https://example.com/sexy-renewal-image.jpg">
            </div>
            
            <div class="form-group">
                <label>Renewal Link</label>
                <input type="text" id="renewalLink" placeholder="https://your-renewal-page.com">
            </div>

            <button class="btn btn-primary" onclick="updateContentSettings()">
                <i class="fas fa-save"></i> Update Content Settings
            </button>
        </div>

        <!-- Posts Tab -->
        <div class="admin-content" id="postsTab">
            <h3><i class="fas fa-bullhorn"></i> Broadcast Post</h3>
            <form id="postForm">
                <div class="form-group">
                    <label>Post Title *</label>
                    <input type="text" id="postTitle" required placeholder="Enter post title">
                </div>
                
                <div class="form-group">
                    <label>Post Content *</label>
                    <textarea id="postContent" required rows="5" placeholder="Enter your message to all users..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Button Text</label>
                        <input type="text" id="postButtonText" placeholder="Click Here">
                    </div>
                    <div class="form-group">
                        <label>Button Link</label>
                        <input type="text" id="postButtonLink" placeholder="https://example.com">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-paper-plane"></i> Broadcast to All Users
                </button>
            </form>

            <h4 style="margin-top: 2rem;">Recent Broadcasts</h4>
            <div id="postsList" class="card-grid">
                <!-- Posts list will be loaded here -->
            </div>
        </div>

        <!-- Chats Tab -->
        <div class="admin-content" id="chatsTab">
            <h3><i class="fas fa-comments"></i> Chat Management</h3>
            <div class="form-row">
                <div style="flex: 1;">
                    <h4>Active Conversations</h4>
                    <div class="conversation-list" id="conversationsList">
                        <!-- Conversations will be loaded here -->
                    </div>
                </div>
                <div style="flex: 2;">
                    <div id="activeChat" style="display: none;">
                        <div class="chat-header">
                            <h4 id="chatWithUser">Chat with User</h4>
                            <button class="btn btn-outline btn-sm" onclick="closeActiveChat()">
                                <i class="fas fa-times"></i> Close
                            </button>
                        </div>
                        <div class="chat-messages" id="adminChatMessages">
                            <!-- Chat messages will be loaded here -->
                        </div>
                        <div class="chat-input-container">
                            <input type="text" class="chat-input" id="adminChatInput" placeholder="Type your message...">
                            <button class="chat-send" onclick="sendAdminChatMessage()">
                                <i class="fas fa-paper-plane"></i> Send
                            </button>
                        </div>
                    </div>
                    <div id="noChatSelected" style="text-align: center; padding: 2rem;">
                        <i class="fas fa-comments" style="font-size: 3rem; opacity: 0.3; margin-bottom: 1rem;"></i>
                        <p>Select a conversation to start chatting</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="admin-content" id="settingsTab">
            <h3><i class="fas fa-cogs"></i> Website Settings</h3>
            
            <div class="form-group">
                <label>Website Title</label>
                <input type="text" id="websiteTitle" placeholder="Camsilo">
            </div>

            <div class="form-group">
                <label>Welcome Message</label>
                <textarea id="welcomeMessage" rows="3" placeholder="Welcome to our exclusive platform..."></textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Primary Color</label>
                    <input type="color" id="primaryColor" value="#e91e63">
                </div>
                <div class="form-group">
                    <label>Secondary Color</label>
                    <input type="color" id="secondaryColor" value="#9c27b0">
                </div>
            </div>

            <button class="btn btn-primary" onclick="updateWebsiteSettings()">
                <i class="fas fa-save"></i> Update Website Settings
            </button>
        </div>
    </section>
        <!-- Subscription Warning Modal -->
<div class="modal sexy-popup" id="subscriptionModal">
    <div class="modal-content">
        <img id="subscriptionModalImage" src="https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80" alt="Subscribe" class="modal-image">
        <h2>Unlock Pleasure Beyond Imagination</h2>
        <p>Darling, you're so close to experiencing pure ecstasy. Subscribe now to unlock intimate moments, exclusive content, and private shows with our most seductive models.</p>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('subscriptionModal')">
                <i class="fas fa-times"></i> Maybe Later
            </button>
            <button class="btn btn-primary" onclick="redirectToSubscribe()">
                <i class="fas fa-gem"></i> Yes, I Want It All!
            </button>
        </div>
    </div>
</div>

<!-- Renewal Modal -->
<div class="modal sexy-popup" id="renewalModal">
    <div class="modal-content">
        <img id="renewalModalImage" src="" alt="Renew Subscription" class="modal-image">
        <h2>Don't Let the Magic End</h2>
        <p>Your journey into pleasure has expired. Renew now to continue exploring our exclusive content and intimate experiences with the world's most captivating models.</p>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('renewalModal')">
                <i class="fas fa-times"></i> Not Now
            </button>
            <button class="btn btn-primary" onclick="redirectToRenewal()">
                <i class="fas fa-sync-alt"></i> Continue the Magic
            </button>
        </div>
    </div>
</div>

<!-- Video Call Modal -->
<div class="modal" id="videoCallModal">
    <div class="modal-content">
        <h2>Book Private Video Call</h2>
        <p>Experience an intimate video call session with our model. Fill in your details below:</p>
        
        <div class="form-group">
            <label>Your Email *</label>
            <input type="email" id="userEmailInput" placeholder="Enter your email" required>
        </div>
        
        <div class="form-group">
            <label>Preferred Date & Time</label>
            <input type="datetime-local" id="callDateTime">
        </div>
        
        <div class="form-group">
            <label>Special Requests (Optional)</label>
            <textarea id="callRequests" rows="3" placeholder="Any special preferences or requests..."></textarea>
        </div>

        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('videoCallModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="bookVideoCall()">
                <i class="fas fa-video"></i> Book Session
            </button>
        </div>
    </div>
</div>

<!-- Admin Login Modal -->
<div class="modal" id="adminLoginModal">
    <div class="modal-content">
        <h2>Admin Login</h2>
        <div class="form-group">
            <label>Email</label>
            <input type="email" id="adminEmail" required placeholder="admin@camsilo.com">
        </div>
        <div class="form-group">
            <label>Password</label>
            <input type="password" id="adminPassword" required placeholder="Enter your password">
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('adminLoginModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="adminLogin()">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
        </div>
    </div>
</div>

<!-- User Login Modal -->
<div class="modal" id="userLoginModal">
    <div class="modal-content">
        <h2>User Login</h2>
        <div class="form-group">
            <label>Email</label>
            <input type="email" id="loginEmail" required placeholder="your@email.com">
        </div>
        <div class="form-group">
            <label>Password</label>
            <input type="password" id="loginPassword" required placeholder="Enter your password">
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('userLoginModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="userLogin()">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
        </div>
    </div>
</div>

<!-- Comment Modal -->
<div class="modal" id="commentModal">
    <div class="modal-content">
        <h2>Add Comment</h2>
        <div class="form-group">
            <label>Your Comment</label>
            <textarea id="commentText" rows="4" placeholder="Write your comment here..." required></textarea>
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('commentModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="submitComment()">
                <i class="fas fa-comment"></i> Post Comment
            </button>
        </div>
    </div>
</div>

<!-- Admin Comment Modal -->
<div class="modal" id="adminCommentModal">
    <div class="modal-content">
        <h2>Add Fake Comment</h2>
        <div class="form-group">
            <label>Comment Text</label>
            <textarea id="adminCommentText" rows="4" placeholder="Write a fake comment..." required></textarea>
        </div>
        <div class="form-group">
            <label>Username (Optional)</label>
            <input type="text" id="fakeUsername" placeholder="Leave empty for random username">
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('adminCommentModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="submitAdminComment()">
                <i class="fas fa-comment"></i> Add Fake Comment
            </button>
        </div>
    </div>
</div>

<!-- Public Posts Modal -->
<div class="modal public-posts-modal" id="publicPostsModal">
    <div class="modal-content">
        <h2 id="publicPostsModelName">Public Posts</h2>
        <div class="public-posts-container" id="publicPostsContainer">
            <!-- Public posts will be loaded here -->
        </div>
        <div class="modal-buttons" style="margin-top: 1.5rem;">
            <button class="btn btn-primary" onclick="closeModal('publicPostsModal')">
                <i class="fas fa-times"></i> Close
            </button>
        </div>
    </div>
</div>

<!-- Enhanced Chat Modal - Full Screen Like Facebook Messenger -->
<div class="modal" id="chatModal" style="padding: 0;">
    <div class="modal-content" style="max-width: 100%; width: 100%; height: 100vh; border-radius: 0; padding: 0;">
        <div class="chat-header" style="background: var(--surface-light); padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1); margin-bottom: 0;">
            <div style="display: flex; align-items: center; gap: 1rem;">
                <button class="btn btn-outline btn-sm" onclick="closeModal('chatModal')">
                    <i class="fas fa-arrow-left"></i>
                </button>
                <div>
                    <h4 id="chatModelName" style="margin: 0; font-size: 1.2rem;">Chat with Model</h4>
                    <small id="chatStatus" style="opacity: 0.7; font-size: 0.8rem;">Online</small>
                </div>
            </div>
            <div style="display: flex; gap: 0.5rem;">
                <button class="btn btn-outline btn-sm" onclick="toggleChatInfo()">
                    <i class="fas fa-info-circle"></i>
                </button>
            </div>
        </div>
        
        <div class="chat-messages" id="chatMessages" style="flex: 1; max-height: calc(100vh - 130px); padding: 1rem; background: var(--dark);">
            <!-- Chat messages will be loaded here -->
        </div>
        
        <div class="chat-input-container" style="background: var(--surface-light); padding: 1rem; border-top: 1px solid rgba(255,255,255,0.1);">
            <div style="display: flex; gap: 0.5rem; align-items: center;">
                <button class="btn btn-outline btn-sm" onclick="toggleEmojiPicker()">
                    <i class="fas fa-smile"></i>
                </button>
                <input type="text" class="chat-input" id="chatInput" placeholder="Type your message..." style="flex: 1;" onkeypress="handleChatKeyPress(event)">
                <button class="chat-send" onclick="sendChatMessage()" style="padding: 0.8rem 1.2rem;">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Admin Chat Management Modal -->
<div class="modal" id="adminChatModal" style="padding: 0;">
    <div class="modal-content" style="max-width: 95%; width: 95%; height: 90vh; padding: 0;">
        <div class="chat-header" style="background: var(--surface-light); padding: 1rem; margin-bottom: 0;">
            <h3 style="margin: 0;"><i class="fas fa-comments"></i> Chat Management</h3>
            <button class="btn btn-outline btn-sm" onclick="closeModal('adminChatModal')">
                <i class="fas fa-times"></i> Close
            </button>
        </div>
        
        <div style="display: flex; height: calc(90vh - 80px);">
            <!-- Left Sidebar - Conversations -->
            <div style="width: 300px; border-right: 1px solid rgba(255,255,255,0.1); background: var(--surface);">
                <div style="padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                    <h4 style="margin: 0 0 1rem 0;">Conversations</h4>
                    <div style="display: flex; gap: 0.5rem;">
                        <button class="btn btn-sm btn-primary active" onclick="switchChatTab('unread')" style="flex: 1;">
                            Unread
                        </button>
                        <button class="btn btn-sm btn-outline" onclick="switchChatTab('replied')" style="flex: 1;">
                            Replied
                        </button>
                    </div>
                </div>
                <div class="conversation-list" id="adminConversationsList" style="height: calc(100% - 80px); overflow-y: auto;">
                    <!-- Conversations will be loaded here -->
                </div>
            </div>
            
            <!-- Right Side - Active Chat -->
            <div style="flex: 1; display: flex; flex-direction: column;">
                <div id="activeAdminChat" style="display: none; flex: 1; flex-direction: column;">
                    <div class="chat-header" style="background: var(--surface-light); padding: 1rem; border-bottom: 1px solid rgba(255,255,255,0.1);">
                        <div style="display: flex; justify-content: between; align-items: center; width: 100%;">
                            <div>
                                <h4 id="adminChatWithUser" style="margin: 0;">Select a conversation</h4>
                                <small id="adminChatModel" style="opacity: 0.7;"></small>
                            </div>
                            <button class="btn btn-danger btn-sm" onclick="deleteConversation()">
                                <i class="fas fa-trash"></i> Delete
                            </button>
                        </div>
                    </div>
                    <div class="chat-messages" id="adminChatMessages" style="flex: 1; padding: 1rem; background: var(--dark);">
                        <!-- Admin chat messages will be loaded here -->
                    </div>
                    <div class="chat-input-container" style="background: var(--surface-light); padding: 1rem; border-top: 1px solid rgba(255,255,255,0.1);">
                        <div style="display: flex; gap: 0.5rem;">
                            <input type="text" class="chat-input" id="adminChatInput" placeholder="Type your reply as the model..." style="flex: 1;">
                            <button class="chat-send" onclick="sendAdminChatMessage()" style="padding: 0.8rem 1.5rem;">
                                <i class="fas fa-paper-plane"></i> Send
                            </button>
                        </div>
                    </div>
                </div>
                <div id="noAdminChatSelected" style="flex: 1; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 2rem;">
                    <i class="fas fa-comments" style="font-size: 4rem; opacity: 0.3; margin-bottom: 1rem;"></i>
                    <h4>No Conversation Selected</h4>
                    <p style="text-align: center; opacity: 0.7;">Select a conversation from the list to start chatting</p>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js"></script>
<script src="configuration.js"></script>
<script>
    // Firebase Initialization
    const auth = firebase.auth();
    const db = firebase.firestore();

    // Toastr configuration
    toastr.options = {
        closeButton: true,
        progressBar: true,
        positionClass: "toast-top-right",
        timeOut: 5000
    };

    // Firebase References
    const modelsRef = db.collection('models');
    const usersRef = db.collection('users');
    const settingsRef = db.collection('settings').doc('website');
    const postsRef = db.collection('posts');
    const bookingsRef = db.collection('bookings');
    const commentsRef = db.collection('comments');
    const chatsRef = db.collection('chats');
    const conversationsRef = db.collection('conversations');
    const notificationsRef = db.collection('notifications');

    // State Management
    let currentUser = null;
    let adminUser = null;
    let websiteSettings = {};
    let allModels = [];
    let currentEditingModel = null;
    let currentCommentModelId = null;
    let currentChatModelId = null;
    let currentChatConversationId = null;
    let currentAdminConversationId = null;
    let chatUnsubscribe = null;
    let conversationsUnsubscribe = null;
    let adminChatUnsubscribe = null;
    let currentChatTab = 'unread';

    // Initialize Website
    document.addEventListener('DOMContentLoaded', function() {
        initializeWebsite();
    });

    async function initializeWebsite() {
        await loadWebsiteSettings();
        await loadModels();
        checkAuthState();
        setupEventListeners();
        updateAuthButtons();
        initializeChatListeners();
    }

    function setupEventListeners() {
        // Form submissions
        document.getElementById('modelForm').addEventListener('submit', handleModelSubmit);
        document.getElementById('userForm').addEventListener('submit', handleUserCreate);
        document.getElementById('postForm').addEventListener('submit', handlePostSubmit);
    }

    // Initialize real-time chat listeners
    function initializeChatListeners() {
        // Listen for new messages for current user
        auth.onAuthStateChanged((user) => {
            if (user && currentUser) {
                setupUserChatListener(user.uid);
            }
        });
    }

    // Setup real-time listener for user's conversations
    function setupUserChatListener(userId) {
        if (conversationsUnsubscribe) {
            conversationsUnsubscribe();
        }

        conversationsUnsubscribe = conversationsRef
            .where('userId', '==', userId)
            .where('hasUnread', '==', true)
            .onSnapshot((snapshot) => {
                snapshot.docChanges().forEach((change) => {
                    if (change.type === 'added' || change.type === 'modified') {
                        const conversation = change.doc.data();
                        showMessageNotification(conversation.lastMessage, conversation.modelName);
                    }
                });
            });
    }

    // Show notification for new messages
    function showMessageNotification(message, modelName) {
        if (!document.hidden) {
            toastr.info(`New message from ${modelName}: ${message}`, "New Message", {
                timeOut: 10000,
                closeButton: true,
                onclick: function() {
                    openChatModalForModel(modelName);
                }
            });
        }
    }

    // Authentication State Listener
    function checkAuthState() {
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                const userDoc = await usersRef.doc(user.uid).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    if (userData.role === 'admin') {
                        adminUser = { uid: user.uid, ...userData };
                        showAdminPanel();
                        toastr.success('Welcome back, Admin!');
                    } else {
                        currentUser = { uid: user.uid, ...userData };
                        showUserInterface();
                        checkAccountExpiry();
                        setupUserChatListener(user.uid);
                        toastr.success('Welcome back!');
                    }
                } else {
                    // User not in users collection - might be Firebase auth user but not in our system
                    await auth.signOut();
                }
                updateAuthButtons();
                await loadModels(); // Reload models to show private content if applicable
            } else {
                currentUser = null;
                adminUser = null;
                updateAuthButtons();
                hideAdminPanel();
                hideUserInterface();
                await loadModels(); // Reload models to hide private content
                
                if (conversationsUnsubscribe) {
                    conversationsUnsubscribe();
                }
            }
        });
    }

    // Load Website Settings
    async function loadWebsiteSettings() {
        try {
            const settingsDoc = await settingsRef.get();
            if (settingsDoc.exists) {
                websiteSettings = settingsDoc.data();
                applyWebsiteSettings();
            } else {
                // Initialize default settings
                websiteSettings = {
                    websiteTitle: 'Camsilo',
                    welcomeMessage: 'Experience the ultimate in adult entertainment with our exclusive models',
                    primaryColor: '#e91e63',
                    secondaryColor: '#9c27b0',
                    backgroundImage: 'https://images.unsplash.com/photo-1511285605577-4d62fb50d2f7?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
                    subscriptionImage: 'https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                    subscriptionLink: 'https://payment.example.com/subscribe',
                    renewalImage: 'https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                    renewalLink: 'https://payment.example.com/renew'
                };
                await settingsRef.set(websiteSettings);
            }
        } catch (error) {
            console.error('Error loading settings:', error);
            toastr.error('Failed to load website settings');
        }
    }

    function applyWebsiteSettings() {
        if (websiteSettings.websiteTitle) {
            document.title = websiteSettings.websiteTitle;
            document.querySelector('.logo').textContent = websiteSettings.websiteTitle;
        }
        if (websiteSettings.welcomeMessage) {
            const heroP = document.querySelector('.hero p');
            if (heroP) heroP.textContent = websiteSettings.welcomeMessage;
        }
        if (websiteSettings.backgroundImage) {
            document.querySelector('.hero').style.backgroundImage = `url(${websiteSettings.backgroundImage})`;
        }
        if (websiteSettings.primaryColor) {
            document.documentElement.style.setProperty('--primary', websiteSettings.primaryColor);
        }
        if (websiteSettings.secondaryColor) {
            document.documentElement.style.setProperty('--secondary', websiteSettings.secondaryColor);
        }
    }
        // Load Models - FIXED: Show ALL public models to everyone, including before login
async function loadModels() {
    try {
        const snapshot = await modelsRef.orderBy('createdAt', 'desc').get();
        allModels = [];
        const modelsGrid = document.getElementById('modelsGrid');
        const privateContentGrid = document.getElementById('privateContentGrid');
        
        modelsGrid.innerHTML = '';
        privateContentGrid.innerHTML = '';

        snapshot.forEach(doc => {
            const model = { id: doc.id, ...doc.data() };
            allModels.push(model);
            
            // Create model card for every model
            const modelCard = createModelCard(model);
            
            // FIX: Always show public models in the main grid
            // Only show private models in private section for logged-in users with active subscription
            if (model.contentType === 'private') {
                if ((currentUser && isSubscriptionActive(currentUser)) || adminUser) {
                    privateContentGrid.appendChild(modelCard);
                }
            } else {
                // Public models always show in main grid
                modelsGrid.appendChild(modelCard);
            }
        });

        // Update admin models list
        if (adminUser) {
            updateAdminModelsList();
        }

        // Show private content section if user is logged in and there's private content
        const privateContent = document.getElementById('privateContent');
        const hasPrivateContent = privateContentGrid.children.length > 0;
        const userIsLoggedIn = (currentUser && isSubscriptionActive(currentUser)) || adminUser;
        
        if (userIsLoggedIn && hasPrivateContent) {
            privateContent.style.display = 'block';
        } else {
            privateContent.style.display = 'none';
        }

    } catch (error) {
        console.error('Error loading models:', error);
        toastr.error('Failed to load models');
    }
}

// Check if user subscription is active
function isSubscriptionActive(user) {
    if (!user.expiresAt) return false;
    const now = new Date();
    const expires = user.expiresAt.toDate();
    return now < expires && user.isActive !== false;
}

// Create Model Card
function createModelCard(model) {
    const card = document.createElement('div');
    card.className = 'model-card';
    
    // Get comments for this model
    const modelComments = model.comments || [];
    const publicPosts = model.publicPosts || [];
    
    card.innerHTML = `
        <div class="model-image-container">
            <img src="${model.image}" alt="${model.name}" class="model-image" onerror="this.src='https://images.unsplash.com/photo-1511285605577-4d62fb50d2f7?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'">
            <div class="model-badge">
                <i class="fas fa-crown"></i> ${model.contentType === 'private' ? 'Premium' : 'Public'}
            </div>
        </div>
        <div class="model-info">
            <div class="model-name">
                <h3>${model.name}</h3>
                ${model.verified ? '<i class="fas fa-check-circle verified"></i>' : ''}
            </div>
            
            ${model.embedVideo ? `
                <div style="margin: 1rem 0;">
                    <iframe width="100%" height="200" src="${model.embedVideo}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
            ` : ''}

            <div class="model-stats">
                <div class="likes">
                    <button class="like-btn ${model.userLiked ? 'liked' : ''}" onclick="handleLike('${model.id}')">
                        <i class="fas fa-heart"></i>
                    </button>
                    <span>${model.likes || 0}</span>
                </div>
                <div class="comments">
                    <button class="comment-btn" onclick="openCommentModal('${model.id}')">
                        <i class="fas fa-comment"></i>
                    </button>
                    <span>${modelComments.length}</span>
                </div>
            </div>

            ${publicPosts.length > 0 ? `
                <button class="btn btn-outline" style="width: 100%; margin-bottom: 1rem;" onclick="openPublicPostsModal('${model.id}')">
                    <i class="fas fa-images"></i> View Public Posts (${publicPosts.length})
                </button>
            ` : ''}

            ${modelComments.length > 0 ? `
                <div class="comments-section">
                    ${modelComments.slice(0, model.commentsCount || 3).map(comment => `
                        <div class="comment">${comment}</div>
                    `).join('')}
                </div>
            ` : ''}

            ${adminUser ? `
                <div class="fake-interaction-controls">
                    <button class="btn btn-sm btn-warning" onclick="boostLikes('${model.id}')">
                        <i class="fas fa-rocket"></i> Boost Likes
                    </button>
                    <button class="btn btn-sm btn-primary" onclick="openAdminCommentModal('${model.id}')">
                        <i class="fas fa-comment"></i> Add Fake Comment
                    </button>
                </div>
            ` : ''}

            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                <button class="book-btn" onclick="openVideoCallModal('${model.id}')" style="flex: 1;">
                    <i class="fas fa-video"></i> Book Show
                </button>
                <button class="btn btn-outline" onclick="openChatModal('${model.id}')" style="flex: 1;">
                    <i class="fas fa-comments"></i> Chat
                </button>
            </div>
        </div>
    `;
    return card;
}

// Open Public Posts Modal
function openPublicPostsModal(modelId) {
    const model = allModels.find(m => m.id === modelId);
    if (!model) return;

    const publicPosts = model.publicPosts || [];
    const container = document.getElementById('publicPostsContainer');
    const modelNameElement = document.getElementById('publicPostsModelName');
    
    modelNameElement.textContent = `${model.name}'s Public Posts`;
    container.innerHTML = '';

    if (publicPosts.length === 0) {
        container.innerHTML = '<p>No public posts available.</p>';
    } else {
        publicPosts.forEach(post => {
            const [image, description] = post.split('|');
            const postElement = document.createElement('div');
            postElement.className = 'public-post-card';
            postElement.innerHTML = `
                <img src="${image}" alt="Public post" class="public-post-image" onerror="this.style.display='none'">
                <div class="public-post-content">
                    <p class="public-post-description">${description || 'No description'}</p>
                    <div class="public-post-stats">
                        <div class="likes">
                            <button class="like-btn" onclick="handleLike('${model.id}')">
                                <i class="fas fa-heart"></i>
                            </button>
                            <span>0</span>
                        </div>
                        <div class="comments">
                            <button class="comment-btn" onclick="openCommentModal('${model.id}')">
                                <i class="fas fa-comment"></i>
                            </button>
                            <span>0</span>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(postElement);
        });
    }

    openModal('publicPostsModal');
}

// Handle Like - FIXED: One like per user per model
async function handleLike(modelId) {
    if (!currentUser && !adminUser) {
        openModal('subscriptionModal');
        return;
    }

    try {
        const model = allModels.find(m => m.id === modelId);
        
        // Check if user already liked this model
        const likeDoc = await db.collection('likes').doc(`${modelId}_${currentUser ? currentUser.uid : 'admin'}`).get();
        if (likeDoc.exists) {
            toastr.info('You already liked this model!');
            return;
        }

        const newLikes = (model.likes || 0) + 1;
        
        // Update model likes
        await modelsRef.doc(modelId).update({
            likes: newLikes,
            lastLiked: firebase.firestore.FieldValue.serverTimestamp()
        });

        // Record the like to prevent duplicate likes
        await db.collection('likes').doc(`${modelId}_${currentUser ? currentUser.uid : 'admin'}`).set({
            modelId: modelId,
            userId: currentUser ? currentUser.uid : 'admin',
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        // Update local state
        model.likes = newLikes;
        model.userLiked = true;
        
        // Update UI
        loadModels();
        toastr.success('Liked! ❤️');

    } catch (error) {
        console.error('Error liking model:', error);
        toastr.error('Failed to like model');
    }
}

// Boost Likes (Admin Only)
async function boostLikes(modelId) {
    if (!adminUser) return;
    
    try {
        const model = allModels.find(m => m.id === modelId);
        const boostAmount = Math.floor(Math.random() * 50) + 10; // Random boost between 10-60
        const newLikes = (model.likes || 0) + boostAmount;
        
        await modelsRef.doc(modelId).update({
            likes: newLikes
        });

        // Update local state
        model.likes = newLikes;
        
        // Update UI
        loadModels();
        toastr.success(`Boosted ${model.name}'s likes by ${boostAmount}!`);
    } catch (error) {
        console.error('Error boosting likes:', error);
        toastr.error('Failed to boost likes');
    }
}

// Comment Functions
function openCommentModal(modelId) {
    if (!currentUser && !adminUser) {
        openModal('subscriptionModal');
        return;
    }
    
    currentCommentModelId = modelId;
    document.getElementById('commentText').value = '';
    openModal('commentModal');
}

async function submitComment() {
    const commentText = document.getElementById('commentText').value.trim();
    
    if (!commentText) {
        toastr.error('Please enter a comment');
        return;
    }

    try {
        const model = allModels.find(m => m.id === currentCommentModelId);
        const currentComments = model.comments || [];
        
        // Add new comment
        currentComments.unshift(commentText);
        
        // Update model with new comments
        await modelsRef.doc(currentCommentModelId).update({
            comments: currentComments
        });

        toastr.success('Comment added successfully!');
        closeModal('commentModal');
        await loadModels();
        
    } catch (error) {
        console.error('Error adding comment:', error);
        toastr.error('Failed to add comment');
    }
}

// Admin Fake Comment Functions
function openAdminCommentModal(modelId) {
    currentCommentModelId = modelId;
    document.getElementById('adminCommentText').value = '';
    document.getElementById('fakeUsername').value = '';
    openModal('adminCommentModal');
}

async function submitAdminComment() {
    const commentText = document.getElementById('adminCommentText').value.trim();
    
    if (!commentText) {
        toastr.error('Please enter a comment');
        return;
    }

    try {
        const model = allModels.find(m => m.id === currentCommentModelId);
        const currentComments = model.comments || [];
        
        // Generate fake username if not provided
        let username = document.getElementById('fakeUsername').value.trim();
        if (!username) {
            const fakeNames = ['HotFan123', 'SecretAdmirer', 'LoyalViewer', 'NightOwl', 'DreamClient', 'MysteryMan'];
            username = fakeNames[Math.floor(Math.random() * fakeNames.length)];
        }
        
        // Add fake comment with username
        const fakeComment = `${username}: ${commentText}`;
        currentComments.unshift(fakeComment);
        
        // Update model with new comments
        await modelsRef.doc(currentCommentModelId).update({
            comments: currentComments
        });

        toastr.success('Fake comment added successfully!');
        closeModal('adminCommentModal');
        await loadModels();
        
    } catch (error) {
        console.error('Error adding fake comment:', error);
        toastr.error('Failed to add fake comment');
    }
}

// Video Call Booking
let currentModelId = null;

function openVideoCallModal(modelId) {
    if (!currentUser && !adminUser) {
        openModal('subscriptionModal');
        return;
    }
    
    currentModelId = modelId;
    openModal('videoCallModal');
}

async function bookVideoCall() {
    const email = document.getElementById('userEmailInput').value;
    const datetime = document.getElementById('callDateTime').value;
    const requests = document.getElementById('callRequests').value;

    if (!email) {
        toastr.error('Please enter your email');
        return;
    }

    try {
        const model = allModels.find(m => m.id === currentModelId);
        
        await bookingsRef.add({
            modelId: currentModelId,
            modelName: model.name,
            userEmail: email,
            callDateTime: datetime,
            specialRequests: requests,
            status: 'pending',
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            userId: currentUser ? currentUser.uid : null
        });

        toastr.success('Video call booking request sent! We will contact you soon.');
        closeModal('videoCallModal');
        
        // Reset form
        document.getElementById('userEmailInput').value = '';
        document.getElementById('callDateTime').value = '';
        document.getElementById('callRequests').value = '';

    } catch (error) {
        console.error('Error booking video call:', error);
        toastr.error('Failed to book video call');
    }
}

// Enhanced Chat Functions - Facebook Messenger Style
function openChatModal(modelId) {
    if (!currentUser && !adminUser) {
        openModal('subscriptionModal');
        return;
    }

    currentChatModelId = modelId;
    const model = allModels.find(m => m.id === modelId);
    document.getElementById('chatModelName').textContent = `Chat with ${model.name}`;
    document.getElementById('chatMessages').innerHTML = '<div class="message model"><div class="message-text">Hello! Thanks for reaching out. How can I help you today? 😊</div></div>';
    document.getElementById('chatInput').value = '';
    
    // Load or create conversation
    loadOrCreateConversation(modelId);
    openModal('chatModal');
}

function openChatModalForModel(modelName) {
    const model = allModels.find(m => m.name === modelName);
    if (model) {
        openChatModal(model.id);
    }
}

async function loadOrCreateConversation(modelId) {
    if (!currentUser && !adminUser) return;

    try {
        // Look for existing conversation
        const conversationSnapshot = await conversationsRef
            .where('modelId', '==', modelId)
            .where('userId', '==', currentUser ? currentUser.uid : 'admin')
            .limit(1)
            .get();

        let conversationId;
        
        if (conversationSnapshot.empty) {
            // Create new conversation
            const conversationData = {
                modelId: modelId,
                modelName: allModels.find(m => m.id === modelId).name,
                userId: currentUser ? currentUser.uid : 'admin',
                userEmail: currentUser ? currentUser.email : 'admin',
                lastMessage: 'Conversation started',
                lastMessageAt: firebase.firestore.FieldValue.serverTimestamp(),
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                hasUnread: false,
                adminReplied: false,
                status: 'active'
            };
            
            const conversationDoc = await conversationsRef.add(conversationData);
            conversationId = conversationDoc.id;
        } else {
            conversationId = conversationSnapshot.docs[0].id;
            // Mark as read when user opens chat
            await conversationsRef.doc(conversationId).update({
                hasUnread: false
            });
        }

        currentChatConversationId = conversationId;
        loadChatMessages(conversationId);
        
    } catch (error) {
        console.error('Error handling conversation:', error);
        toastr.error('Failed to start conversation');
    }
}

async function loadChatMessages(conversationId) {
    if (chatUnsubscribe) {
        chatUnsubscribe();
    }

    const messagesContainer = document.getElementById('chatMessages');
    
    try {
        chatUnsubscribe = chatsRef
            .where('conversationId', '==', conversationId)
            .orderBy('createdAt', 'asc')
            .onSnapshot(snapshot => {
                messagesContainer.innerHTML = '';
                
                snapshot.forEach(doc => {
                    const message = doc.data();
                    const messageElement = document.createElement('div');
                    messageElement.className = `message ${message.senderType}`;
                    
                    const time = message.createdAt ? new Date(message.createdAt.toDate()).toLocaleTimeString() : 'Just now';
                    
                    messageElement.innerHTML = `
                        ${message.senderType === 'model' || message.senderType === 'admin' ? 
                            `<div class="message-sender">${message.senderType === 'model' ? 'Model' : 'Admin'}</div>` : ''}
                        <div class="message-text">${message.text}</div>
                        <div class="message-time">${time}</div>
                    `;
                    
                    messagesContainer.appendChild(messageElement);
                });
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            });

    } catch (error) {
        console.error('Error loading messages:', error);
    }
}

function handleChatKeyPress(event) {
    if (event.key === 'Enter') {
        sendChatMessage();
    }
}

async function sendChatMessage() {
    const messageText = document.getElementById('chatInput').value.trim();
    
    if (!messageText || !currentChatConversationId) {
        return;
    }

    try {
        await chatsRef.add({
            conversationId: currentChatConversationId,
            text: messageText,
            senderType: 'user',
            userId: currentUser ? currentUser.uid : 'admin',
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            read: false
        });

        // Update conversation last message and mark as unread for admin
        await conversationsRef.doc(currentChatConversationId).update({
            lastMessage: messageText,
            lastMessageAt: firebase.firestore.FieldValue.serverTimestamp(),
            hasUnread: true,
            adminReplied: false
        });

        document.getElementById('chatInput').value = '';
        
    } catch (error) {
        console.error('Error sending message:', error);
        toastr.error('Failed to send message');
    }
}

// Enhanced Admin Chat Functions
function openAdminChatModal() {
    openModal('adminChatModal');
    loadAdminConversations();
}

function switchChatTab(tab) {
    currentChatTab = tab;
    const unreadBtn = document.querySelector('#adminChatModal .btn-sm:nth-child(1)');
    const repliedBtn = document.querySelector('#adminChatModal .btn-sm:nth-child(2)');
    
    if (tab === 'unread') {
        unreadBtn.classList.add('active', 'btn-primary');
        unreadBtn.classList.remove('btn-outline');
        repliedBtn.classList.remove('active', 'btn-primary');
        repliedBtn.classList.add('btn-outline');
    } else {
        repliedBtn.classList.add('active', 'btn-primary');
        repliedBtn.classList.remove('btn-outline');
        unreadBtn.classList.remove('active', 'btn-primary');
        unreadBtn.classList.add('btn-outline');
    }
    
    loadAdminConversations();
}

async function loadAdminConversations() {
    if (conversationsUnsubscribe) {
        conversationsUnsubscribe();
    }

    const conversationsList = document.getElementById('adminConversationsList');
    
    try {
        let query;
        if (currentChatTab === 'unread') {
            query = conversationsRef
                .where('hasUnread', '==', true)
                .orderBy('lastMessageAt', 'desc');
        } else {
            query = conversationsRef
                .where('adminReplied', '==', true)
                .orderBy('lastMessageAt', 'desc');
        }

        conversationsUnsubscribe = query.onSnapshot(snapshot => {
            conversationsList.innerHTML = '';
            
            if (snapshot.empty) {
                conversationsList.innerHTML = `
                    <div style="padding: 2rem; text-align: center; opacity: 0.7;">
                        <i class="fas fa-comments" style="font-size: 3rem; margin-bottom: 1rem;"></i>
                        <p>No ${currentChatTab} conversations</p>
                    </div>
                `;
                return;
            }

            snapshot.forEach(doc => {
                const conversation = { id: doc.id, ...doc.data() };
                const conversationElement = document.createElement('div');
                conversationElement.className = `conversation-item ${currentAdminConversationId === conversation.id ? 'active' : ''}`;
                conversationElement.onclick = () => openAdminChat(conversation);
                
                const time = conversation.lastMessageAt ? 
                    new Date(conversation.lastMessageAt.toDate()).toLocaleTimeString() : 'N/A';
                
                conversationElement.innerHTML = `
                    <div class="conversation-user">${conversation.userEmail}</div>
                    <div class="conversation-preview">${conversation.lastMessage}</div>
                    <div class="conversation-time">${time}</div>
                    ${conversation.hasUnread ? '<div style="position: absolute; top: 10px; right: 10px; width: 10px; height: 10px; background: var(--primary); border-radius: 50%;"></div>' : ''}
                `;
                
                conversationsList.appendChild(conversationElement);
            });
        });

    } catch (error) {
        console.error('Error loading conversations:', error);
        toastr.error('Failed to load conversations');
    }
}

function openAdminChat(conversation) {
    document.getElementById('activeAdminChat').style.display = 'flex';
    document.getElementById('noAdminChatSelected').style.display = 'none';
    document.getElementById('adminChatWithUser').textContent = conversation.userEmail;
    document.getElementById('adminChatModel').textContent = `Model: ${conversation.modelName}`;
    
    currentAdminConversationId = conversation.id;
    loadAdminChatMessages(conversation.id);
    
    // Mark as read when admin opens chat
    conversationsRef.doc(conversation.id).update({
        hasUnread: false
    });
}

function closeActiveChat() {
    document.getElementById('activeAdminChat').style.display = 'none';
    document.getElementById('noAdminChatSelected').style.display = 'flex';
    currentAdminConversationId = null;
    
    if (adminChatUnsubscribe) {
        adminChatUnsubscribe();
    }
}

async function loadAdminChatMessages(conversationId) {
    if (adminChatUnsubscribe) {
        adminChatUnsubscribe();
    }

    const messagesContainer = document.getElementById('adminChatMessages');
    
    try {
        adminChatUnsubscribe = chatsRef
            .where('conversationId', '==', conversationId)
            .orderBy('createdAt', 'asc')
            .onSnapshot(snapshot => {
                messagesContainer.innerHTML = '';
                
                snapshot.forEach(doc => {
                    const message = doc.data();
                    const messageElement = document.createElement('div');
                    messageElement.className = `message ${message.senderType}`;
                    messageElement.setAttribute('data-message-id', doc.id);
                    
                    const time = message.createdAt ? new Date(message.createdAt.toDate()).toLocaleTimeString() : 'Just now';
                    
                    messageElement.innerHTML = `
                        <div style="display: flex; justify-content: space-between; align-items: start;">
                            <div>
                                ${message.senderType === 'model' || message.senderType === 'admin' ? 
                                    `<div class="message-sender">${message.senderType === 'model' ? 'Model' : 'Admin'}</div>` : 
                                    `<div class="message-sender">User</div>`}
                                <div class="message-text">${message.text}</div>
                            </div>
                            <button class="btn btn-sm btn-outline" onclick="deleteMessage('${doc.id}')" style="margin-left: 1rem;">
                                <i class="fas fa-trash"></i>
                            </button>
                        </div>
                        <div class="message-time">${time}</div>
                    `;
                    
                    messagesContainer.appendChild(messageElement);
                });
                
                // Scroll to bottom
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            });

    } catch (error) {
        console.error('Error loading admin messages:', error);
    }
}

async function sendAdminChatMessage() {
    const messageText = document.getElementById('adminChatInput').value.trim();
    
    if (!messageText || !currentAdminConversationId) {
        return;
    }

    try {
        // Get conversation details
        const conversationDoc = await conversationsRef.doc(currentAdminConversationId).get();
        const conversation = conversationDoc.data();
        
        await chatsRef.add({
            conversationId: currentAdminConversationId,
            text: messageText,
            senderType: 'model',
            userId: 'admin',
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            read: false
        });

        // Update conversation
        await conversationsRef.doc(currentAdminConversationId).update({
            lastMessage: messageText,
            lastMessageAt: firebase.firestore.FieldValue.serverTimestamp(),
            hasUnread: true, // Mark as unread for user
            adminReplied: true
        });

        // Create notification for user
        await notificationsRef.add({
            userId: conversation.userId,
            type: 'new_message',
            title: `New message from ${conversation.modelName}`,
            message: messageText,
            conversationId: currentAdminConversationId,
            read: false,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        document.getElementById('adminChatInput').value = '';
        toastr.success('Message sent! User will be notified.');
        
    } catch (error) {
        console.error('Error sending admin message:', error);
        toastr.error('Failed to send message');
    }
}

async function deleteMessage(messageId) {
    if (!confirm('Are you sure you want to delete this message?')) {
        return;
    }

    try {
        await chatsRef.doc(messageId).delete();
        toastr.success('Message deleted successfully');
    } catch (error) {
        console.error('Error deleting message:', error);
        toastr.error('Failed to delete message');
    }
}

async function deleteConversation() {
    if (!currentAdminConversationId) return;
    
    if (!confirm('Are you sure you want to delete this entire conversation? This cannot be undone.')) {
        return;
    }

    try {
        // Delete all messages in the conversation
        const messagesSnapshot = await chatsRef
            .where('conversationId', '==', currentAdminConversationId)
            .get();
        
        const deletePromises = messagesSnapshot.docs.map(doc => doc.ref.delete());
        await Promise.all(deletePromises);
        
        // Delete the conversation
        await conversationsRef.doc(currentAdminConversationId).delete();
        
        toastr.success('Conversation deleted successfully');
        closeActiveChat();
        loadAdminConversations();
        
    } catch (error) {
        console.error('Error deleting conversation:', error);
        toastr.error('Failed to delete conversation');
    }
}

// Utility functions for chat
function toggleChatInfo() {
    // Implement chat info toggle if needed
    toastr.info('Chat info feature coming soon!');
}

function toggleEmojiPicker() {
    // Implement emoji picker if needed
    toastr.info('Emoji picker coming soon!');
}

// Admin Functions
function openAdminLogin() {
    openModal('adminLoginModal');
}

async function adminLogin() {
    const email = document.getElementById('adminEmail').value;
    const password = document.getElementById('adminPassword').value;

    if (!email || !password) {
        toastr.error('Please enter email and password');
        return;
    }

    try {
        const userCredential = await auth.signInWithEmailAndPassword(email, password);
        const user = userCredential.user;
        
        // Verify admin role
        const userDoc = await usersRef.doc(user.uid).get();
        if (userDoc.exists && userDoc.data().role === 'admin') {
            toastr.success('Admin login successful!');
            closeModal('adminLoginModal');
        } else {
            await auth.signOut();
            toastr.error('Access denied. Admin privileges required.');
        }
    } catch (error) {
        console.error('Admin login error:', error);
        toastr.error('Login failed: ' + error.message);
    }
}

function showAdminPanel() {
    document.getElementById('adminPanel').style.display = 'block';
    loadUsersList();
    loadPostsList();
    loadSessionsList();
    loadAdminConversations();
}

function hideAdminPanel() {
    document.getElementById('adminPanel').style.display = 'none';
}

async function adminLogout() {
    try {
        if (chatUnsubscribe) chatUnsubscribe();
        if (conversationsUnsubscribe) conversationsUnsubscribe();
        if (adminChatUnsubscribe) adminChatUnsubscribe();
        await auth.signOut();
        toastr.info('Logged out successfully');
    } catch (error) {
        console.error('Logout error:', error);
    }
}

function switchAdminTab(tabName) {
    // Hide all tabs
    document.querySelectorAll('.admin-content').forEach(tab => {
        tab.classList.remove('active');
    });
    document.querySelectorAll('.admin-tab').forEach(button => {
        button.classList.remove('active');
    });

    // Show selected tab
    document.getElementById(tabName + 'Tab').classList.add('active');
    event.target.classList.add('active');

    // Load specific data for certain tabs
    if (tabName === 'sessions') {
        loadSessionsList();
    } else if (tabName === 'chats') {
        openAdminChatModal();
    } else if (tabName === 'users') {
        loadUsersList();
    } else if (tabName === 'posts') {
        loadPostsList();
    }
}

// Model Management
async function handleModelSubmit(e) {
    e.preventDefault();
    
    const modelData = {
        name: document.getElementById('modelName').value,
        image: document.getElementById('modelImage').value,
        verified: document.getElementById('modelVerified').value === 'true',
        likes: parseInt(document.getElementById('modelLikes').value) || 0,
        comments: document.getElementById('modelComments').value.split('\n').filter(c => c.trim()),
        publicPosts: document.getElementById('modelPublicPosts').value.split('\n').filter(p => p.trim()),
        commentsCount: parseInt(document.getElementById('modelCommentsCount').value) || 3,
        videoCallLink: document.getElementById('videoCallLink').value,
        contentType: document.getElementById('contentType').value,
        embedVideo: document.getElementById('embedVideo').value,
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
    };

    try {
        if (currentEditingModel) {
            // Update existing model
            await modelsRef.doc(currentEditingModel).update(modelData);
            toastr.success('Model updated successfully!');
            currentEditingModel = null;
            
            // Reset button text
            const submitBtn = document.querySelector('#modelForm button[type="submit"]');
            submitBtn.innerHTML = '<i class="fas fa-save"></i> Add Model';
        } else {
            // Add new model
            await modelsRef.add(modelData);
            toastr.success('Model added successfully!');
        }
        
        document.getElementById('modelForm').reset();
        await loadModels();
        
    } catch (error) {
        console.error('Error saving model:', error);
        toastr.error('Failed to save model: ' + error.message);
    }
}

function editModel(modelId) {
    const model = allModels.find(m => m.id === modelId);
    if (!model) return;

    currentEditingModel = modelId;
    
    // Populate form
    document.getElementById('modelName').value = model.name;
    document.getElementById('modelImage').value = model.image;
    document.getElementById('modelVerified').value = model.verified ? 'true' : 'false';
    document.getElementById('modelLikes').value = model.likes || 0;
    document.getElementById('modelCommentsCount').value = model.commentsCount || 3;
    document.getElementById('modelComments').value = model.comments ? model.comments.join('\n') : '';
    document.getElementById('modelPublicPosts').value = model.publicPosts ? model.publicPosts.join('\n') : '';
    document.getElementById('videoCallLink').value = model.videoCallLink || '';
    document.getElementById('contentType').value = model.contentType || 'public';
    document.getElementById('embedVideo').value = model.embedVideo || '';

    // Change button text
    const submitBtn = document.querySelector('#modelForm button[type="submit"]');
    submitBtn.innerHTML = '<i class="fas fa-save"></i> Update Model';
    
    toastr.info('Editing model: ' + model.name);
}

async function deleteModel(modelId) {
    if (!confirm('Are you sure you want to delete this model? This action cannot be undone.')) {
        return;
    }

    try {
        await modelsRef.doc(modelId).delete();
        toastr.success('Model deleted successfully!');
        await loadModels();
    } catch (error) {
        console.error('Error deleting model:', error);
        toastr.error('Failed to delete model');
    }
}

function updateAdminModelsList() {
    const modelsList = document.getElementById('modelsList');
    modelsList.innerHTML = '';

    allModels.forEach(model => {
        const modelCard = document.createElement('div');
        modelCard.className = 'card';
        modelCard.innerHTML = `
            <img src="${model.image}" alt="${model.name}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;">
            <h4>${model.name} ${model.verified ? '<i class="fas fa-check-circle verified"></i>' : ''}</h4>
            <p><strong>Likes:</strong> ${model.likes || 0}</p>
            <p><strong>Comments:</strong> ${model.comments ? model.comments.length : 0}</p>
            <p><strong>Public Posts:</strong> ${model.publicPosts ? model.publicPosts.length : 0}</p>
            <p><strong>Type:</strong> ${model.contentType === 'private' ? 'Private' : 'Public'}</p>
            <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                <button class="btn btn-primary" onclick="editModel('${model.id}')" style="flex: 1;">
                    <i class="fas fa-edit"></i> Edit
                </button>
                <button class="btn btn-danger" onclick="deleteModel('${model.id}')" style="flex: 1;">
                    <i class="fas fa-trash"></i> Delete
                </button>
            </div>
        `;
        modelsList.appendChild(modelCard);
    });
}

// Session Management
async function loadSessionsList() {
    try {
        const snapshot = await bookingsRef.orderBy('createdAt', 'desc').get();
        const sessionsList = document.getElementById('sessionsList');
        sessionsList.innerHTML = '';

        if (snapshot.empty) {
            sessionsList.innerHTML = '<p>No session requests found.</p>';
            return;
        }

        snapshot.forEach(doc => {
            const session = { id: doc.id, ...doc.data() };
            const sessionCard = document.createElement('div');
            sessionCard.className = 'session-card';
            
            const statusClass = `status-${session.status}`;
            const formattedDate = session.callDateTime ? 
                new Date(session.callDateTime).toLocaleString() : 'Not specified';
            
            sessionCard.innerHTML = `
                <div class="session-header">
                    <h4>${session.modelName}</h4>
                    <span class="session-status ${statusClass}">${session.status.toUpperCase()}</span>
                </div>
                <p><strong>Client:</strong> ${session.userEmail}</p>
                <p><strong>Requested Time:</strong> ${formattedDate}</p>
                ${session.specialRequests ? `<p><strong>Special Requests:</strong> ${session.specialRequests}</p>` : ''}
                <p><strong>Submitted:</strong> ${session.createdAt ? new Date(session.createdAt.toDate()).toLocaleString() : 'N/A'}</p>
                <div class="session-actions">
                    ${session.status === 'pending' ? `
                        <button class="btn btn-success btn-sm" onclick="updateSessionStatus('${session.id}', 'confirmed')">
                            <i class="fas fa-check"></i> Confirm
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="updateSessionStatus('${session.id}', 'cancelled')">
                            <i class="fas fa-times"></i> Deny
                        </button>
                    ` : ''}
                    ${session.status === 'confirmed' ? `
                        <button class="btn btn-warning btn-sm" onclick="updateSessionStatus('${session.id}', 'pending')">
                            <i class="fas fa-clock"></i> Mark Pending
                        </button>
                        <button class="btn btn-danger btn-sm" onclick="updateSessionStatus('${session.id}', 'cancelled')">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    ` : ''}
                    ${session.status === 'cancelled' ? `
                        <button class="btn btn-success btn-sm" onclick="updateSessionStatus('${session.id}', 'confirmed')">
                            <i class="fas fa-check"></i> Confirm
                        </button>
                        <button class="btn btn-warning btn-sm" onclick="updateSessionStatus('${session.id}', 'pending')">
                            <i class="fas fa-clock"></i> Mark Pending
                        </button>
                    ` : ''}
                    <button class="btn btn-danger btn-sm" onclick="deleteSession('${session.id}')">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            `;
            sessionsList.appendChild(sessionCard);
        });
    } catch (error) {
        console.error('Error loading sessions:', error);
        toastr.error('Failed to load session requests');
    }
}

async function updateSessionStatus(sessionId, status) {
    try {
        await bookingsRef.doc(sessionId).update({
            status: status,
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        toastr.success(`Session ${status} successfully!`);
        await loadSessionsList();
    } catch (error) {
        console.error('Error updating session:', error);
        toastr.error('Failed to update session');
    }
}

async function deleteSession(sessionId) {
    if (!confirm('Are you sure you want to delete this session request?')) {
        return;
    }

    try {
        await bookingsRef.doc(sessionId).delete();
        toastr.success('Session request deleted successfully!');
        await loadSessionsList();
    } catch (error) {
        console.error('Error deleting session:', error);
        toastr.error('Failed to delete session request');
    }
}

// User Management
async function handleUserCreate(e) {
    e.preventDefault();
    
    const email = document.getElementById('userEmail').value;
    const password = document.getElementById('userPassword').value;

    try {
        // Create user in Firebase Auth
        const userCredential = await auth.createUserWithEmailAndPassword(email, password);
        const user = userCredential.user;

        // Create user document
        const expiresAt = new Date();
        expiresAt.setMonth(expiresAt.getMonth() + 1);

        await usersRef.doc(user.uid).set({
            email: email,
            role: 'user',
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            expiresAt: expiresAt,
            isActive: true,
            createdBy: adminUser.uid
        });

        toastr.success(`User created successfully! Login details sent to ${email}`);
        document.getElementById('userForm').reset();
        await loadUsersList();

        // Sign out the created user (admin should remain logged in)
        await auth.signOut();
        await auth.signInWithEmailAndPassword(adminUser.email, document.getElementById('adminPassword').value);

    } catch (error) {
        console.error('Error creating user:', error);
        toastr.error('Failed to create user: ' + error.message);
    }
}

async function loadUsersList() {
    try {
        const snapshot = await usersRef.where('role', '==', 'user').get();
        const usersList = document.getElementById('usersList');
        usersList.innerHTML = '';

        snapshot.forEach(doc => {
            const user = { id: doc.id, ...doc.data() };
            const userDiv = document.createElement('div');
            userDiv.className = 'card';
            
            const isExpired = user.expiresAt && new Date() > user.expiresAt.toDate();
            const statusClass = isExpired ? 'expired' : '';
            
            userDiv.innerHTML = `
                <h4>${user.email}</h4>
                <p><strong>Created:</strong> ${user.createdAt ? new Date(user.createdAt.toDate()).toLocaleDateString() : 'N/A'}</p>
                <p><strong>Expires:</strong> <span class="${statusClass}">${user.expiresAt ? new Date(user.expiresAt.toDate()).toLocaleDateString() : 'N/A'}</span></p>
                <p><strong>Status:</strong> ${user.isActive ? 'Active' : 'Banned'}</p>
                <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                    <button class="btn btn-danger" onclick="banUser('${user.id}')" style="flex: 1;" ${!user.isActive ? 'disabled' : ''}>
                        <i class="fas fa-ban"></i> ${user.isActive ? 'Ban' : 'Banned'}
                    </button>
                    <button class="btn btn-success" onclick="renewUser('${user.id}')" style="flex: 1;">
                        <i class="fas fa-sync-alt"></i> Renew
                    </button>
                </div>
            `;
            usersList.appendChild(userDiv);
        });
    } catch (error) {
        console.error('Error loading users:', error);
        toastr.error('Failed to load users');
    }
}

async function banUser(userId) {
    if (!confirm('Are you sure you want to ban this user?')) {
        return;
    }

    try {
        await usersRef.doc(userId).update({ 
            isActive: false,
            bannedAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        toastr.success('User banned successfully!');
        await loadUsersList();
    } catch (error) {
        console.error('Error banning user:', error);
        toastr.error('Failed to ban user');
    }
}

async function renewUser(userId) {
    const expiresAt = new Date();
    expiresAt.setMonth(expiresAt.getMonth() + 1);

    try {
        await usersRef.doc(userId).update({ 
            expiresAt: expiresAt,
            isActive: true
        });
        toastr.success('User subscription renewed for 1 month!');
        await loadUsersList();
    } catch (error) {
        console.error('Error renewing user:', error);
        toastr.error('Failed to renew user subscription');
    }
}

// Content Settings
async function updateContentSettings() {
    try {
        await settingsRef.set({
            backgroundImage: document.getElementById('backgroundImage').value,
            subscriptionImage: document.getElementById('subscriptionImage').value,
            subscriptionLink: document.getElementById('subscriptionLink').value,
            renewalImage: document.getElementById('renewalImage').value,
            renewalLink: document.getElementById('renewalLink').value
        }, { merge: true });

        await loadWebsiteSettings();
        toastr.success('Content settings updated successfully!');
    } catch (error) {
        console.error('Error updating content settings:', error);
        toastr.error('Failed to update content settings');
    }
}

// Posts Management
async function handlePostSubmit(e) {
    e.preventDefault();
    
    const postData = {
        title: document.getElementById('postTitle').value,
        content: document.getElementById('postContent').value,
        buttonText: document.getElementById('postButtonText').value,
        buttonLink: document.getElementById('postButtonLink').value,
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        createdBy: adminUser.uid
    };

    try {
        await postsRef.add(postData);
        toastr.success('Post broadcasted to all users!');
        document.getElementById('postForm').reset();
        await loadPostsList();
    } catch (error) {
        console.error('Error broadcasting post:', error);
        toastr.error('Failed to broadcast post');
    }
}

async function loadPostsList() {
    try {
        const snapshot = await postsRef.orderBy('createdAt', 'desc').limit(10).get();
        const postsList = document.getElementById('postsList');
        postsList.innerHTML = '';

        snapshot.forEach(doc => {
            const post = { id: doc.id, ...doc.data() };
            const postDiv = document.createElement('div');
            postDiv.className = 'card';
            postDiv.innerHTML = `
                <h4>${post.title}</h4>
                <p>${post.content}</p>
                ${post.buttonText && post.buttonLink ? `
                    <p><strong>Button:</strong> ${post.buttonText} → ${post.buttonLink}</p>
                ` : ''}
                <p><small>Posted: ${post.createdAt ? new Date(post.createdAt.toDate()).toLocaleString() : 'N/A'}</small></p>
                <button class="btn btn-danger" onclick="deletePost('${post.id}')" style="margin-top: 1rem;">
                    <i class="fas fa-trash"></i> Delete
                </button>
            `;
            postsList.appendChild(postDiv);
        });
    } catch (error) {
        console.error('Error loading posts:', error);
    }
}

async function deletePost(postId) {
    if (!confirm('Are you sure you want to delete this post?')) {
        return;
    }

    try {
        await postsRef.doc(postId).delete();
        toastr.success('Post deleted successfully!');
        await loadPostsList();
    } catch (error) {
        console.error('Error deleting post:', error);
        toastr.error('Failed to delete post');
    }
}

// Website Settings
async function updateWebsiteSettings() {
    try {
        await settingsRef.set({
            websiteTitle: document.getElementById('websiteTitle').value,
            welcomeMessage: document.getElementById('welcomeMessage').value,
            primaryColor: document.getElementById('primaryColor').value,
            secondaryColor: document.getElementById('secondaryColor').value
        }, { merge: true });

        await loadWebsiteSettings();
        toastr.success('Website settings updated successfully!');
    } catch (error) {
        console.error('Error updating website settings:', error);
        toastr.error('Failed to update website settings');
    }
}

// User Interface Functions
function showUserInterface() {
    document.getElementById('userInfo').style.display = 'block';
    updateUserInfo();
}

function hideUserInterface() {
    document.getElementById('userInfo').style.display = 'none';
    document.getElementById('privateContent').style.display = 'none';
}

function updateUserInfo() {
    if (currentUser) {
        document.getElementById('accountCreated').textContent = 
            currentUser.createdAt ? new Date(currentUser.createdAt.toDate()).toLocaleDateString() : 'N/A';
        document.getElementById('accountExpires').textContent = 
            currentUser.expiresAt ? new Date(currentUser.expiresAt.toDate()).toLocaleDateString() : 'N/A';
        startAccountTimer();
    }
}

function startAccountTimer() {
    function updateTimer() {
        if (!currentUser || !currentUser.expiresAt) return;
        
        const now = new Date();
        const expires = currentUser.expiresAt.toDate();
        const diff = expires - now;

        const timerElement = document.getElementById('accountTimer');
        
        if (diff <= 0) {
            timerElement.textContent = 'SUBSCRIPTION EXPIRED';
            timerElement.className = 'account-timer expired';
            openModal('renewalModal');
            return;
        }

        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        const seconds = Math.floor((diff % (1000 * 60)) / 1000);

        timerElement.textContent = 
            `${days}d ${hours}h ${minutes}m ${seconds}s remaining`;
        timerElement.className = 'account-timer';
    }

    updateTimer();
    setInterval(updateTimer, 1000);
}

function checkAccountExpiry() {
    if (!currentUser || !currentUser.expiresAt) return;
    
    const now = new Date();
    const expires = currentUser.expiresAt.toDate();

    if (now > expires) {
        openModal('renewalModal');
    }
}

function renewAccount() {
    toastr.info('Redirecting to renewal page...');
    redirectToRenewal();
}

// Modal Functions
function openModal(modalId) {
    document.getElementById(modalId).style.display = 'block';
    document.body.style.overflow = 'hidden';
    
    // Set modal images if available
    if (modalId === 'subscriptionModal' && websiteSettings.subscriptionImage) {
        document.getElementById('subscriptionModalImage').src = websiteSettings.subscriptionImage;
    }
    if (modalId === 'renewalModal' && websiteSettings.renewalImage) {
        document.getElementById('renewalModalImage').src = websiteSettings.renewalImage;
    }
}

function closeModal(modalId) {
    document.getElementById(modalId).style.display = 'none';
    document.body.style.overflow = 'auto';
    
    // Clean up chat listeners
    if (modalId === 'chatModal' && chatUnsubscribe) {
        chatUnsubscribe();
        chatUnsubscribe = null;
    }
    if (modalId === 'adminChatModal') {
        if (conversationsUnsubscribe) {
            conversationsUnsubscribe();
        }
        if (adminChatUnsubscribe) {
            adminChatUnsubscribe();
        }
        closeActiveChat();
    }
}

function openLoginModal() {
    openModal('userLoginModal');
}

async function userLogin() {
    const email = document.getElementById('loginEmail').value;
    const password = document.getElementById('loginPassword').value;

    try {
        await auth.signInWithEmailAndPassword(email, password);
        closeModal('userLoginModal');
    } catch (error) {
        console.error('Login error:', error);
        toastr.error('Login failed: ' + error.message);
    }
}

// FIXED: Update Auth Buttons to properly show logout when user is logged in
function updateAuthButtons() {
    const authButtons = document.getElementById('authButtons');
    
    if (currentUser || adminUser) {
        // User is logged in (either regular user or admin)
        authButtons.innerHTML = `
            <button class="btn btn-outline" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
            ${!adminUser ? `
                <button class="btn btn-primary" onclick="openAdminLogin()">
                    <i class="fas fa-cog"></i> Admin
                </button>
            ` : ''}
        `;
    } else {
        // User is not logged in
        authButtons.innerHTML = `
            <button class="btn btn-outline" onclick="openLoginModal()">
                <i class="fas fa-user"></i> Login
            </button>
            <button class="btn btn-primary" onclick="openAdminLogin()">
                <i class="fas fa-cog"></i> Admin
            </button>
        `;
    }
}

function redirectToSubscribe() {
    if (websiteSettings.subscriptionLink) {
        window.location.href = websiteSettings.subscriptionLink;
    } else {
        toastr.error('Subscription link not configured');
    }
}

function redirectToRenewal() {
    if (websiteSettings.renewalLink) {
        window.location.href = websiteSettings.renewalLink;
    } else {
        toastr.error('Renewal link not configured');
    }
}

// Utility Functions
async function logout() {
    try {
        if (chatUnsubscribe) chatUnsubscribe();
        if (conversationsUnsubscribe) conversationsUnsubscribe();
        if (adminChatUnsubscribe) adminChatUnsubscribe();
        await auth.signOut();
        toastr.info('Logged out successfully');
    } catch (error) {
        console.error('Logout error:', error);
    }
}

function scrollToModels() {
    document.getElementById('models').scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
    });
}

// Close modal when clicking outside
window.onclick = function(event) {
    const modals = document.getElementsByClassName('modal');
    for (let modal of modals) {
        if (event.target === modal) {
            closeModal(modal.id);
        }
    }
}

// Handle escape key to close modals
document.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        const modals = document.getElementsByClassName('modal');
        for (let modal of modals) {
            if (modal.style.display === 'block') {
                closeModal(modal.id);
            }
        }
    }
});

// Initialize UI
function initializeUI() {
    console.log('Camsilo website initialized successfully');
    
    // Add notification badge for unread messages
    const navLinks = document.querySelector('.nav-links');
    const chatLink = document.createElement('a');
    chatLink.href = '#';
    chatLink.innerHTML = '<i class="fas fa-comments"></i> Messages';
    chatLink.onclick = function(e) {
        e.preventDefault();
        if (currentUser) {
            // Show user's conversations or open first model chat
            if (allModels.length > 0) {
                openChatModal(allModels[0].id);
            }
        }
    };
    navLinks.appendChild(chatLink);
}

// Call initialization
initializeUI();
</script>
</body>
</html>
