<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxuria Casino | Premium Gaming Experience</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@300;400;600;700&family=Playfair+Display:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <style>
        :root {
            --primary: #1a3a5f;
            --primary-light: #2a4d7a;
            --primary-dark: #0d2a4a;
            --accent: #d4af37;
            --accent-light: #e8c76a;
            --background: #f8f9fa;
            --card-bg: #ffffff;
            --text: #333333;
            --text-light: #666666;
            --border: #e0e0e0;
            --success: #27ae60;
            --danger: #e74c3c;
            --warning: #f39c12;
            --shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background-color: var(--background);
            color: var(--text);
            font-family: 'Nunito', sans-serif;
            line-height: 1.6;
            font-size: 16px;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        h1, h2, h3, h4 {
            font-family: 'Playfair Display', serif;
            font-weight: 600;
            color: var(--primary-dark);
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(248, 249, 250, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            transition: opacity 0.5s ease;
        }
        
        .loading-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(26, 58, 95, 0.1);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1.2s ease-in-out infinite;
            margin-bottom: 20px;
        }
        
        .loading-text {
            color: var(--primary);
            font-size: 1.2rem;
            font-weight: 500;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Auth Container */
        .auth-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
        }
        
        .auth-box {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 40px;
            width: 100%;
            max-width: 500px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
            position: relative;
        }
        
        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .logo {
            font-size: 2.5rem;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
            color: var(--primary);
            margin-bottom: 10px;
        }
        
        .auth-subtitle {
            color: var(--text-light);
            font-size: 1.1rem;
            font-weight: 400;
        }
        
        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .form-label {
            font-size: 1rem;
            font-weight: 500;
            color: var(--text);
        }
        
        .form-input {
            padding: 14px 18px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: var(--card-bg);
            color: var(--text);
            font-size: 1rem;
            transition: var(--transition);
            font-family: 'Nunito', sans-serif;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(26, 58, 95, 0.1);
        }
        
        .form-hint {
            color: var(--text-light);
            font-size: 0.9rem;
            font-weight: 400;
        }
        
        .error-message {
            color: var(--danger);
            font-size: 0.95rem;
            font-weight: 500;
            text-align: center;
            padding: 10px 0;
            min-height: 40px;
        }
        
        .auth-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            box-shadow: var(--shadow);
            font-family: 'Nunito', sans-serif;
        }
        
        .auth-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }
        
        .auth-footer {
            text-align: center;
            margin-top: 25px;
            color: var(--text-light);
            font-size: 1rem;
        }
        
        .auth-link {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
        }
        
        .auth-link:hover {
            text-decoration: underline;
        }
        
        /* Dashboard */
        .dashboard {
            display: none;
            min-height: 100vh;
            padding-bottom: 50px;
            background: var(--background);
        }
        
        header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 20px;
            padding: 20px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--border);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }
        
        .user-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            font-weight: 700;
            flex-shrink: 0;
        }
        
        .user-name {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--primary-dark);
        }
        
        .user-email {
            font-size: 0.95rem;
            color: var(--text-light);
        }
        
        .balance-container {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }
        
        .balance-box {
            background: var(--card-bg);
            border-radius: 12px;
            padding: 18px 22px;
            min-width: 200px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            transition: var(--transition);
            box-shadow: var(--shadow);
        }
        
        .balance-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: var(--text-light);
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .balance-value {
            font-size: 1.8rem;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
            color: var(--primary);
        }
        
        .bonus-value {
            color: var(--accent);
        }
        
        .withdrawable-value {
            color: var(--primary);
        }
        
        .header-actions {
            display: flex;
            gap: 12px;
        }
        
        .tab-btn {
            background: var(--card-bg);
            color: var(--text);
            border: 1px solid var(--border);
            padding: 10px 20px;
            border-radius: 10px;
            font-size: 0.95rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 8px;
            font-family: 'Nunito', sans-serif;
        }
        
        .tab-btn:hover {
            background: rgba(26, 58, 95, 0.05);
            color: var(--primary);
            border-color: var(--primary);
        }
        
        .tab-btn.active {
            background: rgba(26, 58, 95, 0.1);
            color: var(--primary);
            border-color: var(--primary);
        }
        
        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 12px;
            margin-bottom: 30px;
            overflow-x: auto;
            padding-bottom: 10px;
        }
        
        .nav-tabs::-webkit-scrollbar {
            height: 6px;
        }
        
        .nav-tabs::-webkit-scrollbar-thumb {
            background: var(--primary);
            border-radius: 3px;
        }
        
        /* Game Content */
        .game-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }
        
        .game-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .game-header {
            margin-bottom: 30px;
            text-align: center;
            padding: 20px;
            background: var(--card-bg);
            border-radius: 14px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }
        
        .game-title {
            font-size: 2.2rem;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .game-subtitle {
            color: var(--text-light);
            font-size: 1.1rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.7;
        }
        
        /* Limbo Game */
        .limbo-game {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }
        
        @media (max-width: 992px) {
            .limbo-game {
                grid-template-columns: 1fr;
            }
        }
        
        .limbo-display {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 300px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }
        
        .limbo-display::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--primary), var(--accent));
        }
        
        .limbo-multiplier {
            font-size: 4rem;
            font-weight: 700;
            color: var(--primary);
            transition: var(--transition);
            font-family: 'Playfair Display', serif;
        }
        
        .limbo-multiplier.win {
            color: var(--success);
        }
        
        .limbo-multiplier.loss {
            color: var(--danger);
        }
        
        .limbo-controls {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            border: 1px solid var(--border);
            display: flex;
            flex-direction: column;
            gap: 20px;
            box-shadow: var(--shadow);
        }
        
        .bet-controls {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .bet-amount, .target-multiplier {
            padding: 14px 18px;
            border-radius: 10px;
            border: 1px solid var(--border);
            background: var(--card-bg);
            color: var(--text);
            font-size: 1.05rem;
            transition: var(--transition);
            width: 100%;
        }
        
        .balance-toggle {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 10px 0;
        }
        
        .balance-toggle input {
            width: 22px;
            height: 22px;
            accent-color: var(--primary);
        }
        
        .play-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            box-shadow: var(--shadow);
            font-family: 'Nunito', sans-serif;
        }
        
        .play-btn:hover {
            background: var(--primary-light);
            transform: translateY(-2px);
        }
        
        /* History */
        .history-container {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 25px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }
        
        .history-title {
            display: flex;
            align-items: center;
            gap: 12px;
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid var(--border);
            color: var(--primary);
        }
        
        .history-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 12px;
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 15px;
            border-radius: 10px;
            background: var(--background);
            font-size: 0.95rem;
            transition: var(--transition);
            border: 1px solid var(--border);
        }
        
        .history-item:hover {
            background: rgba(26, 58, 95, 0.05);
            transform: translateY(-2px);
        }
        
        .history-win {
            color: var(--success);
            font-weight: 600;
        }
        
        .history-loss {
            color: var(--danger);
            font-weight: 600;
        }
        
        /* Wheel Game */
        .wheel-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 40px;
        }
        
        .wheel {
            width: 300px;
            height: 300px;
            position: relative;
            margin: 40px auto;
        }
        
        .wheel-circle {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            background: conic-gradient(
                #e74c3c 0deg 45deg,
                #3498db 45deg 90deg,
                #2ecc71 90deg 135deg,
                #f1c40f 135deg 180deg,
                #9b59b6 180deg 225deg,
                #e67e22 225deg 270deg,
                #1abc9c 270deg 315deg,
                #34495e 315deg 360deg
            );
            position: relative;
            transform: rotate(0deg);
            transition: transform 3s cubic-bezier(0.17, 0.67, 0.14, 0.93);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }
        
        .wheel-pointer {
            position: absolute;
            top: -20px;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 40px;
            background: var(--primary);
            clip-path: polygon(50% 100%, 0 0, 100% 0);
            z-index: 10;
        }
        
        .wheel-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 50px;
            height: 50px;
            background: var(--accent);
            border-radius: 50%;
            z-index: 5;
            display: flex;
            justify-content: center;
            align-items: center;
            color: white;
            font-weight: bold;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.2);
        }
        
        .wheel-bet-controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 400px;
        }
        
        /* Slots Game */
        .slots-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-bottom: 40px;
        }
        
        .slots-machine {
            width: 300px;
            height: 200px;
            background: var(--primary);
            border-radius: 10px;
            display: flex;
            justify-content: space-around;
            align-items: center;
            padding: 20px;
            position: relative;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
            margin-bottom: 30px;
        }
        
        .slots-reel {
            width: 80px;
            height: 160px;
            background: #f8f9fa;
            border-radius: 5px;
            overflow: hidden;
            position: relative;
            box-shadow: inset 0 0 10px rgba(0, 0, 0, 0.1);
        }
        
        .slots-symbols {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            transition: top 0.5s ease-out;
        }
        
        .slots-symbol {
            height: 80px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
        }
        
        .slots-controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
            width: 100%;
            max-width: 400px;
        }
        
        /* Footer */
        .casino-footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
            border-top: 1px solid var(--border);
            color: var(--text-light);
            font-size: 0.9rem;
        }
        
        .footer-logo {
            font-family: 'Playfair Display', serif;
            font-size: 1.8rem;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        /* Security badge */
        .security-badge {
            position: fixed;
            bottom: 15px;
            right: 15px;
            background: var(--card-bg);
            padding: 12px 16px;
            border-radius: 10px;
            font-size: 0.85rem;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            z-index: 1000;
            color: var(--primary);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .balance-container {
                justify-content: center;
            }
            
            header {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .user-info {
                flex-direction: column;
                text-align: center;
            }
            
            .header-actions {
                width: 100%;
                justify-content: center;
            }
            
            .game-title {
                font-size: 1.8rem;
            }
            
            .game-subtitle {
                font-size: 1rem;
            }
            
            .auth-box {
                padding: 30px 20px;
            }
            
            .wheel {
                width: 250px;
                height: 250px;
            }
        }
        
        /* Modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--card-bg);
            border-radius: 16px;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: var(--text-light);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-title {
            font-size: 1.6rem;
            margin-bottom: 20px;
            color: var(--primary);
        }
        
        .modal-text {
            line-height: 1.7;
            margin-bottom: 20px;
            color: var(--text);
        }
        
        /* High contrast mode toggle */
        .contrast-toggle {
            position: fixed;
            bottom: 70px;
            right: 15px;
            background: var(--card-bg);
            padding: 10px 14px;
            border-radius: 10px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 8px;
            border: 1px solid var(--border);
            box-shadow: var(--shadow);
            z-index: 1000;
            color: var(--text);
            cursor: pointer;
        }
        
        /* Hidden utility class */
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Loading overlay -->
    <div class="loading-overlay hidden" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Loading Luxuria Casino</div>
    </div>
    
    <!-- Authentication Section -->
    <div class="auth-container" id="authSection">
        <div class="auth-box" id="authBox">
            <div class="auth-header">
                <div class="logo">Luxuria</div>
                <p class="auth-subtitle">Premium Casino Experience</p>
            </div>
            
            <div id="loginForm">
                <form class="auth-form" id="loginFormElement">
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" id="loginEmail" placeholder="you@example.com" required autocomplete="email">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" id="loginPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="current-password">
                    </div>
                    
                    <div class="error-message" id="loginError"></div>
                    
                    <button type="submit" class="auth-btn" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i> Sign In
                    </button>
                </form>
                
                <div class="auth-footer">
                    <p>Don't have an account? <a class="auth-link" id="showRegister">Sign Up</a></p>
                    <p><a class="auth-link" id="forgotPassword">Forgot Password?</a></p>
                </div>
            </div>
            
            <div id="registerForm" style="display: none;">
                <form class="auth-form" id="registerFormElement">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-input" id="registerName" placeholder="John Doe" required autocomplete="name">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" id="registerEmail" placeholder="you@example.com" required autocomplete="email">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" id="registerPassword" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="new-password">
                        <small class="form-hint">Minimum 8 characters with uppercase, lowercase, and number</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confirm Password</label>
                        <input type="password" class="form-input" id="registerConfirm" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" required autocomplete="new-password">
                    </div>
                    
                    <div class="form-group">
                        <input type="checkbox" id="acceptTerms" required>
                        <label for="acceptTerms">I agree to the <a href="#" id="termsLink">Terms & Conditions</a></label>
                    </div>
                    
                    <div class="error-message" id="registerError"></div>
                    
                    <button type="submit" class="auth-btn" id="registerBtn">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                </form>
                
                <div class="auth-footer">
                    <p>Already have an account? <a class="auth-link" id="showLogin">Sign In</a></p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Dashboard -->
    <div class="dashboard hidden" id="dashboard">
        <div class="container">
            <header>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">JD</div>
                    <div>
                        <div class="user-name" id="userName">John Doe</div>
                        <div class="user-email" id="userEmail">john.doe@example.com</div>
                    </div>
                </div>
                
                <div class="balance-container">
                    <div class="balance-box">
                        <div class="balance-label">
                            <i class="fas fa-coins"></i> BONUS BALANCE
                        </div>
                        <div class="balance-value bonus-value">$<span id="bonusBalance">50.00</span></div>
                    </div>
                    <div class="balance-box">
                        <div class="balance-label">
                            <i class="fas fa-wallet"></i> WITHDRAWABLE BALANCE
                        </div>
                        <div class="balance-value withdrawable-value">$<span id="withdrawableBalance">125.50</span></div>
                    </div>
                </div>
                
                <div class="header-actions">
                    <button class="tab-btn" id="signOutBtn">
                        <i class="fas fa-sign-out-alt"></i> Sign Out
                    </button>
                </div>
            </header>
            
            <div class="nav-tabs">
                <button class="tab-btn active" data-tab="limbo">
                    <i class="fas fa-chart-line"></i> Limbo
                </button>
                <button class="tab-btn" data-tab="wheel">
                    <i class="fas fa-trophy"></i> Wheel of Fortune
                </button>
                <button class="tab-btn" data-tab="slots">
                    <i class="fas fa-dice"></i> Lucky Slots
                </button>
                <button class="tab-btn" data-tab="account">
                    <i class="fas fa-user-cog"></i> Account
                </button>
            </div>
            
            <div class="game-container">
                <!-- Limbo Game -->
                <div class="game-content active" id="limboGame">
                    <div class="game-header">
                        <h2 class="game-title">LIMBO</h2>
                        <p class="game-subtitle">Predict the multiplier and win big! Set your target multiplier and see if you can beat the odds.</p>
                    </div>
                    <div class="limbo-game">
                        <div class="limbo-display">
                            <div class="limbo-multiplier" id="limboMultiplier">1.00x</div>
                        </div>
                        <div class="limbo-controls">
                            <div class="bet-controls">
                                <input type="number" class="bet-amount" id="limboBetAmount" placeholder="Bet Amount" value="5.00" min="0.1" step="0.1">
                                <input type="number" class="target-multiplier" id="limboTarget" placeholder="Target Multiplier" value="2.00" min="1.01" step="0.01">
                            </div>
                            <div class="balance-toggle">
                                <input type="checkbox" id="useBonusBalance">
                                <label for="useBonusBalance">Use Bonus Balance</label>
                            </div>
                            <button class="play-btn" id="playLimbo">
                                <i class="fas fa-play"></i> PLAY NOW
                            </button>
                        </div>
                    </div>
                    <div class="history-container">
                        <div class="history-title">
                            <i class="fas fa-history"></i> Recent Games
                        </div>
                        <div class="history-items" id="limboHistory">
                            <!-- History will be populated dynamically -->
                        </div>
                    </div>
                </div>
                
                <!-- Wheel of Fortune Game -->
                <div class="game-content" id="wheelGame">
                    <div class="game-header">
                        <h2 class="game-title">WHEEL OF FORTUNE</h2>
                        <p class="game-subtitle">Spin the wheel for a chance to win big! Prizes range from 2x to 100x your bet.</p>
                    </div>
                    <div class="wheel-container">
                        <div class="wheel">
                            <div class="wheel-pointer"></div>
                            <div class="wheel-circle" id="wheelCircle"></div>
                            <div class="wheel-center">
                                <i class="fas fa-gem"></i>
                            </div>
                        </div>
                        <div class="wheel-bet-controls">
                            <input type="number" class="bet-amount" id="wheelBetAmount" placeholder="Bet Amount" value="5.00" min="0.1" step="0.1">
                            <div class="balance-toggle">
                                <input type="checkbox" id="wheelUseBonus">
                                <label for="wheelUseBonus">Use Bonus Balance</label>
                            </div>
                            <button class="play-btn" id="spinWheel">
                                <i class="fas fa-sync"></i> SPIN WHEEL
                            </button>
                        </div>
                    </div>
                    <div class="history-container">
                        <div class="history-title">
                            <i class="fas fa-history"></i> Recent Spins
                        </div>
                        <div class="history-items" id="wheelHistory">
                            <!-- History will be populated dynamically -->
                        </div>
                    </div>
                </div>
                
                <!-- Lucky Slots Game -->
                <div class="game-content" id="slotsGame">
                    <div class="game-header">
                        <h2 class="game-title">LUCKY SLOTS</h2>
                        <p class="game-subtitle">Spin the reels and match symbols to win! Three matching symbols in a row wins the jackpot.</p>
                    </div>
                    <div class="slots-container">
                        <div class="slots-machine">
                            <div class="slots-reel" id="reel1">
                                <div class="slots-symbols" id="reel1Symbols"></div>
                            </div>
                            <div class="slots-reel" id="reel2">
                                <div class="slots-symbols" id="reel2Symbols"></div>
                            </div>
                            <div class="slots-reel" id="reel3">
                                <div class="slots-symbols" id="reel3Symbols"></div>
                            </div>
                        </div>
                        <div class="slots-controls">
                            <input type="number" class="bet-amount" id="slotsBetAmount" placeholder="Bet Amount" value="5.00" min="0.1" step="0.1">
                            <div class="balance-toggle">
                                <input type="checkbox" id="slotsUseBonus">
                                <label for="slotsUseBonus">Use Bonus Balance</label>
                            </div>
                            <button class="play-btn" id="spinSlots">
                                <i class="fas fa-redo"></i> SPIN SLOTS
                            </button>
                        </div>
                    </div>
                    <div class="history-container">
                        <div class="history-title">
                            <i class="fas fa-history"></i> Recent Spins
                        </div>
                        <div class="history-items" id="slotsHistory">
                            <!-- History will be populated dynamically -->
                        </div>
                    </div>
                </div>
                
                <!-- Account Settings -->
                <div class="game-content" id="accountGame">
                    <div class="game-header">
                        <h2 class="game-title">ACCOUNT SETTINGS</h2>
                        <p class="game-subtitle">Manage your account details and preferences</p>
                    </div>
                    <div style="max-width: 600px; margin: 0 auto;">
                        <div class="history-container">
                            <div class="history-title">
                                <i class="fas fa-user"></i> Profile Information
                            </div>
                            <div style="padding: 20px;">
                                <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 25px;">
                                    <div class="user-avatar" id="accountAvatar">JD</div>
                                    <div>
                                        <div class="user-name" id="accountName">John Doe</div>
                                        <div class="user-email" id="accountEmail">john.doe@example.com</div>
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 30px;">
                                    <div style="font-weight: 500; margin-bottom: 10px; color: var(--primary);">Account Created</div>
                                    <div id="accountCreated">January 1, 2023</div>
                                </div>
                                
                                <div style="margin-bottom: 30px;">
                                    <div style="font-weight: 500; margin-bottom: 10px; color: var(--primary);">Last Login</div>
                                    <div id="lastLogin">Today at 14:30</div>
                                </div>
                                
                                <button class="play-btn" style="width: 100%;" id="changePasswordBtn">
                                    <i class="fas fa-key"></i> Change Password
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="casino-footer">
                <div class="footer-logo">Luxuria</div>
                <p>¬© 2023 Luxuria Casino. All rights reserved. Gambling can be addictive, please play responsibly.</p>
            </div>
        </div>
    </div>
    
    <!-- Security badge -->
    <div class="security-badge">
        <i class="fas fa-shield-alt"></i> 256-bit SSL Encryption
    </div>
    
    <!-- Contrast Toggle -->
    <div class="contrast-toggle" id="contrastToggle">
        <i class="fas fa-adjust"></i> High Contrast
    </div>
    
    <!-- Terms Modal -->
    <div class="modal-overlay" id="termsModal">
        <div class="modal-content">
            <button class="modal-close" id="closeTerms">
                <i class="fas fa-times"></i>
            </button>
            <h3 class="modal-title">Terms & Conditions</h3>
            <div class="modal-text">
                <p>Welcome to Luxuria Casino! These terms and conditions outline the rules and regulations for the use of our platform.</p>
                
                <h4 style="color: var(--primary); margin: 20px 0 10px;">1. Acceptance of Terms</h4>
                <p>By accessing this website we assume you accept these terms and conditions. Do not continue to use Luxuria Casino if you do not agree to all of the terms and conditions stated on this page.</p>
                
                <h4 style="color: var(--primary); margin: 20px 0 10px;">2. Eligibility</h4>
                <p>You must be at least 18 years of age to use this website. By using this website and by agreeing to these terms and conditions you warrant and represent that you are at least 18 years of age.</p>
                
                <h4 style="color: var(--primary); margin: 20px 0 10px;">3. Account Responsibility</h4>
                <p>You are responsible for maintaining the confidentiality of your account and password and for restricting access to your computer. You agree to accept responsibility for all activities that occur under your account or password.</p>
                
                <h4 style="color: var(--primary); margin: 20px 0 10px;">4. Responsible Gambling</h4>
                <p>We promote responsible gambling and support organizations that help problem gamblers. Please set your own limits and gamble responsibly.</p>
            </div>
            <button class="auth-btn" id="acceptTermsBtn" style="margin-top: 20px;">
                <i class="fas fa-check"></i> I Accept
            </button>
        </div>
    </div>
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBlh428ba5aSFt6x2pPkVjeEk5D6AbIU7Y",
            authDomain: "kheemz-fb9b6.firebaseapp.com",
            projectId: "kheemz-fb9b6",
            storageBucket: "kheemz-fb9b6.appspot.com",
            messagingSenderId: "593310501630",
            appId: "1:593310501630:web:c241a05e0d7c4a810173af",
            measurementId: "G-Q50WK6G76P"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // Game state
        const gameState = {
            bonusBalance: 50.00,
            withdrawableBalance: 125.50,
            currentGame: 'limbo',
            gamesPlayed: 0,
            user: null,
            userDoc: null,
            gameHistory: {
                limbo: [],
                wheel: [],
                slots: []
            }
        };
        
        // Show loading overlay
        function showLoading() {
            document.getElementById('loadingOverlay').classList.remove('hidden');
        }
        
        // Hide loading overlay
        function hideLoading() {
            document.getElementById('loadingOverlay').classList.add('hidden');
        }
        
        // Format currency
        function formatCurrency(amount) {
            return amount.toFixed(2);
        }
        
        // Update UI with current balances
        function updateBalances() {
            document.getElementById('bonusBalance').textContent = formatCurrency(gameState.bonusBalance);
            document.getElementById('withdrawableBalance').textContent = formatCurrency(gameState.withdrawableBalance);
        }
        
        // Initialize the game
        function initGame() {
            // Update balances
            updateBalances();
            
            // Tab switching
            document.querySelectorAll('.tab-btn[data-tab]').forEach(button => {
                button.addEventListener('click', () => {
                    // Remove active class from all buttons
                    document.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Add active class to clicked button
                    button.classList.add('active');
                    
                    // Hide all game content
                    document.querySelectorAll('.game-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Show selected game content
                    const gameId = button.getAttribute('data-tab');
                    document.getElementById(`${gameId}Game`).classList.add('active');
                    gameState.currentGame = gameId;
                });
            });
            
            // Play Limbo game
            document.getElementById('playLimbo').addEventListener('click', playLimbo);
            
            // Play Wheel game
            document.getElementById('spinWheel').addEventListener('click', spinWheel);
            
            // Play Slots game
            document.getElementById('spinSlots').addEventListener('click', spinSlots);
            
            // Sign out button
            document.getElementById('signOutBtn').addEventListener('click', signOut);
            
            // Toggle between login and register forms
            document.getElementById('showRegister').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('registerForm').style.display = 'block';
                document.getElementById('registerError').textContent = '';
            });
            
            document.getElementById('showLogin').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('registerForm').style.display = 'none';
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('loginError').textContent = '';
            });
            
            // Terms modal
            document.getElementById('termsLink').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('termsModal').classList.add('active');
            });
            
            document.getElementById('closeTerms').addEventListener('click', function() {
                document.getElementById('termsModal').classList.remove('active');
            });
            
            document.getElementById('acceptTermsBtn').addEventListener('click', function() {
                document.getElementById('termsModal').classList.remove('active');
                document.getElementById('acceptTerms').checked = true;
            });
            
            // Contrast toggle
            document.getElementById('contrastToggle').addEventListener('click', function() {
                document.body.classList.toggle('high-contrast');
                this.innerHTML = document.body.classList.contains('high-contrast') ? 
                    '<i class="fas fa-adjust"></i> Normal Mode' : 
                    '<i class="fas fa-adjust"></i> High Contrast';
            });
            
            // Initialize slots
            initSlots();
            
            // Load history
            loadHistory();
        }
        
        // Load game history
        function loadHistory() {
            // Limbo history
            const limboHistory = document.getElementById('limboHistory');
            limboHistory.innerHTML = '';
            
            gameState.gameHistory.limbo.slice(0, 10).forEach(game => {
                const historyItem = document.createElement('div');
                historyItem.classList.add('history-item');
                
                if (game.win) {
                    historyItem.innerHTML = `
                        <span><i class="fas fa-arrow-up"></i> WIN ${game.multiplier.toFixed(2)}x</span>
                        <span class="history-win">+$${formatCurrency(game.winAmount)}</span>
                    `;
                } else {
                    historyItem.innerHTML = `
                        <span><i class="fas fa-arrow-down"></i> LOSS ${game.multiplier.toFixed(2)}x</span>
                        <span class="history-loss">-$${formatCurrency(game.bet)}</span>
                    `;
                }
                
                limboHistory.appendChild(historyItem);
            });
            
            // Wheel history
            const wheelHistory = document.getElementById('wheelHistory');
            wheelHistory.innerHTML = '';
            
            gameState.gameHistory.wheel.slice(0, 10).forEach(spin => {
                const historyItem = document.createElement('div');
                historyItem.classList.add('history-item');
                
                historyItem.innerHTML = `
                    <span><i class="fas fa-trophy"></i> ${spin.multiplier.toFixed(1)}x</span>
                    <span class="${spin.winAmount > 0 ? 'history-win' : 'history-loss'}">
                        ${spin.winAmount > 0 ? '+' : ''}$${formatCurrency(spin.winAmount)}
                    </span>
                `;
                
                wheelHistory.appendChild(historyItem);
            });
            
            // Slots history
            const slotsHistory = document.getElementById('slotsHistory');
            slotsHistory.innerHTML = '';
            
            gameState.gameHistory.slots.slice(0, 10).forEach(spin => {
                const historyItem = document.createElement('div');
                historyItem.classList.add('history-item');
                
                historyItem.innerHTML = `
                    <span><i class="fas fa-dice"></i> ${spin.result}</span>
                    <span class="${spin.winAmount > 0 ? 'history-win' : 'history-loss'}">
                        ${spin.winAmount > 0 ? '+' : ''}$${formatCurrency(spin.winAmount)}
                    </span>
                `;
                
                slotsHistory.appendChild(historyItem);
            });
        }
        
        // Initialize slots game
        function initSlots() {
            const symbols = ['üçí', 'üçã', 'üçá', 'üçâ', 'üçä', 'üîî', 'üíé', '7Ô∏è‚É£'];
            
            // Initialize reels
            for (let i = 1; i <= 3; i++) {
                const reel = document.getElementById(`reel${i}Symbols`);
                reel.innerHTML = '';
                
                // Add 8 symbols to each reel
                for (let j = 0; j < 8; j++) {
                    const symbol = document.createElement('div');
                    symbol.classList.add('slots-symbol');
                    symbol.textContent = symbols[Math.floor(Math.random() * symbols.length)];
                    reel.appendChild(symbol);
                }
            }
        }
        
        // Sign out function
        function signOut() {
            showLoading();
            auth.signOut().then(() => {
                document.getElementById('authSection').style.display = 'flex';
                document.getElementById('dashboard').classList.add('hidden');
                hideLoading();
            }).catch((error) => {
                console.error('Sign out error:', error);
                hideLoading();
            });
        }
        
        // Place a bet and check balance
        function placeBet(betAmount, useBonus) {
            if (useBonus) {
                if (betAmount > gameState.bonusBalance) {
                    return false;
                }
                gameState.bonusBalance -= betAmount;
            } else {
                if (betAmount > gameState.withdrawableBalance) {
                    return false;
                }
                gameState.withdrawableBalance -= betAmount;
            }
            
            updateBalances();
            return true;
        }
        
        // Add win to balance
        function addWin(winAmount, isBonus) {
            if (isBonus) {
                gameState.bonusBalance += winAmount;
            } else {
                gameState.withdrawableBalance += winAmount;
            }
            updateBalances();
        }
        
        // Save game result to Firestore
        function saveGameResult(gameType, result) {
            if (!gameState.userDoc) return;
            
            db.collection('users').doc(gameState.userDoc.id).collection('games').add({
                ...result,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                console.log('Game result saved');
            }).catch(error => {
                console.error('Error saving game result:', error);
            });
        }
        
        // Update user data in Firestore
        function updateUserData() {
            if (!gameState.userDoc) return;
            
            db.collection('users').doc(gameState.userDoc.id).update({
                bonusBalance: gameState.bonusBalance,
                withdrawableBalance: gameState.withdrawableBalance,
                lastLogin: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                console.log('User data updated');
            }).catch(error => {
                console.error('Error updating user data:', error);
            });
        }
        
        // Limbo game function
        function playLimbo() {
            const betAmount = parseFloat(document.getElementById('limboBetAmount').value);
            const targetMultiplier = parseFloat(document.getElementById('limboTarget').value);
            const useBonus = document.getElementById('useBonusBalance').checked;
            const multiplierElement = document.getElementById('limboMultiplier');
            
            // Validate bet
            if (isNaN(betAmount)) {
                toastr.error('Please enter a valid bet amount');
                return;
            }
            
            if (betAmount <= 0) {
                toastr.error('Bet amount must be greater than zero');
                return;
            }
            
            if (targetMultiplier < 1.01) {
                toastr.error('Target multiplier must be at least 1.01x');
                return;
            }
            
            showLoading();
            const playBtn = document.getElementById('playLimbo');
            playBtn.disabled = true;
            
            // Place bet
            if (!placeBet(betAmount, useBonus)) {
                hideLoading();
                playBtn.disabled = false;
                toastr.error('Not enough balance');
                return;
            }
            
            setTimeout(() => {
                // Generate random multiplier (0.1x to 100x)
                const minMultiplier = 0.1;
                const maxMultiplier = 100;
                const winProbability = 1 - (targetMultiplier / maxMultiplier);
                const win = Math.random() < winProbability;
                
                const actualMultiplier = win ? 
                    Math.max(targetMultiplier, (minMultiplier + Math.random() * (maxMultiplier - minMultiplier))) : 
                    (minMultiplier + Math.random() * (targetMultiplier - minMultiplier - 0.01));
                
                // Reset multiplier display
                multiplierElement.textContent = '1.00x';
                multiplierElement.className = 'limbo-multiplier';
                
                // Animate multiplier
                let current = 1.00;
                const interval = setInterval(() => {
                    current += 0.05;
                    multiplierElement.textContent = current.toFixed(2) + 'x';
                    
                    if (current >= actualMultiplier) {
                        clearInterval(interval);
                        multiplierElement.textContent = actualMultiplier.toFixed(2) + 'x';
                        
                        // Calculate win
                        const winAmount = win ? betAmount * targetMultiplier : 0;
                        
                        // Update balances
                        if (win) {
                            addWin(winAmount, false);
                            multiplierElement.classList.add('win');
                            toastr.success(`You won $${formatCurrency(winAmount)}!`);
                        } else {
                            multiplierElement.classList.add('loss');
                            toastr.error('Better luck next time!');
                        }
                        
                        // Add to history
                        const gameResult = {
                            game: 'limbo',
                            bet: betAmount,
                            target: targetMultiplier,
                            multiplier: actualMultiplier,
                            win: win,
                            winAmount: winAmount,
                            useBonus: useBonus
                        };
                        
                        gameState.gameHistory.limbo.unshift(gameResult);
                        if (gameState.gameHistory.limbo.length > 10) {
                            gameState.gameHistory.limbo.pop();
                        }
                        
                        // Save to Firestore
                        saveGameResult('limbo', gameResult);
                        updateUserData();
                        loadHistory();
                        
                        playBtn.disabled = false;
                        hideLoading();
                    }
                }, 20);
            }, 1000);
        }
        
        // Wheel of Fortune game
        function spinWheel() {
            const betAmount = parseFloat(document.getElementById('wheelBetAmount').value);
            const useBonus = document.getElementById('wheelUseBonus').checked;
            const wheel = document.getElementById('wheelCircle');
            
            // Validate bet
            if (isNaN(betAmount)) {
                toastr.error('Please enter a valid bet amount');
                return;
            }
            
            if (betAmount <= 0) {
                toastr.error('Bet amount must be greater than zero');
                return;
            }
            
            showLoading();
            const spinBtn = document.getElementById('spinWheel');
            spinBtn.disabled = true;
            
            // Place bet
            if (!placeBet(betAmount, useBonus)) {
                hideLoading();
                spinBtn.disabled = false;
                toastr.error('Not enough balance');
                return;
            }
            
            // Spin the wheel
            const spinDegrees = 1800 + Math.floor(Math.random() * 360);
            wheel.style.transform = `rotate(${spinDegrees}deg)`;
            
            // Calculate result after spin animation
            setTimeout(() => {
                const segments = 8;
                const segmentAngle = 360 / segments;
                const actualDegrees = spinDegrees % 360;
                const segmentIndex = Math.floor(actualDegrees / segmentAngle);
                
                // Multipliers for each segment
                const multipliers = [2, 5, 1, 10, 2, 20, 1, 100];
                const multiplier = multipliers[segmentIndex];
                const winAmount = betAmount * multiplier;
                
                // Update balance
                addWin(winAmount, false);
                
                // Add to history
                const spinResult = {
                    game: 'wheel',
                    bet: betAmount,
                    multiplier: multiplier,
                    winAmount: winAmount,
                    useBonus: useBonus
                };
                
                gameState.gameHistory.wheel.unshift(spinResult);
                if (gameState.gameHistory.wheel.length > 10) {
                    gameState.gameHistory.wheel.pop();
                }
                
                // Save to Firestore
                saveGameResult('wheel', spinResult);
                updateUserData();
                loadHistory();
                
                spinBtn.disabled = false;
                hideLoading();
                
                toastr.success(`You won ${multiplier}x! $${formatCurrency(winAmount)} has been added to your balance.`);
            }, 3000);
        }
        
        // Slots game
        function spinSlots() {
            const betAmount = parseFloat(document.getElementById('slotsBetAmount').value);
            const useBonus = document.getElementById('slotsUseBonus').checked;
            
            // Validate bet
            if (isNaN(betAmount)) {
                toastr.error('Please enter a valid bet amount');
                return;
            }
            
            if (betAmount <= 0) {
                toastr.error('Bet amount must be greater than zero');
                return;
            }
            
            showLoading();
            const spinBtn = document.getElementById('spinSlots');
            spinBtn.disabled = true;
            
            // Place bet
            if (!placeBet(betAmount, useBonus)) {
                hideLoading();
                spinBtn.disabled = false;
                toastr.error('Not enough balance');
                return;
            }
            
            // Spin the reels
            const reels = [1, 2, 3];
            const results = [];
            
            reels.forEach(reelId => {
                const reel = document.getElementById(`reel${reelId}Symbols`);
                const randomPosition = -Math.floor(Math.random() * 8) * 80;
                reel.style.top = `${randomPosition}px`;
            });
            
            // Calculate result after spin animation
            setTimeout(() => {
                const symbols = [];
                
                reels.forEach(reelId => {
                    const reel = document.getElementById(`reel${reelId}Symbols`);
                    const computedStyle = window.getComputedStyle(reel);
                    const topPosition = parseInt(computedStyle.top);
                    const symbolIndex = Math.abs(topPosition / 80) % 8;
                    
                    const symbol = reel.children[symbolIndex].textContent;
                    symbols.push(symbol);
                });
                
                // Check for win
                let winAmount = 0;
                let resultText = '';
                
                if (symbols[0] === symbols[1] && symbols[1] === symbols[2]) {
                    // All three match
                    winAmount = betAmount * 10;
                    resultText = 'JACKPOT!';
                } else if (symbols[0] === symbols[1] || symbols[1] === symbols[2]) {
                    // Two adjacent match
                    winAmount = betAmount * 3;
                    resultText = 'TWO MATCH!';
                } else {
                    resultText = 'NO WIN';
                }
                
                // Update balance
                if (winAmount > 0) {
                    addWin(winAmount, false);
                }
                
                // Add to history
                const spinResult = {
                    game: 'slots',
                    bet: betAmount,
                    symbols: symbols,
                    result: resultText,
                    winAmount: winAmount,
                    useBonus: useBonus
                };
                
                gameState.gameHistory.slots.unshift(spinResult);
                if (gameState.gameHistory.slots.length > 10) {
                    gameState.gameHistory.slots.pop();
                }
                
                // Save to Firestore
                saveGameResult('slots', spinResult);
                updateUserData();
                loadHistory();
                
                spinBtn.disabled = false;
                hideLoading();
                
                if (winAmount > 0) {
                    toastr.success(`${resultText} You won $${formatCurrency(winAmount)}!`);
                } else {
                    toastr.error('No win this time. Try again!');
                }
            }, 2000);
        }
        
        // Sign-in with Firebase
        document.getElementById('loginFormElement').addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const errorElement = document.getElementById('loginError');
            
            showLoading();
            
            // Firebase authentication
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    gameState.user = user;
                    
                    // Set user info
                    document.getElementById('userName').textContent = user.email.split('@')[0];
                    document.getElementById('userEmail').textContent = user.email;
                    document.getElementById('userAvatar').textContent = user.email[0].toUpperCase();
                    
                    document.getElementById('accountName').textContent = user.email.split('@')[0];
                    document.getElementById('accountEmail').textContent = user.email;
                    document.getElementById('accountAvatar').textContent = user.email[0].toUpperCase();
                    
                    // Check if user document exists
                    db.collection('users').where('email', '==', email).get()
                        .then(querySnapshot => {
                            if (!querySnapshot.empty) {
                                gameState.userDoc = querySnapshot.docs[0];
                                const userData = gameState.userDoc.data();
                                
                                // Update game state
                                gameState.bonusBalance = userData.bonusBalance || 50.00;
                                gameState.withdrawableBalance = userData.withdrawableBalance || 125.50;
                                
                                // Load game history
                                db.collection('users').doc(gameState.userDoc.id).collection('games')
                                    .orderBy('timestamp', 'desc')
                                    .limit(30)
                                    .get()
                                    .then(snapshot => {
                                        gameState.gameHistory = { limbo: [], wheel: [], slots: [] };
                                        
                                        snapshot.forEach(doc => {
                                            const game = doc.data();
                                            if (game.game === 'limbo') {
                                                gameState.gameHistory.limbo.push(game);
                                            } else if (game.game === 'wheel') {
                                                gameState.gameHistory.wheel.push(game);
                                            } else if (game.game === 'slots') {
                                                gameState.gameHistory.slots.push(game);
                                            }
                                        });
                                        
                                        // Show dashboard
                                        document.getElementById('authSection').style.display = 'none';
                                        document.getElementById('dashboard').classList.remove('hidden');
                                        
                                        // Initialize game
                                        initGame();
                                        hideLoading();
                                    });
                            } else {
                                // Create new user document
                                const userRef = db.collection('users').doc();
                                userRef.set({
                                    email: email,
                                    bonusBalance: 50.00,
                                    withdrawableBalance: 125.50,
                                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                                    lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                                }).then(() => {
                                    gameState.userDoc = userRef;
                                    
                                    // Show dashboard
                                    document.getElementById('authSection').style.display = 'none';
                                    document.getElementById('dashboard').classList.remove('hidden');
                                    
                                    // Initialize game
                                    initGame();
                                    hideLoading();
                                });
                            }
                        });
                })
                .catch((error) => {
                    hideLoading();
                    const errorCode = error.code;
                    let errorMessage = "Login failed. Please try again.";
                    
                    if (errorCode === 'auth/user-not-found') {
                        errorMessage = "No account found with this email.";
                    } else if (errorCode === 'auth/wrong-password') {
                        errorMessage = "Incorrect password.";
                    } else if (errorCode === 'auth/too-many-requests') {
                        errorMessage = "Too many login attempts. Try again later.";
                    }
                    
                    errorElement.textContent = errorMessage;
                });
        });
        
        // Registration with Firebase
        document.getElementById('registerFormElement').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirm = document.getElementById('registerConfirm').value;
            const errorElement = document.getElementById('registerError');
            
            if (password !== confirm) {
                errorElement.textContent = 'Passwords do not match';
                return;
            }
            
            if (password.length < 8) {
                errorElement.textContent = 'Password must be at least 8 characters';
                return;
            }
            
            if (!/[A-Z]/.test(password)) {
                errorElement.textContent = 'Password must contain an uppercase letter';
                return;
            }
            
            if (!/[a-z]/.test(password)) {
                errorElement.textContent = 'Password must contain a lowercase letter';
                return;
            }
            
            if (!/[0-9]/.test(password)) {
                errorElement.textContent = 'Password must contain a number';
                return;
            }
            
            showLoading();
            
            // Firebase user creation
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    gameState.user = user;
                    
                    // Create user document
                    const userRef = db.collection('users').doc();
                    userRef.set({
                        name: name,
                        email: email,
                        bonusBalance: 50.00,
                        withdrawableBalance: 125.50,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                    }).then(() => {
                        gameState.userDoc = userRef;
                        
                        // Set user info
                        document.getElementById('userName').textContent = name;
                        document.getElementById('userEmail').textContent = email;
                        document.getElementById('userAvatar').textContent = name[0].toUpperCase();
                        
                        document.getElementById('accountName').textContent = name;
                        document.getElementById('accountEmail').textContent = email;
                        document.getElementById('accountAvatar').textContent = name[0].toUpperCase();
                        document.getElementById('accountCreated').textContent = new Date().toLocaleDateString();
                        document.getElementById('lastLogin').textContent = 'Just now';
                        
                        // Show dashboard
                        document.getElementById('authSection').style.display = 'none';
                        document.getElementById('dashboard').classList.remove('hidden');
                        
                        // Initialize game
                        initGame();
                        hideLoading();
                    });
                })
                .catch((error) => {
                    hideLoading();
                    const errorCode = error.code;
                    let errorMessage = "Registration failed. Please try again.";
                    
                    if (errorCode === 'auth/email-already-in-use') {
                        errorMessage = "Email is already registered.";
                    } else if (errorCode === 'auth/invalid-email') {
                        errorMessage = "Invalid email address.";
                    } else if (errorCode === 'auth/weak-password') {
                        errorMessage = "Password is too weak.";
                    }
                    
                    errorElement.textContent = errorMessage;
                });
        });
        
        // Initialize when page loads
        window.addEventListener('load', () => {
            // Initialize Toastr
            toastr.options = {
                positionClass: 'toast-bottom-right',
                progressBar: true,
                timeOut: 3000
            };
            
            // Check if user is already signed in
            auth.onAuthStateChanged((user) => {
                if (user) {
                    showLoading();
                    gameState.user = user;
                    
                    // Set user info
                    document.getElementById('userName').textContent = user.email.split('@')[0];
                    document.getElementById('userEmail').textContent = user.email;
                    document.getElementById('userAvatar').textContent = user.email[0].toUpperCase();
                    
                    document.getElementById('accountName').textContent = user.email.split('@')[0];
                    document.getElementById('accountEmail').textContent = user.email;
                    document.getElementById('accountAvatar').textContent = user.email[0].toUpperCase();
                    
                    // Check if user document exists
                    db.collection('users').where('email', '==', user.email).get()
                        .then(querySnapshot => {
                            if (!querySnapshot.empty) {
                                gameState.userDoc = querySnapshot.docs[0];
                                const userData = gameState.userDoc.data();
                                
                                // Update game state
                                gameState.bonusBalance = userData.bonusBalance || 50.00;
                                gameState.withdrawableBalance = userData.withdrawableBalance || 125.50;
                                
                                // Load game history
                                db.collection('users').doc(gameState.userDoc.id).collection('games')
                                    .orderBy('timestamp', 'desc')
                                    .limit(30)
                                    .get()
                                    .then(snapshot => {
                                        gameState.gameHistory = { limbo: [], wheel: [], slots: [] };
                                        
                                        snapshot.forEach(doc => {
                                            const game = doc.data();
                                            if (game.game === 'limbo') {
                                                gameState.gameHistory.limbo.push(game);
                                            } else if (game.game === 'wheel') {
                                                gameState.gameHistory.wheel.push(game);
                                            } else if (game.game === 'slots') {
                                                gameState.gameHistory.slots.push(game);
                                            }
                                        });
                                        
                                        // Show dashboard
                                        document.getElementById('authSection').style.display = 'none';
                                        document.getElementById('dashboard').classList.remove('hidden');
                                        
                                        // Initialize game
                                        initGame();
                                        hideLoading();
                                    });
                            } else {
                                // Create new user document
                                const userRef = db.collection('users').doc();
                                userRef.set({
                                    email: user.email,
                                    bonusBalance: 50.00,
                                    withdrawableBalance: 125.50,
                                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                                    lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                                }).then(() => {
                                    gameState.userDoc = userRef;
                                    
                                    // Show dashboard
                                    document.getElementById('authSection').style.display = 'none';
                                    document.getElementById('dashboard').classList.remove('hidden');
                                    
                                    // Initialize game
                                    initGame();
                                    hideLoading();
                                });
                            }
                        });
                } else {
                    // Hide loader immediately if no user is signed in
                    hideLoading();
                }
            });
        });
    </script>
</body>
</html>
