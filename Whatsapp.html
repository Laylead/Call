<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camsilo - Premium Adult Entertainment</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.css" rel="stylesheet">
    <style>
        /* Previous CSS styles remain the same until we add new styles */
        :root {
            --primary: #e91e63;
            --secondary: #9c27b0;
            --dark: #121212;
            --darker: #0a0a0a;
            --light: #f5f5f5;
            --gray: #6c757d;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --surface: #1e1e1e;
            --surface-light: #2d2d2d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
        }

        /* Enhanced Header Styles */
        header {
            background: rgba(18, 18, 18, 0.98);
            backdrop-filter: blur(15px);
            padding: 1rem 2rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
        }

        /* Previous CSS styles remain the same... */
        /* ... until we add new styles for the new features */

        /* NEW STYLES FOR ADDED FEATURES */

        /* Floating Stories Section */
        .stories-container {
            position: fixed;
            top: 80px;
            left: 0;
            right: 0;
            background: rgba(30, 30, 30, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem;
            z-index: 999;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            overflow-x: auto;
            white-space: nowrap;
            display: none;
        }

        .stories-container.active {
            display: block;
        }

        .story-item {
            display: inline-block;
            width: 70px;
            text-align: center;
            margin-right: 1rem;
            cursor: pointer;
            position: relative;
        }

        .story-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            border: 2px solid var(--primary);
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .story-item.active .story-avatar {
            border-color: var(--secondary);
            box-shadow: 0 0 10px rgba(156, 39, 176, 0.7);
        }

        .story-live {
            position: absolute;
            top: 0;
            right: 0;
            background: var(--danger);
            color: white;
            font-size: 0.7rem;
            padding: 2px 5px;
            border-radius: 10px;
        }

        .story-name {
            font-size: 0.8rem;
            margin-top: 5px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Story Expanded View */
        .story-expanded {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10000;
            backdrop-filter: blur(10px);
        }

        .story-expanded.active {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .story-content {
            max-width: 90%;
            max-height: 80%;
            border-radius: 10px;
            overflow: hidden;
            position: relative;
        }

        .story-content img,
        .story-content video {
            width: 100%;
            height: auto;
            max-height: 70vh;
            object-fit: contain;
        }

        .story-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        /* Model Profile Page */
        .model-profile {
            display: none;
            padding: 6rem 2rem 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .model-profile.active {
            display: block;
        }

        .profile-header {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            padding-bottom: 2rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .profile-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 3px solid var(--primary);
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            font-size: 2rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .profile-bio {
            margin-bottom: 1rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .profile-stats {
            display: flex;
            gap: 2rem;
            margin-bottom: 1rem;
        }

        .stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        .profile-posts {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .post-card {
            background: var(--surface);
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .post-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .post-media {
            position: relative;
            overflow: hidden;
        }

        .post-media img,
        .post-media video {
            width: 100%;
            height: 300px;
            object-fit: cover;
            transition: all 0.3s ease;
        }

        .post-locked {
            filter: blur(15px);
            pointer-events: none;
        }

        .lock-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            gap: 1rem;
        }

        .lock-icon {
            font-size: 3rem;
            color: var(--primary);
        }

        .post-content {
            padding: 1rem;
        }

        .post-caption {
            margin-bottom: 1rem;
        }

        .post-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: rgba(255, 255, 255, 0.7);
        }

        /* Wallet Section */
        .wallet-section {
            display: none;
            padding: 6rem 2rem 2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .wallet-section.active {
            display: block;
        }

        .wallet-balance {
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            padding: 2rem;
            border-radius: 15px;
            text-align: center;
            margin-bottom: 2rem;
            box-shadow: 0 10px 30px rgba(233, 30, 99, 0.3);
        }

        .balance-label {
            font-size: 1.2rem;
            margin-bottom: 0.5rem;
            opacity: 0.9;
        }

        .balance-amount {
            font-size: 3rem;
            font-weight: bold;
        }

        .wallet-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .payment-methods {
            background: var(--surface);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .payment-option {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            margin-bottom: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .payment-option:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--primary);
        }

        .payment-icon {
            font-size: 1.5rem;
            color: var(--primary);
        }

        /* Video Reels Section */
        .reels-section {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--dark);
            z-index: 1000;
            overflow: hidden;
        }

        .reels-section.active {
            display: block;
        }

        .reel-container {
            position: relative;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .reel-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .reel-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 2rem;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
        }

        .reel-model-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .reel-model-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .reel-model-name {
            font-size: 1.2rem;
            font-weight: bold;
        }

        .reel-actions {
            display: flex;
            gap: 1rem;
            justify-content: flex-end;
        }

        .reel-action-btn {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .reel-action-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.1);
        }

        .reel-close {
            position: absolute;
            top: 2rem;
            right: 2rem;
            background: rgba(0, 0, 0, 0.5);
            border: none;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 1.2rem;
            cursor: pointer;
            z-index: 10;
        }

        /* Sidebar Menu */
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100%;
            background: var(--surface);
            z-index: 2000;
            transition: all 0.3s ease;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar-header {
            padding: 2rem 1.5rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .sidebar-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .sidebar-user-info {
            flex: 1;
        }

        .sidebar-user-name {
            font-weight: bold;
            margin-bottom: 0.2rem;
        }

        .sidebar-user-balance {
            color: var(--primary);
            font-size: 0.9rem;
        }

        .sidebar-menu {
            padding: 1rem 0;
        }

        .sidebar-item {
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .sidebar-item:hover {
            background: rgba(255, 255, 255, 0.05);
            border-left-color: var(--primary);
        }

        .sidebar-item.active {
            background: rgba(255, 255, 255, 0.1);
            border-left-color: var(--primary);
        }

        .sidebar-icon {
            font-size: 1.2rem;
            width: 24px;
            text-align: center;
            color: var(--primary);
        }

        .sidebar-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1999;
            display: none;
        }

        .sidebar-overlay.active {
            display: block;
        }

        /* Page Swipe Navigation */
        .page-container {
            position: relative;
            overflow: hidden;
            min-height: 100vh;
        }

        .page {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: transform 0.4s ease;
        }

        .page.hidden {
            display: none;
        }

        .page.left {
            transform: translateX(-100%);
        }

        .page.right {
            transform: translateX(100%);
        }

        .page.center {
            transform: translateX(0);
        }

        .swipe-indicator {
            position: fixed;
            bottom: 2rem;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.9rem;
            z-index: 100;
            display: none;
            animation: fadeInOut 3s infinite;
        }

        @keyframes fadeInOut {
            0%, 100% { opacity: 0.7; }
            50% { opacity: 1; }
        }

        /* Admin Story Management */
        .admin-story-form {
            background: var(--surface-light);
            padding: 1.5rem;
            border-radius: 10px;
            margin-bottom: 2rem;
        }

        .stories-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .story-admin-card {
            background: var(--surface);
            border-radius: 10px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .story-admin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.3);
        }

        .story-admin-media {
            width: 100%;
            height: 200px;
            object-fit: cover;
        }

        .story-admin-info {
            padding: 1rem;
        }

        .story-admin-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* Prevent content download */
        .no-download {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            pointer-events: none;
        }

        /* Hide hero section when logged in */
        .hero.logged-in {
            display: none !important;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .profile-header {
                flex-direction: column;
                text-align: center;
            }

            .profile-stats {
                justify-content: center;
            }

            .sidebar {
                width: 280px;
                left: -280px;
            }

            .stories-container {
                padding: 0.5rem;
            }

            .story-item {
                width: 60px;
                margin-right: 0.5rem;
            }

            .story-avatar {
                width: 50px;
                height: 50px;
            }
        }

        /* Rest of the previous CSS styles remain the same */
        /* ... */
    </style>
</head>
<body>
    <!-- Header -->
    <header id="mainHeader">
        <div class="nav-container">
            <div class="logo">Camsilo</div>
            <nav class="nav-links">
                <a href="#home" class="active">Home</a>
                <a href="#premium">Premium</a>
                <a href="#about">About</a>
            </nav>
            <div class="auth-buttons" id="authButtons">
                <button class="btn btn-outline" onclick="openLoginModal()">
                    <i class="fas fa-user"></i>Login
                </button>
            </div>
        </div>
    </header>

    <!-- Stories Section -->
    <div class="stories-container" id="storiesContainer">
        <!-- Stories will be dynamically added here -->
    </div>

    <!-- Story Expanded View -->
    <div class="story-expanded" id="storyExpanded">
        <div class="story-content" id="storyContent">
            <!-- Story content will be added here -->
        </div>
        <div class="story-actions">
            <button class="btn btn-primary" onclick="viewModelFromStory()">
                <i class="fas fa-user"></i> View Model
            </button>
            <button class="btn btn-warning" onclick="sendTipFromStory()">
                <i class="fas fa-gift"></i> Send Tip
            </button>
            <button class="btn btn-outline" onclick="closeStory()">
                <i class="fas fa-times"></i> Close
            </button>
        </div>
    </div>

    <!-- Sidebar Menu -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <img src="https://i.postimg.cc/cHB5zQYM/1758636933933.jpg" alt="User Avatar" class="sidebar-avatar" id="sidebarAvatar">
            <div class="sidebar-user-info">
                <div class="sidebar-user-name" id="sidebarUserName">Guest User</div>
                <div class="sidebar-user-balance">Balance: $<span id="sidebarBalance">0.00</span></div>
            </div>
        </div>
        <div class="sidebar-menu">
            <div class="sidebar-item active" onclick="switchPage('home')">
                <i class="fas fa-home sidebar-icon"></i>
                <span>Home</span>
            </div>
            <div class="sidebar-item" onclick="switchPage('models')">
                <i class="fas fa-users sidebar-icon"></i>
                <span>Models</span>
            </div>
            <div class="sidebar-item" onclick="switchPage('reels')">
                <i class="fas fa-play-circle sidebar-icon"></i>
                <span>Video Reels</span>
            </div>
            <div class="sidebar-item" onclick="switchPage('wallet')">
                <i class="fas fa-wallet sidebar-icon"></i>
                <span>Wallet</span>
            </div>
            <div class="sidebar-item" onclick="openAdminPanel()">
                <i class="fas fa-crown sidebar-icon"></i>
                <span>Admin Panel</span>
            </div>
            <div class="sidebar-item" onclick="logout()">
                <i class="fas fa-sign-out-alt sidebar-icon"></i>
                <span>Logout</span>
            </div>
        </div>
    </div>
    <div class="sidebar-overlay" id="sidebarOverlay" onclick="toggleSidebar()"></div>

    <!-- Page Container for Swipe Navigation -->
    <div class="page-container" id="pageContainer">
        <!-- Hero Section -->
        <section class="hero page center" id="homePage">
            <div class="hero-content">
                <h1 id="heroTitle">Camsilo models</h1>
                <p id="heroDescription">Experience the ultimate in adult entertainment with our exclusive models. Premium content, private shows, and unforgettable experiences.</p>
                <button class="btn btn-primary" id="exploreButton" onclick="openModelsGallery()">
                    <i class="fas fa-star"></i>Explore Models
                </button>
            </div>
        </section>

        <!-- Models Section -->
        <section class="frontpage-models page hidden" id="modelsPage">
            <h2 class="section-title" id="modelsSectionTitle">Featured Models</h2>
            <div class="frontpage-models-grid" id="modelsGrid">
                <!-- Models will be dynamically added here -->
            </div>
        </section>

        <!-- Video Reels Section -->
        <section class="reels-section page hidden" id="reelsPage">
            <button class="reel-close" onclick="switchPage('home')">
                <i class="fas fa-times"></i>
            </button>
            <div class="reel-container" id="reelContainer">
                <!-- Reels will be dynamically added here -->
            </div>
        </section>

        <!-- Wallet Section -->
        <section class="wallet-section page hidden" id="walletPage">
            <h2 class="section-title">Your Wallet</h2>
            <div class="wallet-balance">
                <div class="balance-label">Available Balance</div>
                <div class="balance-amount">$<span id="walletBalance">0.00</span></div>
            </div>
            <div class="wallet-actions">
                <button class="btn btn-primary" onclick="openAddFundsModal()">
                    <i class="fas fa-plus"></i> Add Funds
                </button>
                <button class="btn btn-outline" onclick="openWithdrawModal()">
                    <i class="fas fa-money-bill-wave"></i> Withdraw
                </button>
                <button class="btn btn-outline" onclick="openTransactionHistory()">
                    <i class="fas fa-history"></i> History
                </button>
            </div>
            <div class="payment-methods">
                <h3>Payment Methods</h3>
                <div class="payment-option" onclick="selectPaymentMethod('card')">
                    <i class="fas fa-credit-card payment-icon"></i>
                    <div>
                        <div>Credit/Debit Card</div>
                        <small>Secure payment with your card</small>
                    </div>
                </div>
                <div class="payment-option" onclick="selectPaymentMethod('crypto')">
                    <i class="fab fa-bitcoin payment-icon"></i>
                    <div>
                        <div>Cryptocurrency</div>
                        <small>Pay with Bitcoin or other crypto</small>
                    </div>
                </div>
                <div class="payment-option" onclick="selectPaymentMethod('paypal')">
                    <i class="fab fa-paypal payment-icon"></i>
                    <div>
                        <div>PayPal</div>
                        <small>Pay with your PayPal account</small>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Model Profile Section -->
    <section class="model-profile" id="modelProfile">
        <div class="profile-header">
            <img src="" alt="Model Avatar" class="profile-avatar" id="profileAvatar">
            <div class="profile-info">
                <div class="profile-name">
                    <span id="profileName">Model Name</span>
                    <i class="fas fa-check-circle verified" id="profileVerified"></i>
                </div>
                <p class="profile-bio" id="profileBio">Model bio will appear here...</p>
                <div class="profile-stats">
                    <div class="stat">
                        <div class="stat-value" id="profileFollowers">0</div>
                        <div class="stat-label">Followers</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="profilePosts">0</div>
                        <div class="stat-label">Posts</div>
                    </div>
                    <div class="stat">
                        <div class="stat-value" id="profileLikes">0</div>
                        <div class="stat-label">Likes</div>
                    </div>
                </div>
                <button class="btn btn-primary" onclick="followModel()" id="followButton">
                    <i class="fas fa-plus"></i> Follow
                </button>
            </div>
        </div>
        <div class="profile-posts" id="profilePosts">
            <!-- Model posts will be dynamically added here -->
        </div>
    </section>

    <!-- Swipe Indicator -->
    <div class="swipe-indicator" id="swipeIndicator">
        Swipe to navigate between pages
    </div>

    <!-- User Info Section -->
    <section class="user-info" id="userInfo" style="display: none;">
        <h2>Your Premium Account</h2>
        <div class="form-row">
            <div>
                <strong>Account Created:</strong> <span id="accountCreated">-</span>
            </div>
            <div>
                <strong>Expires:</strong> <span id="accountExpires">-</span>
            </div>
        </div>
        <div class="account-timer" id="accountTimer"></div>
        <button class="btn btn-primary" onclick="renewAccount()" style="margin-top: 1rem;">
            <i class="fas fa-sync-alt"></i>Renew Subscription
        </button>
    </section>

    <!-- Admin Panel -->
    <section class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h2 style="background: linear-gradient(45deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                <i class="fas fa-crown"></i> Admin Control Panel
            </h2>
            <button class="btn btn-danger" onclick="adminLogout()">
                <i class="fas fa-sign-out-alt"></i>Logout
            </button>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" onclick="switchAdminTab('models')">
                <i class="fas fa-users"></i>Manage Models
            </button>
            <button class="admin-tab" onclick="switchAdminTab('stories')">
                <i class="fas fa-history"></i>Manage Stories
            </button>
            <button class="admin-tab" onclick="switchAdminTab('modelProfiles')">
                <i class="fas fa-id-card"></i>Model Profiles
            </button>
            <button class="admin-tab" onclick="switchAdminTab('reels')">
                <i class="fas fa-play-circle"></i>Manage Reels
            </button>
            <button class="admin-tab" onclick="switchAdminTab('walletSettings')">
                <i class="fas fa-wallet"></i>Wallet Settings
            </button>
            <button class="admin-tab" onclick="switchAdminTab('hardcodedFrontpageModels')">
                <i class="fas fa-home"></i>Hard-coded Front Page Models
            </button>
            <button class="admin-tab" onclick="switchAdminTab('users')">
                <i class="fas fa-user-friends"></i>Manage Users
            </button>
            <button class="admin-tab" onclick="switchAdminTab('sessions')">
                <i class="fas fa-video"></i>Session Requests
            </button>
            <button class="admin-tab" onclick="switchAdminTab('content')">
                <i class="fas fa-photo-video"></i>Content Control
            </button>
            <button class="admin-tab" onclick="switchAdminTab('posts')">
                <i class="fas fa-bullhorn"></i>Broadcast Posts
            </button>
            <button class="admin-tab" onclick="switchAdminTab('settings')">
                <i class="fas fa-cogs"></i>Website Settings
            </button>
        </div>

        <!-- Models Tab -->
        <div class="admin-content active" id="modelsTab">
            <!-- Previous models tab content remains the same -->
            <!-- ... -->
        </div>

        <!-- Stories Tab -->
        <div class="admin-content" id="storiesTab">
            <h3><i class="fas fa-history"></i> Story Management</h3>
            <div class="admin-story-form">
                <form id="storyForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label>Select Model</label>
                            <select id="storyModel" required>
                                <option value="">Choose a model</option>
                                <!-- Models will be populated here -->
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Story Type</label>
                            <select id="storyType" required>
                                <option value="image">Image</option>
                                <option value="video">Video</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Media URL</label>
                        <input type="text" id="storyMedia" required placeholder="https://example.com/image.jpg">
                    </div>
                    <div class="form-group">
                        <label>Duration (seconds)</label>
                        <input type="number" id="storyDuration" value="10" min="5" max="30">
                    </div>
                    <div class="form-group">
                        <label>View Model Link (Optional)</label>
                        <input type="text" id="storyModelLink" placeholder="https://example.com/model-profile">
                    </div>
                    <div class="form-group">
                        <label>Tip Link (Optional)</label>
                        <input type="text" id="storyTipLink" placeholder="https://example.com/tip-model">
                    </div>
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Add Story
                    </button>
                </form>
            </div>
            <h4>Active Stories</h4>
            <div class="stories-list" id="storiesList">
                <!-- Stories will be listed here -->
            </div>
        </div>

        <!-- Model Profiles Tab -->
        <div class="admin-content" id="modelProfilesTab">
            <h3><i class="fas fa-id-card"></i> Model Profiles Management</h3>
            <div class="form-row">
                <div class="form-group">
                    <label>Select Model</label>
                    <select id="profileModelSelect" onchange="loadModelProfile()">
                        <option value="">Choose a model</option>
                        <!-- Models will be populated here -->
                    </select>
                </div>
            </div>
            <form id="modelProfileForm" style="display: none;">
                <div class="form-row">
                    <div class="form-group">
                        <label>Model Name</label>
                        <input type="text" id="profileModelName" required>
                    </div>
                    <div class="form-group">
                        <label>Verified</label>
                        <select id="profileVerified">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>Profile Image URL</label>
                    <input type="text" id="profileImage" required>
                </div>
                <div class="form-group">
                    <label>Bio</label>
                    <textarea id="profileBioText" rows="3" placeholder="Enter model bio..."></textarea>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Followers Count</label>
                        <input type="number" id="profileFollowersCount" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label>Likes Count</label>
                        <input type="number" id="profileLikesCount" value="0" min="0">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Update Profile
                </button>
            </form>

            <h4 style="margin-top: 2rem;">Model Posts</h4>
            <form id="modelPostForm">
                <div class="form-group">
                    <label>Post Type</label>
                    <select id="postType">
                        <option value="image">Image</option>
                        <option value="video">Video</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Media URL</label>
                    <input type="text" id="postMedia" required placeholder="https://example.com/image.jpg">
                </div>
                <div class="form-group">
                    <label>Caption</label>
                    <textarea id="postCaption" rows="3" placeholder="Enter post caption..."></textarea>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="postLocked"> Lock this post (requires credits to unlock)
                    </label>
                </div>
                <div class="form-group" id="postPriceGroup" style="display: none;">
                    <label>Unlock Price (credits)</label>
                    <input type="number" id="postPrice" value="10" min="1">
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Add Post
                </button>
            </form>

            <div class="profile-posts" id="adminProfilePosts" style="margin-top: 2rem;">
                <!-- Model posts will be listed here -->
            </div>
        </div>

        <!-- Reels Tab -->
        <div class="admin-content" id="reelsTab">
            <h3><i class="fas fa-play-circle"></i> Video Reels Management</h3>
            <form id="reelForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>Select Model</label>
                        <select id="reelModel" required>
                            <option value="">Choose a model</option>
                            <!-- Models will be populated here -->
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Video URL</label>
                        <input type="text" id="reelVideo" required placeholder="https://example.com/video.mp4">
                    </div>
                </div>
                <div class="form-group">
                    <label>Description</label>
                    <textarea id="reelDescription" rows="3" placeholder="Enter video description..."></textarea>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Add Reel
                </button>
            </form>

            <h4 style="margin-top: 2rem;">Active Reels</h4>
            <div class="card-grid" id="reelsList">
                <!-- Reels will be listed here -->
            </div>
        </div>

        <!-- Wallet Settings Tab -->
        <div class="admin-content" id="walletSettingsTab">
            <h3><i class="fas fa-wallet"></i> Wallet Settings</h3>
            <div class="form-group">
                <label>Credit to USD Conversion Rate</label>
                <input type="number" id="creditRate" value="1" min="0.01" step="0.01">
                <small>1 credit = $<span id="creditValue">1.00</span></small>
            </div>
            <div class="form-group">
                <label>Minimum Tip Amount (credits)</label>
                <input type="number" id="minTip" value="5" min="1">
            </div>
            <div class="form-group">
                <label>Card Payment Link</label>
                <input type="text" id="cardPaymentLink" placeholder="https://payment.example.com/card">
            </div>
            <div class="form-group">
                <label>Crypto Payment Link</label>
                <input type="text" id="cryptoPaymentLink" placeholder="https://payment.example.com/crypto">
            </div>
            <div class="form-group">
                <label>PayPal Payment Link</label>
                <input type="text" id="paypalPaymentLink" placeholder="https://payment.example.com/paypal">
            </div>
            <button class="btn btn-primary" onclick="updateWalletSettings()">
                <i class="fas fa-save"></i> Update Wallet Settings
            </button>
        </div>

        <!-- Other admin tabs remain the same -->
        <!-- ... -->
    </section>

    <!-- All previous modals remain the same -->
    <!-- ... -->

    <!-- Add Funds Modal -->
    <div class="modal" id="addFundsModal">
        <div class="modal-content">
            <h2>Add Funds to Wallet</h2>
            <div class="form-group">
                <label>Amount (USD)</label>
                <input type="number" id="fundAmount" min="10" step="5" value="20">
            </div>
            <div class="form-group">
                <label>Payment Method</label>
                <select id="fundPaymentMethod">
                    <option value="card">Credit/Debit Card</option>
                    <option value="crypto">Cryptocurrency</option>
                    <option value="paypal">PayPal</option>
                </select>
            </div>
            <div class="modal-buttons">
                <button class="btn btn-outline" onclick="closeModal('addFundsModal')">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="btn btn-primary" onclick="processPayment()">
                    <i class="fas fa-dollar-sign"></i> Proceed to Payment
                </button>
            </div>
        </div>
    </div>

    <!-- Unlock Post Modal -->
    <div class="modal" id="unlockPostModal">
        <div class="modal-content">
            <h2>Unlock Content</h2>
            <p>This content is locked. You need <span id="unlockPrice">10</span> credits to unlock it.</p>
            <p>Your balance: <span id="userBalance">0</span> credits</p>
            <div class="modal-buttons">
                <button class="btn btn-outline" onclick="closeModal('unlockPostModal')">
                    <i class="fas fa-times"></i> Cancel
                </button>
                <button class="btn btn-primary" onclick="unlockPost()">
                    <i class="fas fa-unlock"></i> Unlock
                </button>
                <button class="btn btn-warning" onclick="openAddFundsModal()">
                    <i class="fas fa-plus"></i> Add Funds
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js"></script>
    <script src="config.js"></script>
    <script>
        // Firebase Initialization
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Toastr configuration
        toastr.options = {
            closeButton: true,
            progressBar: true,
            positionClass: "toast-top-right",
            timeOut: 5000
        };

        // Firebase References
        const modelsRef = db.collection('models');
        const usersRef = db.collection('users');
        const settingsRef = db.collection('settings').doc('website');
        const postsRef = db.collection('posts');
        const bookingsRef = db.collection('bookings');
        const commentsRef = db.collection('comments');
        const storiesRef = db.collection('stories');
        const modelProfilesRef = db.collection('modelProfiles');
        const reelsRef = db.collection('reels');
        const walletRef = db.collection('wallet');

        // State Management
        let currentUser = null;
        let adminUser = null;
        let websiteSettings = {};
        let allModels = [];
        let hardcodedFrontpageModels = [];
        let currentEditingModel = null;
        let currentEditingHardcodedModel = null;
        let currentCommentModelId = null;
        let currentModelId = null;
        let currentStories = [];
        let currentModelProfiles = {};
        let currentReels = [];
        let currentWalletSettings = {};
        let userWallet = { balance: 0, transactions: [] };
        let currentProfileModelId = null;
        let currentUnlockPostId = null;

        // Initialize Hardcoded Models (stored in JavaScript array)
        function initializeHardcodedModels() {
            // Check if we have hardcoded models in localStorage
            const storedModels = localStorage.getItem('hardcodedFrontpageModels');
            
            if (storedModels) {
                hardcodedFrontpageModels = JSON.parse(storedModels);
            } else {
                // Initial hard-coded model with your image
                hardcodedFrontpageModels = [
                    {
                        id: '1',
                        name: 'Premium Model',
                        image: 'https://i.postimg.cc/cHB5zQYM/1758636933933.jpg',
                        verified: true,
                        likes: 1250,
                        comments: [
                            "Stunning beauty! üòç",
                            "Can't wait for your next show!",
                            "Absolutely incredible üî•"
                        ],
                        publicPosts: [
                            "https://i.postimg.cc/cHB5zQYM/1758636933933.jpg|My exclusive content for you!",
                            "https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80|Behind the scenes üòâ"
                        ],
                        commentsCount: 3,
                        videoCallLink: "https://zoom.us/j/123456789",
                        embedVideo: "",
                        createdAt: new Date().toISOString()
                    }
                ];
                saveHardcodedModels();
            }
            
            // Display models based on login status
            updateModelsDisplay();
        }

        // Save hard-coded models to localStorage
        function saveHardcodedModels() {
            localStorage.setItem('hardcodedFrontpageModels', JSON.stringify(hardcodedFrontpageModels));
        }

        // NEW FUNCTIONS FOR ADDED FEATURES

        // Initialize all new features
        function initializeNewFeatures() {
            loadStories();
            loadModelProfiles();
            loadReels();
            loadWalletSettings();
            setupSwipeNavigation();
            setupContentProtection();
            
            if (currentUser || adminUser) {
                loadUserWallet();
                updateUIForLoggedInUser();
            }
        }

        // Update UI when user logs in
        function updateUIForLoggedInUser() {
            // Change hero title
            document.getElementById('heroTitle').textContent = 'Camsilo';
            
            // Hide hero description and explore button
            document.getElementById('heroDescription').style.display = 'none';
            document.getElementById('exploreButton').style.display = 'none';
            
            // Show stories
            document.getElementById('storiesContainer').classList.add('active');
            
            // Add menu button to header
            const authButtons = document.getElementById('authButtons');
            if (!document.getElementById('menuButton')) {
                const menuButton = document.createElement('button');
                menuButton.className = 'btn btn-outline';
                menuButton.id = 'menuButton';
                menuButton.innerHTML = '<i class="fas fa-bars"></i>';
                menuButton.onclick = toggleSidebar;
                authButtons.insertBefore(menuButton, authButtons.firstChild);
            }
            
            // Update sidebar user info
            updateSidebarUserInfo();
        }

        // Toggle sidebar menu
        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebarOverlay');
            
            sidebar.classList.toggle('active');
            overlay.classList.toggle('active');
        }

        // Update sidebar user information
        function updateSidebarUserInfo() {
            if (currentUser || adminUser) {
                const user = currentUser || adminUser;
                document.getElementById('sidebarUserName').textContent = user.email || 'User';
                document.getElementById('sidebarBalance').textContent = userWallet.balance.toFixed(2);
                
                if (user.avatar) {
                    document.getElementById('sidebarAvatar').src = user.avatar;
                }
            }
        }

        // Switch between pages
        function switchPage(pageName) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            
            // Show selected page
            document.getElementById(pageName + 'Page').classList.remove('hidden');
            
            // Update sidebar active item
            document.querySelectorAll('.sidebar-item').forEach(item => {
                item.classList.remove('active');
            });
            document.querySelector(`.sidebar-item[onclick="switchPage('${pageName}')"]`).classList.add('active');
            
            // Close sidebar
            toggleSidebar();
            
            // Load specific content for pages
            if (pageName === 'reels') {
                loadReelsForDisplay();
            } else if (pageName === 'wallet') {
                updateWalletDisplay();
            }
        }

        // Setup swipe navigation
        function setupSwipeNavigation() {
            let startX = 0;
            let currentX = 0;
            const pageContainer = document.getElementById('pageContainer');
            const pages = document.querySelectorAll('.page');
            let currentPageIndex = 0;
            
            // Show swipe indicator initially
            document.getElementById('swipeIndicator').style.display = 'block';
            setTimeout(() => {
                document.getElementById('swipeIndicator').style.display = 'none';
            }, 5000);
            
            pageContainer.addEventListener('touchstart', (e) => {
                startX = e.touches[0].clientX;
            });
            
            pageContainer.addEventListener('touchmove', (e) => {
                currentX = e.touches[0].clientX;
            });
            
            pageContainer.addEventListener('touchend', () => {
                const diff = startX - currentX;
                const threshold = 50;
                
                if (Math.abs(diff) > threshold) {
                    if (diff > 0) {
                        // Swipe left - next page
                        navigateToPage(currentPageIndex + 1);
                    } else {
                        // Swipe right - previous page
                        navigateToPage(currentPageIndex - 1);
                    }
                }
            });
            
            // Define page order
            const pageOrder = ['home', 'models', 'reels', 'wallet'];
            
            function navigateToPage(index) {
                if (index < 0 || index >= pageOrder.length) return;
                
                currentPageIndex = index;
                switchPage(pageOrder[index]);
                
                // Show swipe indicator briefly
                document.getElementById('swipeIndicator').style.display = 'block';
                setTimeout(() => {
                    document.getElementById('swipeIndicator').style.display = 'none';
                }, 2000);
            }
        }

        // Load and display stories
        async function loadStories() {
            try {
                const snapshot = await storiesRef.where('active', '==', true).get();
                currentStories = [];
                
                snapshot.forEach(doc => {
                    currentStories.push({ id: doc.id, ...doc.data() });
                });
                
                displayStories();
            } catch (error) {
                console.error('Error loading stories:', error);
            }
        }

        // Display stories in the stories container
        function displayStories() {
            const container = document.getElementById('storiesContainer');
            container.innerHTML = '';
            
            currentStories.forEach(story => {
                const storyItem = document.createElement('div');
                storyItem.className = 'story-item';
                storyItem.onclick = () => openStory(story.id);
                
                storyItem.innerHTML = `
                    <div class="story-avatar-container">
                        <img src="${story.modelAvatar || 'https://i.postimg.cc/cHB5zQYM/1758636933933.jpg'}" alt="${story.modelName}" class="story-avatar">
                        <div class="story-live">LIVE</div>
                    </div>
                    <div class="story-name">${story.modelName}</div>
                `;
                
                container.appendChild(storyItem);
            });
        }

        // Open a story in expanded view
        function openStory(storyId) {
            const story = currentStories.find(s => s.id === storyId);
            if (!story) return;
            
            const content = document.getElementById('storyContent');
            content.innerHTML = '';
            
            if (story.type === 'image') {
                const img = document.createElement('img');
                img.src = story.media;
                img.className = 'no-download';
                content.appendChild(img);
            } else if (story.type === 'video') {
                const video = document.createElement('video');
                video.src = story.media;
                video.controls = true;
                video.autoplay = true;
                video.className = 'no-download';
                content.appendChild(video);
            }
            
            // Store current story data for actions
            window.currentStory = story;
            
            document.getElementById('storyExpanded').classList.add('active');
        }

        // Close story view
        function closeStory() {
            document.getElementById('storyExpanded').classList.remove('active');
        }

        // View model from story
        function viewModelFromStory() {
            if (window.currentStory && window.currentStory.modelLink) {
                window.open(window.currentStory.modelLink, '_blank');
            } else {
                toastr.info('Model profile link not available');
            }
        }

        // Send tip from story
        function sendTipFromStory() {
            if (window.currentStory && window.currentStory.tipLink) {
                window.open(window.currentStory.tipLink, '_blank');
            } else {
                openTipModal();
            }
        }

        // Open tip modal
        function openTipModal() {
            // Implementation for tip modal
            toastr.info('Tip functionality would open here');
        }

        // Load model profiles
        async function loadModelProfiles() {
            try {
                const snapshot = await modelProfilesRef.get();
                currentModelProfiles = {};
                
                snapshot.forEach(doc => {
                    currentModelProfiles[doc.id] = { id: doc.id, ...doc.data() };
                });
                
                // Update admin dropdowns
                updateAdminModelDropdowns();
            } catch (error) {
                console.error('Error loading model profiles:', error);
            }
        }

        // Update admin model dropdowns
        function updateAdminModelDropdowns() {
            const dropdowns = [
                'storyModel',
                'profileModelSelect',
                'reelModel'
            ];
            
            dropdowns.forEach(dropdownId => {
                const dropdown = document.getElementById(dropdownId);
                if (dropdown) {
                    // Clear existing options except the first one
                    while (dropdown.options.length > 1) {
                        dropdown.remove(1);
                    }
                    
                    // Add model options
                    Object.values(currentModelProfiles).forEach(profile => {
                        const option = document.createElement('option');
                        option.value = profile.id;
                        option.textContent = profile.name;
                        dropdown.appendChild(option);
                    });
                }
            });
        }

        // Load model profile for editing
        async function loadModelProfile() {
            const modelId = document.getElementById('profileModelSelect').value;
            if (!modelId) {
                document.getElementById('modelProfileForm').style.display = 'none';
                return;
            }
            
            const profile = currentModelProfiles[modelId];
            if (!profile) return;
            
            currentProfileModelId = modelId;
            
            document.getElementById('profileModelName').value = profile.name || '';
            document.getElementById('profileVerified').value = profile.verified ? 'true' : 'false';
            document.getElementById('profileImage').value = profile.image || '';
            document.getElementById('profileBioText').value = profile.bio || '';
            document.getElementById('profileFollowersCount').value = profile.followers || 0;
            document.getElementById('profileLikesCount').value = profile.likes || 0;
            
            document.getElementById('modelProfileForm').style.display = 'block';
            
            // Load model posts
            loadModelPostsForAdmin(modelId);
        }

        // Load model posts for admin
        async function loadModelPostsForAdmin(modelId) {
            const container = document.getElementById('adminProfilePosts');
            container.innerHTML = '<p>Loading posts...</p>';
            
            try {
                const postsSnapshot = await modelProfilesRef.doc(modelId).collection('posts').get();
                const posts = [];
                
                postsSnapshot.forEach(doc => {
                    posts.push({ id: doc.id, ...doc.data() });
                });
                
                container.innerHTML = '';
                
                if (posts.length === 0) {
                    container.innerHTML = '<p>No posts yet.</p>';
                    return;
                }
                
                posts.forEach(post => {
                    const postElement = document.createElement('div');
                    postElement.className = 'post-card';
                    
                    postElement.innerHTML = `
                        <div class="post-media">
                            ${post.type === 'image' ? 
                                `<img src="${post.media}" alt="Post">` : 
                                `<video src="${post.media}" controls></video>`
                            }
                        </div>
                        <div class="post-content">
                            <p class="post-caption">${post.caption || ''}</p>
                            <div class="post-meta">
                                <span>${post.locked ? '<i class="fas fa-lock"></i> Locked' : '<i class="fas fa-unlock"></i> Public'}</span>
                                <span>${post.likes || 0} likes</span>
                            </div>
                            <div class="post-actions" style="margin-top: 1rem;">
                                <button class="btn btn-sm btn-danger" onclick="deleteModelPost('${modelId}', '${post.id}')">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                                ${post.locked ? 
                                    `<button class="btn btn-sm btn-warning" onclick="togglePostLock('${modelId}', '${post.id}', false)">
                                        <i class="fas fa-unlock"></i> Unlock
                                    </button>` :
                                    `<button class="btn btn-sm btn-warning" onclick="togglePostLock('${modelId}', '${post.id}', true)">
                                        <i class="fas fa-lock"></i> Lock
                                    </button>`
                                }
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(postElement);
                });
            } catch (error) {
                console.error('Error loading model posts:', error);
                container.innerHTML = '<p>Error loading posts.</p>';
            }
        }

        // Load reels
        async function loadReels() {
            try {
                const snapshot = await reelsRef.where('active', '==', true).get();
                currentReels = [];
                
                snapshot.forEach(doc => {
                    currentReels.push({ id: doc.id, ...doc.data() });
                });
            } catch (error) {
                console.error('Error loading reels:', error);
            }
        }

        // Load reels for display
        function loadReelsForDisplay() {
            const container = document.getElementById('reelContainer');
            container.innerHTML = '';
            
            if (currentReels.length === 0) {
                container.innerHTML = '<p>No reels available.</p>';
                return;
            }
            
            // For simplicity, we'll just show the first reel
            const reel = currentReels[0];
            
            const video = document.createElement('video');
            video.src = reel.video;
            video.className = 'reel-video';
            video.controls = true;
            video.autoplay = true;
            video.loop = true;
            
            const overlay = document.createElement('div');
            overlay.className = 'reel-overlay';
            
            overlay.innerHTML = `
                <div class="reel-model-info">
                    <img src="${reel.modelAvatar || 'https://i.postimg.cc/cHB5zQYM/1758636933933.jpg'}" alt="${reel.modelName}" class="reel-model-avatar">
                    <div class="reel-model-name">${reel.modelName}</div>
                </div>
                <p>${reel.description || ''}</p>
                <div class="reel-actions">
                    <button class="reel-action-btn" onclick="likeReel('${reel.id}')">
                        <i class="fas fa-heart"></i>
                    </button>
                    <button class="reel-action-btn" onclick="tipReel('${reel.id}')">
                        <i class="fas fa-gift"></i>
                    </button>
                    <button class="reel-action-btn" onclick="viewReelModel('${reel.modelId}')">
                        <i class="fas fa-user"></i>
                    </button>
                </div>
            `;
            
            container.appendChild(video);
            container.appendChild(overlay);
        }

        // Like a reel
        function likeReel(reelId) {
            toastr.success('Liked the reel!');
        }

        // Tip a reel
        function tipReel(reelId) {
            openTipModal();
        }

        // View reel model profile
        function viewReelModel(modelId) {
            openModelProfile(modelId);
        }

        // Open model profile
        function openModelProfile(modelId) {
            const profile = currentModelProfiles[modelId];
            if (!profile) {
                toastr.error('Model profile not found');
                return;
            }
            
            document.getElementById('profileName').textContent = profile.name;
            document.getElementById('profileVerified').style.display = profile.verified ? 'inline' : 'none';
            document.getElementById('profileAvatar').src = profile.image;
            document.getElementById('profileBio').textContent = profile.bio || 'No bio available';
            document.getElementById('profileFollowers').textContent = profile.followers || 0;
            document.getElementById('profilePosts').textContent = profile.postCount || 0;
            document.getElementById('profileLikes').textContent = profile.likes || 0;
            
            // Check if user is following
            const isFollowing = profile.followers && profile.followers.includes(currentUser?.uid);
            document.getElementById('followButton').innerHTML = isFollowing ? 
                '<i class="fas fa-check"></i> Following' : 
                '<i class="fas fa-plus"></i> Follow';
            
            // Load model posts
            loadModelPosts(modelId);
            
            // Show profile and hide other pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.add('hidden');
            });
            document.getElementById('modelProfile').classList.add('active');
        }

        // Load model posts for profile display
        async function loadModelPosts(modelId) {
            const container = document.getElementById('profilePosts');
            container.innerHTML = '<p>Loading posts...</p>';
            
            try {
                const postsSnapshot = await modelProfilesRef.doc(modelId).collection('posts').get();
                const posts = [];
                
                postsSnapshot.forEach(doc => {
                    posts.push({ id: doc.id, ...doc.data() });
                });
                
                container.innerHTML = '';
                
                if (posts.length === 0) {
                    container.innerHTML = '<p>No posts yet.</p>';
                    return;
                }
                
                posts.forEach(post => {
                    const postElement = document.createElement('div');
                    postElement.className = 'post-card';
                    
                    const mediaHtml = post.type === 'image' ? 
                        `<img src="${post.media}" alt="Post" class="${post.locked ? 'post-locked' : ''} no-download">` : 
                        `<video src="${post.media}" controls class="${post.locked ? 'post-locked' : ''} no-download"></video>`;
                    
                    postElement.innerHTML = `
                        <div class="post-media">
                            ${mediaHtml}
                            ${post.locked ? `
                                <div class="lock-overlay">
                                    <i class="fas fa-lock lock-icon"></i>
                                    <p>This content is locked</p>
                                    <button class="btn btn-primary" onclick="attemptUnlockPost('${modelId}', '${post.id}', ${post.price || 10})">
                                        Unlock for ${post.price || 10} credits
                                    </button>
                                </div>
                            ` : ''}
                        </div>
                        <div class="post-content">
                            <p class="post-caption">${post.caption || ''}</p>
                            <div class="post-meta">
                                <span>${post.date ? new Date(post.date).toLocaleDateString() : 'Recently'}</span>
                                <span>${post.likes || 0} likes</span>
                            </div>
                        </div>
                    `;
                    
                    container.appendChild(postElement);
                });
            } catch (error) {
                console.error('Error loading model posts:', error);
                container.innerHTML = '<p>Error loading posts.</p>';
            }
        }

        // Attempt to unlock a post
        function attemptUnlockPost(modelId, postId, price) {
            if (!currentUser && !adminUser) {
                openModal('subscriptionModal');
                return;
            }
            
            if (userWallet.balance < price) {
                currentUnlockPostId = { modelId, postId };
                document.getElementById('unlockPrice').textContent = price;
                document.getElementById('userBalance').textContent = userWallet.balance;
                openModal('unlockPostModal');
                return;
            }
            
            unlockPost(modelId, postId, price);
        }

        // Unlock a post
        async function unlockPost(modelId, postId, price) {
            try {
                // Deduct from wallet
                userWallet.balance -= price;
                userWallet.transactions.push({
                    type: 'purchase',
                    amount: -price,
                    description: `Unlocked post from ${currentModelProfiles[modelId]?.name || 'model'}`,
                    date: new Date()
                });
                
                // Save wallet
                await walletRef.doc(currentUser.uid).set(userWallet);
                
                // Mark post as unlocked for user
                await modelProfilesRef.doc(modelId).collection('posts').doc(postId).update({
                    [`unlockedBy.${currentUser.uid}`]: true
                });
                
                toastr.success('Post unlocked successfully!');
                closeModal('unlockPostModal');
                
                // Reload posts to show unlocked content
                loadModelPosts(modelId);
                
                // Update wallet display
                updateWalletDisplay();
                updateSidebarUserInfo();
            } catch (error) {
                console.error('Error unlocking post:', error);
                toastr.error('Failed to unlock post');
            }
        }

        // Load wallet settings
        async function loadWalletSettings() {
            try {
                const doc = await db.collection('settings').doc('wallet').get();
                if (doc.exists) {
                    currentWalletSettings = doc.data();
                    updateWalletSettingsDisplay();
                } else {
                    // Initialize default wallet settings
                    currentWalletSettings = {
                        creditRate: 1,
                        minTip: 5,
                        cardPaymentLink: 'https://payment.example.com/card',
                        cryptoPaymentLink: 'https://payment.example.com/crypto',
                        paypalPaymentLink: 'https://payment.example.com/paypal'
                    };
                    await db.collection('settings').doc('wallet').set(currentWalletSettings);
                }
            } catch (error) {
                console.error('Error loading wallet settings:', error);
            }
        }

        // Update wallet settings display in admin panel
        function updateWalletSettingsDisplay() {
            document.getElementById('creditRate').value = currentWalletSettings.creditRate || 1;
            document.getElementById('creditValue').textContent = (currentWalletSettings.creditRate || 1).toFixed(2);
            document.getElementById('minTip').value = currentWalletSettings.minTip || 5;
            document.getElementById('cardPaymentLink').value = currentWalletSettings.cardPaymentLink || '';
            document.getElementById('cryptoPaymentLink').value = currentWalletSettings.cryptoPaymentLink || '';
            document.getElementById('paypalPaymentLink').value = currentWalletSettings.paypalPaymentLink || '';
        }

        // Load user wallet
        async function loadUserWallet() {
            if (!currentUser && !adminUser) return;
            
            try {
                const doc = await walletRef.doc(currentUser?.uid || adminUser?.uid).get();
                if (doc.exists) {
                    userWallet = doc.data();
                } else {
                    // Initialize wallet
                    userWallet = {
                        balance: 0,
                        transactions: []
                    };
                    await walletRef.doc(currentUser?.uid || adminUser?.uid).set(userWallet);
                }
                
                updateWalletDisplay();
                updateSidebarUserInfo();
            } catch (error) {
                console.error('Error loading user wallet:', error);
            }
        }

        // Update wallet display
        function updateWalletDisplay() {
            document.getElementById('walletBalance').textContent = userWallet.balance.toFixed(2);
        }

        // Open add funds modal
        function openAddFundsModal() {
            openModal('addFundsModal');
        }

        // Process payment
        function processPayment() {
            const amount = parseFloat(document.getElementById('fundAmount').value);
            const method = document.getElementById('fundPaymentMethod').value;
            
            if (amount < 10) {
                toastr.error('Minimum amount is $10');
                return;
            }
            
            // Redirect to payment page based on method
            let paymentUrl = '';
            switch (method) {
                case 'card':
                    paymentUrl = currentWalletSettings.cardPaymentLink;
                    break;
                case 'crypto':
                    paymentUrl = currentWalletSettings.cryptoPaymentLink;
                    break;
                case 'paypal':
                    paymentUrl = currentWalletSettings.paypalPaymentLink;
                    break;
            }
            
            if (paymentUrl) {
                // In a real implementation, you would pass the amount and user ID as parameters
                window.open(paymentUrl, '_blank');
                toastr.info('Redirecting to payment page...');
            } else {
                toastr.error('Payment method not configured');
            }
            
            closeModal('addFundsModal');
        }

        // Setup content protection
        function setupContentProtection() {
            // Prevent right-click
            document.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                toastr.warning('Content protection is active');
            });
            
            // Prevent drag and drop
            document.addEventListener('dragstart', (e) => {
                if (e.target.tagName === 'IMG' || e.target.tagName === 'VIDEO') {
                    e.preventDefault();
                }
            });
            
            // Prevent text selection
            document.styleSheets[0].insertRule(`
                .no-download {
                    -webkit-touch-callout: none;
                    -webkit-user-select: none;
                    -khtml-user-select: none;
                    -moz-user-select: none;
                    -ms-user-select: none;
                    user-select: none;
                    pointer-events: none;
                }
            `, 0);
        }

        // Follow a model
        async function followModel() {
            if (!currentUser && !adminUser) {
                openModal('subscriptionModal');
                return;
            }
            
            const modelId = currentProfileModelId;
            if (!modelId) return;
            
            try {
                const profile = currentModelProfiles[modelId];
                const isFollowing = profile.followers && profile.followers.includes(currentUser?.uid);
                
                if (isFollowing) {
                    // Unfollow
                    await modelProfilesRef.doc(modelId).update({
                        followers: firebase.firestore.FieldValue.arrayRemove(currentUser?.uid),
                        followerCount: firebase.firestore.FieldValue.increment(-1)
                    });
                    
                    toastr.success('Unfollowed model');
                    document.getElementById('followButton').innerHTML = '<i class="fas fa-plus"></i> Follow';
                } else {
                    // Follow
                    await modelProfilesRef.doc(modelId).update({
                        followers: firebase.firestore.FieldValue.arrayUnion(currentUser?.uid),
                        followerCount: firebase.firestore.FieldValue.increment(1)
                    });
                    
                    toastr.success('Following model');
                    document.getElementById('followButton').innerHTML = '<i class="fas fa-check"></i> Following';
                }
                
                // Reload profile
                loadModelProfiles();
                openModelProfile(modelId);
            } catch (error) {
                console.error('Error following model:', error);
                toastr.error('Failed to follow model');
            }
        }

        // Update wallet settings from admin panel
        async function updateWalletSettings() {
            try {
                const newSettings = {
                    creditRate: parseFloat(document.getElementById('creditRate').value),
                    minTip: parseInt(document.getElementById('minTip').value),
                    cardPaymentLink: document.getElementById('cardPaymentLink').value,
                    cryptoPaymentLink: document.getElementById('cryptoPaymentLink').value,
                    paypalPaymentLink: document.getElementById('paypalPaymentLink').value
                };
                
                await db.collection('settings').doc('wallet').set(newSettings);
                currentWalletSettings = newSettings;
                
                toastr.success('Wallet settings updated');
            } catch (error) {
                console.error('Error updating wallet settings:', error);
                toastr.error('Failed to update wallet settings');
            }
        }

        // Initialize Website
        document.addEventListener('DOMContentLoaded', function() {
            initializeWebsite();
            setupScrollEffects();
            initializeHardcodedModels();
            initializeNewFeatures();
        });

        // Modify the existing checkAuthState function to call new features
        function checkAuthState() {
            auth.onAuthStateChanged(async (user) => {
                if (user) {
                    const userDoc = await usersRef.doc(user.uid).get();
                    if (userDoc.exists) {
                        const userData = userDoc.data();
                        if (userData.role === 'admin') {
                            adminUser = { uid: user.uid, ...userData };
                            showAdminPanel();
                            updateModelsDisplay();
                            initializeNewFeatures();
                            toastr.success('Welcome back, Admin!');
                        } else {
                            currentUser = { uid: user.uid, ...userData };
                            showUserInterface();
                            checkAccountExpiry();
                            updateModelsDisplay();
                            initializeNewFeatures();
                            toastr.success('Welcome back!');
                        }
                    } else {
                        await auth.signOut();
                    }
                    updateAuthButtons();
                    await loadModels();
                } else {
                    currentUser = null;
                    adminUser = null;
                    updateAuthButtons();
                    hideAdminPanel();
                    hideUserInterface();
                    updateModelsDisplay();
                    await loadModels();
                }
            });
        }

        // Add story form submission
        document.getElementById('storyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const modelId = document.getElementById('storyModel').value;
            const model = currentModelProfiles[modelId];
            if (!model) {
                toastr.error('Please select a valid model');
                return;
            }
            
            const storyData = {
                modelId: modelId,
                modelName: model.name,
                modelAvatar: model.image,
                type: document.getElementById('storyType').value,
                media: document.getElementById('storyMedia').value,
                duration: parseInt(document.getElementById('storyDuration').value),
                modelLink: document.getElementById('storyModelLink').value || '',
                tipLink: document.getElementById('storyTipLink').value || '',
                active: true,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                await storiesRef.add(storyData);
                toastr.success('Story added successfully!');
                document.getElementById('storyForm').reset();
                await loadStories();
            } catch (error) {
                console.error('Error adding story:', error);
                toastr.error('Failed to add story');
            }
        });

        // Add model profile form submission
        document.getElementById('modelProfileForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!currentProfileModelId) return;
            
            const profileData = {
                name: document.getElementById('profileModelName').value,
                verified: document.getElementById('profileVerified').value === 'true',
                image: document.getElementById('profileImage').value,
                bio: document.getElementById('profileBioText').value,
                followers: parseInt(document.getElementById('profileFollowersCount').value),
                likes: parseInt(document.getElementById('profileLikesCount').value),
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                await modelProfilesRef.doc(currentProfileModelId).set(profileData, { merge: true });
                toastr.success('Profile updated successfully!');
                await loadModelProfiles();
            } catch (error) {
                console.error('Error updating profile:', error);
                toastr.error('Failed to update profile');
            }
        });

        // Add model post form submission
        document.getElementById('modelPostForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            if (!currentProfileModelId) {
                toastr.error('Please select a model first');
                return;
            }
            
            const postData = {
                type: document.getElementById('postType').value,
                media: document.getElementById('postMedia').value,
                caption: document.getElementById('postCaption').value,
                locked: document.getElementById('postLocked').checked,
                price: document.getElementById('postLocked').checked ? parseInt(document.getElementById('postPrice').value) : 0,
                likes: 0,
                date: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                await modelProfilesRef.doc(currentProfileModelId).collection('posts').add(postData);
                toastr.success('Post added successfully!');
                document.getElementById('modelPostForm').reset();
                document.getElementById('postPriceGroup').style.display = 'none';
                await loadModelPostsForAdmin(currentProfileModelId);
            } catch (error) {
                console.error('Error adding post:', error);
                toastr.error('Failed to add post');
            }
        });

        // Toggle post price field based on lock status
        document.getElementById('postLocked').addEventListener('change', function() {
            document.getElementById('postPriceGroup').style.display = this.checked ? 'block' : 'none';
        });

        // Add reel form submission
        document.getElementById('reelForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const modelId = document.getElementById('reelModel').value;
            const model = currentModelProfiles[modelId];
            if (!model) {
                toastr.error('Please select a valid model');
                return;
            }
            
            const reelData = {
                modelId: modelId,
                modelName: model.name,
                modelAvatar: model.image,
                video: document.getElementById('reelVideo').value,
                description: document.getElementById('reelDescription').value,
                active: true,
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            };
            
            try {
                await reelsRef.add(reelData);
                toastr.success('Reel added successfully!');
                document.getElementById('reelForm').reset();
                await loadReels();
            } catch (error) {
                console.error('Error adding reel:', error);
                toastr.error('Failed to add reel');
            }
        });

        // The rest of the existing functions remain the same
        // ...
    </script>
</body>
</html>
