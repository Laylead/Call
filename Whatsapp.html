<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Camsilo - Premium Adult Entertainment</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #e91e63;
            --secondary: #9c27b0;
            --dark: #121212;
            --darker: #0a0a0a;
            --light: #f5f5f5;
            --gray: #6c757d;
            --success: #4caf50;
            --warning: #ff9800;
            --danger: #f44336;
            --surface: #1e1e1e;
            --surface-light: #2d2d2d;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: var(--dark);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
            touch-action: pan-y pinch-zoom;
        }

        /* Enhanced Header Styles */
        header {
            background: rgba(18, 18, 18, 0.98);
            backdrop-filter: blur(15px);
            padding: 1rem 2rem;
            position: fixed;
            width: 100%;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
            transition: all 0.3s ease;
        }

        .header-scrolled {
            padding: 0.7rem 2rem;
            background: rgba(18, 18, 18, 0.98);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.5);
        }

        .nav-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1400px;
            margin: 0 auto;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 700;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 0.5px;
            transition: all 0.3s ease;
        }

        .logo:hover {
            transform: scale(1.05);
            filter: brightness(1.2);
        }

        .nav-links {
            display: flex;
            gap: 1.5rem;
            align-items: center;
        }

        .nav-links a {
            color: var(--light);
            text-decoration: none;
            transition: all 0.3s ease;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            font-size: 0.95rem;
            position: relative;
            overflow: hidden;
        }

        .nav-links a::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            transition: left 0.4s ease;
            z-index: -1;
            border-radius: 8px;
        }

        .nav-links a:hover::before, .nav-links a.active::before {
            left: 0;
        }

        .nav-links a:hover, .nav-links a.active {
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(233, 30, 99, 0.4);
        }

        .auth-buttons {
            display: flex;
            gap: 0.8rem;
        }

        .btn {
            padding: 0.7rem 1.5rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.9rem;
            letter-spacing: 0.5px;
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
            transition: left 0.6s ease;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn-primary {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 6px 20px rgba(233, 30, 99, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 10px 25px rgba(233, 30, 99, 0.5);
        }

        .btn-outline {
            border: 2px solid var(--primary);
            color: var(--primary);
            background: transparent;
        }

        .btn-outline:hover {
            background: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 20px rgba(233, 30, 99, 0.3);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-warning {
            background: var(--warning);
            color: black;
        }

        .btn-sm {
            padding: 0.5rem 1rem;
            font-size: 0.85rem;
        }

        /* Enhanced Hero Section */
        .hero {
            margin-top: 80px;
            padding: 10rem 2rem;
            text-align: center;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            position: relative;
            animation: heroFadeIn 1.2s ease-out;
        }

        @keyframes heroFadeIn {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(18, 18, 18, 0.85), rgba(10, 10, 10, 0.95));
            z-index: 1;
        }

        .hero-content {
            position: relative;
            z-index: 2;
            max-width: 800px;
            margin: 0 auto;
        }

        .hero h1 {
            font-size: 3.8rem;
            margin-bottom: 1.5rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            line-height: 1.2;
            animation: titleGlow 3s ease-in-out infinite alternate;
        }

        @keyframes titleGlow {
            from {
                filter: drop-shadow(0 0 5px rgba(233, 30, 99, 0.5));
            }
            to {
                filter: drop-shadow(0 0 15px rgba(156, 39, 176, 0.7));
            }
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: 2.5rem;
            color: rgba(255, 255, 255, 0.9);
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            animation: fadeInUp 1s ease-out 0.3s both;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* Enhanced Models Grid */
        .models-section {
            padding: 6rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
            animation: fadeIn 1s ease-out;
        }

        .section-title {
            text-align: center;
            margin-bottom: 4rem;
            font-size: 2.4rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            position: relative;
            padding-bottom: 1.5rem;
            animation: fadeInUp 1s ease-out 0.5s both;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 100px;
            height: 4px;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            border-radius: 4px;
            animation: expandWidth 1s ease-out 1s both;
        }

        @keyframes expandWidth {
            from { width: 0; }
            to { width: 100px; }
        }

        .models-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2.5rem;
        }

        .model-card {
            background: var(--surface);
            border-radius: 16px;
            overflow: hidden;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.08);
            position: relative;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.3);
            animation: cardAppear 0.6s ease-out both;
            animation-delay: calc(var(--card-index) * 0.1s);
        }

        @keyframes cardAppear {
            from {
                opacity: 0;
                transform: translateY(30px) scale(0.9);
            }
            to {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }

        .model-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: 0 20px 40px rgba(233, 30, 99, 0.25);
            border-color: rgba(233, 30, 99, 0.4);
        }

        .model-image-container {
            position: relative;
            overflow: hidden;
        }

        .model-image {
            width: 100%;
            height: 380px;
            object-fit: cover;
            transition: all 0.6s ease;
        }

        .model-card:hover .model-image {
            transform: scale(1.1);
            filter: brightness(1.1);
        }

        .model-badge {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            padding: 0.4rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 0.3rem;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 2;
        }

        .model-info {
            padding: 1.8rem;
        }

        .model-name {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1rem;
            font-size: 1.4rem;
            transition: all 0.3s ease;
        }

        .verified {
            color: #1da1f2;
            font-size: 1.2rem;
            animation: pulse 2s infinite;
        }

        .model-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            padding: 1rem 0;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .likes, .comments {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--light);
            font-weight: 500;
        }

        .like-btn, .comment-btn {
            background: none;
            border: none;
            color: var(--light);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            font-size: 1.3rem;
            padding: 0.6rem;
            border-radius: 50%;
            position: relative;
            overflow: hidden;
        }

        .like-btn::before, .comment-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.1);
            transform: scale(0);
            transition: transform 0.3s ease;
        }

        .like-btn:hover::before, .comment-btn:hover::before {
            transform: scale(1);
        }

        .like-btn:hover {
            color: var(--primary);
            transform: scale(1.3) rotate(8deg);
        }

        .comment-btn:hover {
            color: var(--secondary);
            transform: scale(1.3) rotate(-8deg);
        }

        .liked {
            color: var(--primary) !important;
            animation: heartBeat 0.6s ease-in-out;
        }

        @keyframes heartBeat {
            0% { transform: scale(1); }
            25% { transform: scale(1.3); }
            50% { transform: scale(1.1); }
            75% { transform: scale(1.2); }
            100% { transform: scale(1); }
        }

        .book-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            font-size: 1rem;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            text-transform: uppercase;
            letter-spacing: 0.8px;
            position: relative;
            overflow: hidden;
        }

        .book-btn::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            transition: left 0.6s ease;
        }

        .book-btn:hover::after {
            left: 100%;
        }

        .book-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(233, 30, 99, 0.5);
            letter-spacing: 1.2px;
        }

        /* Enhanced Modal Styles - FIXED Z-INDEX */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 9999;
            backdrop-filter: blur(10px);
            animation: modalFadeIn 0.4s ease-out;
            overflow-y: auto;
            padding: 1rem;
        }

        @keyframes modalFadeIn {
            from { 
                opacity: 0; 
                backdrop-filter: blur(0);
            }
            to { 
                opacity: 1; 
                backdrop-filter: blur(10px);
            }
        }

        .modal-content {
            position: relative;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: var(--surface);
            padding: 3rem;
            border-radius: 20px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-width: 500px;
            width: 95%;
            text-align: center;
            animation: modalSlideIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            box-shadow: 0 25px 80px rgba(0, 0, 0, 0.6);
            z-index: 10000;
        }

        @keyframes modalSlideIn {
            from {
                opacity: 0;
                transform: translate(-50%, -50%) scale(0.8) rotateX(-10deg);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%) scale(1) rotateX(0);
            }
        }

        .modal-image {
            width: 160px;
            height: 160px;
            border-radius: 50%;
            object-fit: cover;
            margin-bottom: 2rem;
            border: 4px solid var(--primary);
            box-shadow: 0 10px 30px rgba(233, 30, 99, 0.4);
            animation: imagePulse 3s infinite alternate;
        }

        @keyframes imagePulse {
            from {
                box-shadow: 0 10px 30px rgba(233, 30, 99, 0.4);
            }
            to {
                box-shadow: 0 10px 40px rgba(233, 30, 99, 0.7);
            }
        }

        .modal h2 {
            margin-bottom: 1rem;
            color: var(--primary);
            font-size: 1.8rem;
        }

        .modal p {
            margin-bottom: 2rem;
            line-height: 1.6;
            font-size: 1rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .modal-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        /* Form Elements */
        .form-group {
            margin-bottom: 1.5rem;
            text-align: left;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--light);
            font-weight: 600;
            font-size: 0.9rem;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 0.9rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            background: var(--surface-light);
            color: var(--light);
            font-size: 1rem;
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--primary);
            box-shadow: 0 0 0 2px rgba(233, 30, 99, 0.2);
            transform: translateY(-2px);
        }

        /* Admin Panel */
        .admin-panel {
            display: none;
            padding: 2rem;
            background: var(--surface);
            border-radius: 12px;
            margin: 2rem auto;
            max-width: 1400px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .admin-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .admin-tabs {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            background: var(--surface-light);
            padding: 1rem;
            border-radius: 8px;
        }

        .admin-tab {
            padding: 0.8rem 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border: none;
            color: var(--light);
            cursor: pointer;
            border-radius: 6px;
            transition: all 0.3s ease;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .admin-tab:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-3px);
        }

        .admin-tab.active {
            background: linear-gradient(45deg, var(--primary), var(--secondary));
            color: white;
            box-shadow: 0 4px 12px rgba(233, 30, 99, 0.3);
        }

        .admin-content {
            display: none;
            background: var(--surface-light);
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 2rem;
        }

        .admin-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }

        .card-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-top: 2rem;
        }

        .card {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        /* Comments Section */
        .comments-section {
            margin-top: 1rem;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        .comment {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 0.5rem;
            font-size: 0.85rem;
            transition: all 0.3s ease;
        }

        .comment:hover {
            transform: translateX(5px);
            background: rgba(255, 255, 255, 0.08);
        }

        .comment-form {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        .comment-input {
            flex: 1;
            padding: 0.7rem;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            background: var(--surface-light);
            color: white;
        }

        .comment-submit {
            padding: 0.7rem 1.2rem;
            border-radius: 8px;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
        }

        /* Enhanced Private Content */
        .private-content {
            display: none;
            padding: 6rem 2rem;
            background: linear-gradient(135deg, rgba(233, 30, 99, 0.15), rgba(156, 39, 176, 0.15));
            border-radius: 20px;
            margin: 4rem auto;
            max-width: 1400px;
            border: 1px solid rgba(233, 30, 99, 0.3);
            position: relative;
            overflow: hidden;
        }

        .private-content::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="1" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            pointer-events: none;
        }

        /* Enhanced User Info Section */
        .user-info {
            background: linear-gradient(135deg, rgba(233, 30, 99, 0.15), rgba(156, 39, 176, 0.15));
            padding: 2.5rem;
            border-radius: 20px;
            margin: 3rem auto;
            max-width: 1400px;
            border: 1px solid rgba(233, 30, 99, 0.3);
            text-align: center;
            animation: fadeInUp 0.8s ease-out;
            position: relative;
            overflow: hidden;
        }

        .user-info::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(45deg, transparent, rgba(233, 30, 99, 0.05), transparent);
            pointer-events: none;
        }

        .account-timer {
            font-size: 1.4rem;
            color: var(--primary);
            margin-top: 1rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        .expired {
            color: var(--danger);
            animation: pulse 2s infinite;
        }

        /* Session Management */
        .session-card {
            background: rgba(255, 255, 255, 0.05);
            padding: 1.5rem;
            border-radius: 8px;
            margin-bottom: 1rem;
            border-left: 4px solid var(--primary);
            transition: all 0.3s ease;
        }

        .session-card:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .session-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .session-status {
            padding: 0.4rem 0.8rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .status-pending {
            background: rgba(255, 152, 0, 0.2);
            color: var(--warning);
            border: 1px solid var(--warning);
        }

        .status-confirmed {
            background: rgba(76, 175, 80, 0.2);
            color: var(--success);
            border: 1px solid var(--success);
        }

        .status-cancelled {
            background: rgba(244, 67, 54, 0.2);
            color: var(--danger);
            border: 1px solid var(--danger);
        }

        .session-actions {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
        }

        /* Fake Interaction Controls */
        .fake-interaction-controls {
            display: flex;
            gap: 0.5rem;
            margin-top: 1rem;
            flex-wrap: wrap;
        }

        /* Model Dropdown */
        .model-dropdown {
            position: relative;
            margin-top: 1rem;
        }

        .dropdown-btn {
            width: 100%;
            padding: 0.7rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            color: var(--light);
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.3s ease;
        }

        .dropdown-btn:hover {
            background: rgba(255, 255, 255, 0.1);
        }

        .dropdown-content {
            display: none;
            position: absolute;
            top: 100%;
            left: 0;
            width: 100%;
            background: var(--surface-light);
            border-radius: 8px;
            margin-top: 0.5rem;
            padding: 1rem;
            z-index: 10;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            max-height: 300px;
            overflow-y: auto;
        }

        .dropdown-content.active {
            display: block;
            animation: fadeIn 0.3s ease-out;
        }

        .public-post {
            background: rgba(255, 255, 255, 0.05);
            padding: 1rem;
            border-radius: 8px;
            margin-bottom: 1rem;
        }

        .public-post img {
            width: 100%;
            border-radius: 8px;
            margin-bottom: 0.5rem;
        }

        /* Enhanced Loading Spinner */
        .loading {
            display: inline-block;
            width: 24px;
            height: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: var(--primary);
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Toast Overrides */
        .toast-success {
            background: var(--success) !important;
        }

        .toast-error {
            background: var(--danger) !important;
        }

        .toast-info {
            background: var(--secondary) !important;
        }

        /* Enhanced Sexy Subscription Popup */
        .sexy-popup {
            background: linear-gradient(135deg, #1a1a2e, #16213e);
            border: 2px solid var(--primary);
            box-shadow: 0 20px 60px rgba(233, 30, 99, 0.5);
        }

        .sexy-popup .modal-image {
            border: 4px solid var(--primary);
            box-shadow: 0 0 30px rgba(233, 30, 99, 0.6);
            animation: imageGlow 2s infinite alternate;
        }

        @keyframes imageGlow {
            from {
                box-shadow: 0 0 20px rgba(233, 30, 99, 0.5);
            }
            to {
                box-shadow: 0 0 30px rgba(233, 30, 99, 0.8), 0 0 40px rgba(156, 39, 176, 0.6);
            }
        }

        .sexy-popup h2 {
            color: var(--primary);
            text-shadow: 0 2px 15px rgba(233, 30, 99, 0.4);
            animation: textGlow 3s infinite alternate;
        }

        @keyframes textGlow {
            from {
                text-shadow: 0 2px 10px rgba(233, 30, 99, 0.4);
            }
            to {
                text-shadow: 0 2px 20px rgba(233, 30, 99, 0.7), 0 2px 30px rgba(156, 39, 176, 0.5);
            }
        }

        .sexy-popup p {
            font-size: 1.1rem;
            color: rgba(255, 255, 255, 0.9);
        }

        /* Public Posts Modal */
        .public-posts-modal .modal-content {
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .public-posts-container {
            display: grid;
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .public-post-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.4s ease;
        }

        .public-post-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 30px rgba(0, 0, 0, 0.3);
        }

        .public-post-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }

        .public-post-content {
            padding: 1rem;
        }

        .public-post-description {
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .public-post-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 0.8rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Enhanced Models Gallery Modal */
        .models-gallery-modal .modal-content {
            max-width: 100%;
            width: 100%;
            height: 100vh;
            border-radius: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            animation: modalSlideUp 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
        }

        @keyframes modalSlideUp {
            from {
                opacity: 0;
                transform: translate(-50%, -40%);
            }
            to {
                opacity: 1;
                transform: translate(-50%, -50%);
            }
        }

        .models-gallery-header {
            background: var(--surface-light);
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .models-gallery-grid {
            flex: 1;
            overflow-y: auto;
            padding: 1rem;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .gallery-model-card {
            background: var(--surface);
            border-radius: 12px;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(255, 255, 255, 0.05);
            position: relative;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2);
        }

        .gallery-model-card:hover {
            transform: translateY(-8px) scale(1.03);
            box-shadow: 0 15px 35px rgba(233, 30, 99, 0.25);
            border-color: rgba(233, 30, 99, 0.3);
        }

        .gallery-model-image {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }

        .gallery-model-info {
            padding: 1.5rem;
        }

        /* Front Page Models Section */
        .frontpage-models {
            padding: 6rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
            animation: fadeIn 1s ease-out;
        }

        .frontpage-models-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 2.5rem;
        }

        /* NEW STYLES FOR ADDED FEATURES */

        /* Stories Floating Head */
        .stories-container {
            position: fixed;
            top: 80px;
            left: 0;
            width: 100%;
            background: rgba(30, 30, 30, 0.9);
            backdrop-filter: blur(10px);
            padding: 1rem;
            z-index: 999;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        .stories-scroll {
            display: flex;
            gap: 1rem;
            overflow-x: auto;
            padding-bottom: 0.5rem;
        }

        .story-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .story-item:hover {
            transform: scale(1.05);
        }

        .story-avatar {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
            padding: 2px;
        }

        .story-name {
            margin-top: 0.5rem;
            font-size: 0.8rem;
            text-align: center;
            max-width: 70px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .story-expanded {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 10001;
            backdrop-filter: blur(10px);
        }

        .story-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 400px;
            background: var(--surface);
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
        }

        .story-header {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: var(--surface-light);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .story-header-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            object-fit: cover;
            margin-right: 0.8rem;
        }

        .story-actions {
            display: flex;
            padding: 1rem;
            gap: 1rem;
        }

        .story-actions button {
            flex: 1;
        }

        /* Sidebar Menu */
        .sidebar {
            position: fixed;
            top: 0;
            left: -300px;
            width: 300px;
            height: 100vh;
            background: var(--surface);
            z-index: 10002;
            transition: left 0.3s ease;
            box-shadow: 5px 0 15px rgba(0, 0, 0, 0.3);
            overflow-y: auto;
        }

        .sidebar.active {
            left: 0;
        }

        .sidebar-header {
            padding: 1.5rem;
            background: var(--surface-light);
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .sidebar-menu {
            padding: 1rem 0;
        }

        .sidebar-item {
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--light);
            text-decoration: none;
            transition: all 0.3s ease;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .sidebar-item:hover {
            background: rgba(255, 255, 255, 0.05);
            color: var(--primary);
        }

        .sidebar-item.active {
            background: rgba(233, 30, 99, 0.1);
            color: var(--primary);
            border-left: 4px solid var(--primary);
        }

        /* Page Swipe Container */
        .page-container {
            position: relative;
            width: 100%;
            overflow: hidden;
        }

        .pages {
            display: flex;
            transition: transform 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .page {
            min-width: 100%;
            padding-top: 80px;
        }

        .swipe-indicator {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-size: 0.8rem;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            animation: bounce 2s infinite;
        }

        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {transform: translateX(-50%) translateY(0);}
            40% {transform: translateX(-50%) translateY(-10px);}
            60% {transform: translateX(-50%) translateY(-5px);}
        }

        /* Model Profile Page */
        .model-profile {
            padding: 2rem;
            max-width: 1200px;
            margin: 0 auto;
        }

        .profile-header {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            align-items: flex-start;
        }

        .profile-avatar {
            width: 150px;
            height: 150px;
            border-radius: 50%;
            object-fit: cover;
            border: 4px solid var(--primary);
        }

        .profile-info {
            flex: 1;
        }

        .profile-name {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }

        .profile-bio {
            margin-bottom: 1rem;
            color: rgba(255, 255, 255, 0.8);
        }

        .profile-stats {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
        }

        .profile-stat {
            text-align: center;
        }

        .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary);
        }

        .stat-label {
            font-size: 0.8rem;
            color: rgba(255, 255, 255, 0.6);
        }

        .profile-posts {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .profile-post {
            background: var(--surface);
            border-radius: 12px;
            overflow: hidden;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .post-media {
            width: 100%;
            height: 300px;
            object-fit: cover;
        }

        .post-locked {
            filter: blur(15px);
            position: relative;
        }

        .post-lock-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            gap: 1rem;
        }

        .post-content {
            padding: 1rem;
        }

        .post-caption {
            margin-bottom: 1rem;
        }

        .post-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* Wallet Section */
        .wallet-section {
            padding: 2rem;
            max-width: 800px;
            margin: 0 auto;
        }

        .wallet-balance {
            text-align: center;
            margin-bottom: 2rem;
            padding: 2rem;
            background: var(--surface);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .balance-amount {
            font-size: 3rem;
            font-weight: bold;
            color: var(--primary);
            margin: 1rem 0;
        }

        .wallet-actions {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .wallet-history {
            background: var(--surface);
            border-radius: 12px;
            padding: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .history-item:last-child {
            border-bottom: none;
        }

        /* Video Reels Section */
        .reels-section {
            position: relative;
            height: calc(100vh - 80px);
            overflow: hidden;
        }

        .reel-container {
            position: relative;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }

        .reel-video {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .reel-overlay {
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            padding: 2rem;
            background: linear-gradient(transparent, rgba(0, 0, 0, 0.7));
            color: white;
        }

        .reel-model-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .reel-model-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            object-fit: cover;
            border: 2px solid var(--primary);
        }

        .reel-actions {
            position: absolute;
            right: 2rem;
            bottom: 2rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .reel-action-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .reel-action-btn:hover {
            transform: scale(1.1);
        }

        .reel-action-count {
            font-size: 0.8rem;
        }

        /* Responsive Design with enhanced animations */
        @media (max-width: 1024px) {
            .frontpage-models-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            }
        }

        @media (max-width: 768px) {
            header {
                padding: 1rem;
            }

            .nav-links {
                display: none;
            }

            .hero {
                padding: 6rem 1rem;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .frontpage-models {
                padding: 3rem 1rem;
            }

            .frontpage-models-grid {
                grid-template-columns: 1fr;
            }

            .admin-tabs {
                flex-direction: column;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .modal-content {
                padding: 2rem 1.5rem;
                width: 95%;
            }

            .modal-buttons {
                flex-direction: column;
            }

            .auth-buttons {
                gap: 0.5rem;
            }

            .btn {
                padding: 0.6rem 1.2rem;
                font-size: 0.85rem;
            }

            .admin-header {
                flex-direction: column;
                gap: 1rem;
                align-items: flex-start;
            }

            .session-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }
            
            .model-card:hover {
                transform: translateY(-5px);
            }
            
            .btn:hover {
                transform: translateY(-2px);
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }

            .profile-stats {
                justify-content: center;
            }

            .sidebar {
                width: 100%;
                left: -100%;
            }

            .reel-actions {
                right: 1rem;
                bottom: 1rem;
            }
        }

        @media (max-width: 480px) {
            .hero h1 {
                font-size: 2rem;
            }

            .section-title {
                font-size: 1.8rem;
            }

            .model-image {
                height: 300px;
            }

            .card-grid {
                grid-template-columns: 1fr;
            }

            .stories-scroll {
                gap: 0.5rem;
            }

            .story-avatar {
                width: 50px;
                height: 50px;
            }

            .profile-posts {
                grid-template-columns: 1fr;
            }
        }

        /* Add smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Add fade-in animation for page elements */
        .fade-in {
            animation: fadeIn 1s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Prevent content download */
        .no-download {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            pointer-events: none;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header id="mainHeader">
        <div class="nav-container">
            <div class="logo">Camsilo</div>
            <nav class="nav-links">
                <a href="#home" class="active">Home</a>
                <a href="#premium">Premium</a>
                <a href="#about">About</a>
            </nav>
            <div class="auth-buttons" id="authButtons">
                <button class="btn btn-outline" onclick="openLoginModal()">
                    <i class="fas fa-user"></i>Login
                </button>
            </div>
        </div>
    </header>

    <!-- Stories Floating Head -->
    <div class="stories-container" id="storiesContainer">
        <div class="stories-scroll" id="storiesScroll">
            <!-- Stories will be loaded here -->
        </div>
    </div>

    <!-- Story Expanded View -->
    <div class="story-expanded" id="storyExpanded">
        <div class="story-content">
            <div class="story-header">
                <img id="expandedStoryAvatar" src="" alt="" class="story-header-avatar">
                <div>
                    <div id="expandedStoryName" style="font-weight: bold;"></div>
                    <div style="font-size: 0.8rem; color: rgba(255,255,255,0.7);">Live Now</div>
                </div>
            </div>
            <div class="story-media-container">
                <img id="expandedStoryMedia" src="" alt="" style="width: 100%; height: 300px; object-fit: cover;">
            </div>
            <div class="story-actions">
                <button class="btn btn-primary" onclick="viewModelProfileFromStory()">
                    <i class="fas fa-user"></i> View Model
                </button>
                <button class="btn btn-success" onclick="sendTipToModel()">
                    <i class="fas fa-gift"></i> Send Tip
                </button>
            </div>
        </div>
    </div>

    <!-- Sidebar Menu -->
    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h3>Menu</h3>
            <button class="btn btn-outline" onclick="toggleSidebar()">
                <i class="fas fa-times"></i>
            </button>
        </div>
        <div class="sidebar-menu">
            <a href="#" class="sidebar-item active" onclick="switchPage(0)">
                <i class="fas fa-home"></i> Home
            </a>
            <a href="#" class="sidebar-item" onclick="switchPage(1)">
                <i class="fas fa-users"></i> Models
            </a>
            <a href="#" class="sidebar-item" onclick="switchPage(2)">
                <i class="fas fa-video"></i> Videos
            </a>
            <a href="#" class="sidebar-item" onclick="switchPage(3)">
                <i class="fas fa-wallet"></i> Wallet
            </a>
            <a href="#" class="sidebar-item" onclick="switchPage(4)">
                <i class="fas fa-user"></i> Profile
            </a>
            <a href="#" class="sidebar-item" onclick="openAdminPanel()">
                <i class="fas fa-crown"></i> Admin
            </a>
            <a href="#" class="sidebar-item" onclick="logout()">
                <i class="fas fa-sign-out-alt"></i> Logout
            </a>
        </div>
    </div>

    <!-- Page Swipe Container -->
    <div class="page-container">
        <div class="pages" id="pages">
            <!-- Home Page -->
            <div class="page" id="homePage">
                <!-- Hero Section - Only show when not logged in -->
                <section class="hero" id="home" style="display: none;">
                    <div class="hero-content">
                        <h1>Camsilo models</h1>
                        <p>Experience the ultimate in adult entertainment with our exclusive models. Premium content, private shows, and unforgettable experiences.</p>
                        <button class="btn btn-primary" onclick="openModelsGallery()">
                            <i class="fas fa-star"></i>Explore Models
                        </button>
                    </div>
                </section>

                <!-- Dynamic Models Section - Changes based on login status -->
                <section class="frontpage-models" id="modelsSection">
                    <h2 class="section-title" id="modelsSectionTitle">Featured Models</h2>
                    <div class="frontpage-models-grid" id="modelsGrid">
                        <!-- Content changes based on login status -->
                    </div>
                </section>

                <!-- User Info Section -->
                <section class="user-info" id="userInfo" style="display: none;">
                    <h2>Your Premium Account</h2>
                    <div class="form-row">
                        <div>
                            <strong>Account Created:</strong> <span id="accountCreated">-</span>
                        </div>
                        <div>
                            <strong>Expires:</strong> <span id="accountExpires">-</span>
                        </div>
                    </div>
                    <div class="account-timer" id="accountTimer"></div>
                    <button class="btn btn-primary" onclick="renewAccount()" style="margin-top: 1rem;">
                        <i class="fas fa-sync-alt"></i>Renew Subscription
                    </button>
                </section>
            </div>

            <!-- Models Page -->
            <div class="page" id="modelsPage" style="display: none;">
                <section class="models-section">
                    <h2 class="section-title">All Models</h2>
                    <div class="models-grid" id="allModelsGrid">
                        <!-- All models will be loaded here -->
                    </div>
                </section>
            </div>

            <!-- Videos Page -->
            <div class="page" id="videosPage" style="display: none;">
                <div class="reels-section">
                    <div class="reel-container" id="reelContainer">
                        <!-- Reels will be loaded here -->
                    </div>
                    <div class="reel-overlay">
                        <div class="reel-model-info">
                            <img id="reelModelAvatar" src="" alt="" class="reel-model-avatar">
                            <div>
                                <div id="reelModelName" style="font-weight: bold;"></div>
                                <div style="font-size: 0.8rem; color: rgba(255,255,255,0.7);" id="reelModelCaption"></div>
                            </div>
                        </div>
                    </div>
                    <div class="reel-actions">
                        <button class="reel-action-btn" onclick="likeReel()">
                            <i class="fas fa-heart"></i>
                            <span class="reel-action-count" id="reelLikes">0</span>
                        </button>
                        <button class="reel-action-btn" onclick="tipReelModel()">
                            <i class="fas fa-gift"></i>
                            <span class="reel-action-count">Tip</span>
                        </button>
                        <button class="reel-action-btn" onclick="viewReelModelProfile()">
                            <i class="fas fa-user"></i>
                            <span class="reel-action-count">Profile</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Wallet Page -->
            <div class="page" id="walletPage" style="display: none;">
                <div class="wallet-section">
                    <div class="wallet-balance">
                        <h2>Your Wallet</h2>
                        <div class="balance-amount" id="walletBalance">$0.00</div>
                        <p>Available Balance</p>
                    </div>

                    <div class="wallet-actions">
                        <button class="btn btn-primary" onclick="openAddFundsModal()">
                            <i class="fas fa-plus"></i> Add Funds
                        </button>
                        <button class="btn btn-outline" onclick="openWithdrawModal()">
                            <i class="fas fa-download"></i> Withdraw
                        </button>
                        <button class="btn btn-outline" onclick="openTransactionHistory()">
                            <i class="fas fa-history"></i> History
                        </button>
                    </div>

                    <div class="wallet-history">
                        <h3>Recent Transactions</h3>
                        <div id="transactionHistory">
                            <!-- Transaction history will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>

            <!-- Profile Page -->
            <div class="page" id="profilePage" style="display: none;">
                <div class="model-profile">
                    <div class="profile-header">
                        <img id="userProfileAvatar" src="" alt="" class="profile-avatar">
                        <div class="profile-info">
                            <div class="profile-name">
                                <span id="userProfileName">User Name</span>
                                <i class="fas fa-check-circle verified"></i>
                            </div>
                            <div class="profile-bio" id="userProfileBio">
                                This is the user bio. It can be edited in the profile settings.
                            </div>
                            <div class="profile-stats">
                                <div class="profile-stat">
                                    <div class="stat-value" id="userPostsCount">0</div>
                                    <div class="stat-label">Posts</div>
                                </div>
                                <div class="profile-stat">
                                    <div class="stat-value" id="userFollowersCount">0</div>
                                    <div class="stat-label">Followers</div>
                                </div>
                                <div class="profile-stat">
                                    <div class="stat-value" id="userFollowingCount">0</div>
                                    <div class="stat-label">Following</div>
                                </div>
                            </div>
                            <button class="btn btn-primary" onclick="editProfile()">
                                <i class="fas fa-edit"></i> Edit Profile
                            </button>
                        </div>
                    </div>

                    <div class="profile-posts" id="userProfilePosts">
                        <!-- User posts will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Swipe Indicator -->
    <div class="swipe-indicator" id="swipeIndicator" style="display: none;">
        <i class="fas fa-arrows-alt-h"></i> Swipe to navigate
    </div>

    <!-- Admin Panel -->
    <section class="admin-panel" id="adminPanel">
        <div class="admin-header">
            <h2 style="background: linear-gradient(45deg, var(--primary), var(--secondary)); -webkit-background-clip: text; -webkit-text-fill-color: transparent;">
                <i class="fas fa-crown"></i> Admin Control Panel
            </h2>
            <button class="btn btn-danger" onclick="adminLogout()">
                <i class="fas fa-sign-out-alt"></i>Logout
            </button>
        </div>

        <div class="admin-tabs">
            <button class="admin-tab active" onclick="switchAdminTab('models')">
                <i class="fas fa-users"></i>Manage Models
            </button>
            <button class="admin-tab" onclick="switchAdminTab('hardcodedFrontpageModels')">
                <i class="fas fa-home"></i>Hard-coded Front Page Models
            </button>
            <button class="admin-tab" onclick="switchAdminTab('users')">
                <i class="fas fa-user-friends"></i>Manage Users
            </button>
            <button class="admin-tab" onclick="switchAdminTab('sessions')">
                <i class="fas fa-video"></i>Session Requests
            </button>
            <button class="admin-tab" onclick="switchAdminTab('content')">
                <i class="fas fa-photo-video"></i>Content Control
            </button>
            <button class="admin-tab" onclick="switchAdminTab('posts')">
                <i class="fas fa-bullhorn"></i>Broadcast Posts
            </button>
            <button class="admin-tab" onclick="switchAdminTab('settings')">
                <i class="fas fa-cogs"></i>Website Settings
            </button>
            <button class="admin-tab" onclick="switchAdminTab('stories')">
                <i class="fas fa-history"></i>Manage Stories
            </button>
            <button class="admin-tab" onclick="switchAdminTab('wallet')">
                <i class="fas fa-wallet"></i>Wallet Settings
            </button>
            <button class="admin-tab" onclick="switchAdminTab('reels')">
                <i class="fas fa-film"></i>Manage Reels
            </button>
        </div>

        <!-- Models Tab -->
        <div class="admin-content active" id="modelsTab">
            <h3><i class="fas fa-users"></i> Model Management</h3>
            <form id="modelForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>Model Name *</label>
                        <input type="text" id="modelName" required placeholder="Enter model name">
                    </div>
                    <div class="form-group">
                        <label>Verified</label>
                        <select id="modelVerified">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Image URL *</label>
                    <input type="text" id="modelImage" required value="https://i.postimg.cc/cHB5zQYM/1758636933933.jpg">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Likes Count</label>
                        <input type="number" id="modelLikes" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label>Comments to Show</label>
                        <input type="number" id="modelCommentsCount" value="3" min="0" max="10">
                    </div>
                </div>

                <div class="form-group">
                    <label>Comments (one per line)</label>
                    <textarea id="modelComments" rows="4" placeholder="Add comments that will be displayed..."></textarea>
                </div>

                <div class="form-group">
                    <label>Public Posts (one per line, format: image_url|description)</label>
                    <textarea id="modelPublicPosts" rows="4" placeholder="https://example.com/image1.jpg|My sexy public post description"></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Video Call Link</label>
                        <input type="text" id="videoCallLink" placeholder="https://zoom.us/j/...">
                    </div>
                    <div class="form-group">
                        <label>Content Type</label>
                        <select id="contentType">
                            <option value="public">Public</option>
                            <option value="private">Private (Members Only)</option>
                        </select>
                    </div>
                </div>

                <div class="form-group">
                    <label>Embed Video URL (Optional)</label>
                    <input type="text" id="embedVideo" placeholder="https://youtube.com/embed/...">
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Add Model
                </button>
            </form>

            <div class="card-grid" id="modelsList">
                <!-- Existing models will be listed here -->
            </div>
        </div>

        <!-- Hard-coded Front Page Models Tab -->
        <div class="admin-content" id="hardcodedFrontpageModelsTab">
            <h3><i class="fas fa-home"></i> Hard-coded Front Page Models Management</h3>
            <p>Models added here will appear immediately on the front page when users visit the site. These are stored locally and not in Firebase.</p>
            
            <form id="hardcodedModelForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>Model Name *</label>
                        <input type="text" id="hardcodedModelName" required placeholder="Enter model name">
                    </div>
                    <div class="form-group">
                        <label>Verified</label>
                        <select id="hardcodedModelVerified">
                            <option value="true">Yes</option>
                            <option value="false">No</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>Image URL *</label>
                    <input type="text" id="hardcodedModelImage" required placeholder="https://example.com/model.jpg">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Likes Count</label>
                        <input type="number" id="hardcodedModelLikes" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label>Comments to Show</label>
                        <input type="number" id="hardcodedModelCommentsCount" value="3" min="0" max="10">
                    </div>
                </div>

                <div class="form-group">
                    <label>Comments (one per line)</label>
                    <textarea id="hardcodedModelComments" rows="4" placeholder="Add comments that will be displayed..."></textarea>
                </div>

                <div class="form-group">
                    <label>Public Posts (one per line, format: image_url|description)</label>
                    <textarea id="hardcodedModelPublicPosts" rows="4" placeholder="https://example.com/image1.jpg|My sexy public post description"></textarea>
                </div>

                <div class="form-group">
                    <label>Video Call Link</label>
                    <input type="text" id="hardcodedVideoCallLink" placeholder="https://zoom.us/j/...">
                </div>

                <div class="form-group">
                    <label>Embed Video URL (Optional)</label>
                    <input type="text" id="hardcodedEmbedVideo" placeholder="https://youtube.com/embed/...">
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-save"></i> Add Hard-coded Model
                </button>
            </form>

            <div class="card-grid" id="hardcodedModelsList">
                <!-- Hard-coded models will be listed here -->
            </div>
        </div>

        <!-- Users Tab -->
        <div class="admin-content" id="usersTab">
            <h3><i class="fas fa-user-friends"></i> User Management</h3>
            <form id="userForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>User Email *</label>
                        <input type="email" id="userEmail" required placeholder="user@example.com">
                    </div>
                    <div class="form-group">
                        <label>Initial Password *</label>
                        <input type="text" id="userPassword" required placeholder="Generate a strong password">
                    </div>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-user-plus"></i> Create User Account
                </button>
            </form>

            <h4 style="margin-top: 2rem;">Existing Users</h4>
            <div id="usersList" class="card-grid">
                <!-- Users list will be loaded here -->
            </div>
        </div>

        <!-- Sessions Tab -->
        <div class="admin-content" id="sessionsTab">
            <h3><i class="fas fa-video"></i> Session Requests Management</h3>
            <div id="sessionsList">
                <!-- Session requests will be loaded here -->
            </div>
        </div>

        <!-- Content Tab -->
        <div class="admin-content" id="contentTab">
            <h3><i class="fas fa-photo-video"></i> Content Control</h3>
            
            <div class="form-group">
                <label>Background Image URL</label>
                <input type="text" id="backgroundImage" placeholder="https://example.com/background.jpg">
            </div>
            
            <div class="form-group">
                <label>Subscription Popup Image URL</label>
                <input type="text" id="subscriptionImage" placeholder="https://example.com/sexy-subscription-image.jpg">
            </div>
            
            <div class="form-group">
                <label>Subscription Link</label>
                <input type="text" id="subscriptionLink" placeholder="https://your-payment-page.com">
            </div>

            <div class="form-group">
                <label>Renewal Popup Image URL</label>
                <input type="text" id="renewalImage" placeholder="https://example.com/sexy-renewal-image.jpg">
            </div>
            
            <div class="form-group">
                <label>Renewal Link</label>
                <input type="text" id="renewalLink" placeholder="https://your-renewal-page.com">
            </div>

            <button class="btn btn-primary" onclick="updateContentSettings()">
                <i class="fas fa-save"></i> Update Content Settings
            </button>
        </div>

        <!-- Posts Tab -->
        <div class="admin-content" id="postsTab">
            <h3><i class="fas fa-bullhorn"></i> Broadcast Post</h3>
            <form id="postForm">
                <div class="form-group">
                    <label>Post Title *</label>
                    <input type="text" id="postTitle" required placeholder="Enter post title">
                </div>
                
                <div class="form-group">
                    <label>Post Content *</label>
                    <textarea id="postContent" required rows="5" placeholder="Enter your message to all users..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Button Text</label>
                        <input type="text" id="postButtonText" placeholder="Click Here">
                    </div>
                    <div class="form-group">
                        <label>Button Link</label>
                        <input type="text" id="postButtonLink" placeholder="https://example.com">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-paper-plane"></i> Broadcast to All Users
                </button>
            </form>

            <h4 style="margin-top: 2rem;">Recent Broadcasts</h4>
            <div id="postsList" class="card-grid">
                <!-- Posts list will be loaded here -->
            </div>
        </div>

        <!-- Settings Tab -->
        <div class="admin-content" id="settingsTab">
            <h3><i class="fas fa-cogs"></i> Website Settings</h3>
            
            <div class="form-group">
                <label>Website Title</label>
                <input type="text" id="websiteTitle" placeholder="Camsilo">
            </div>

            <div class="form-group">
                <label>Welcome Message</label>
                <textarea id="welcomeMessage" rows="3" placeholder="Welcome to our exclusive platform..."></textarea>
            </div>

            <div class="form-row">
                <div class="form-group">
                    <label>Primary Color</label>
                    <input type="color" id="primaryColor" value="#e91e63">
                </div>
                <div class="form-group">
                    <label>Secondary Color</label>
                    <input type="color" id="secondaryColor" value="#9c27b0">
                </div>
            </div>

            <button class="btn btn-primary" onclick="updateWebsiteSettings()">
                <i class="fas fa-save"></i> Update Website Settings
            </button>
        </div>

        <!-- Stories Tab -->
        <div class="admin-content" id="storiesTab">
            <h3><i class="fas fa-history"></i> Manage Stories</h3>
            <form id="storyForm">
                <div class="form-group">
                    <label>Select Model</label>
                    <select id="storyModel" required>
                        <option value="">Select a model</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Story Media URL (Image or Video)</label>
                    <input type="text" id="storyMedia" required placeholder="https://example.com/story.jpg">
                </div>

                <div class="form-group">
                    <label>Button Link (Optional)</label>
                    <input type="text" id="storyButtonLink" placeholder="https://example.com">
                </div>

                <div class="form-group">
                    <label>Button Text (Optional)</label>
                    <input type="text" id="storyButtonText" placeholder="View More">
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Add Story
                </button>
            </form>

            <h4 style="margin-top: 2rem;">Active Stories</h4>
            <div id="storiesList" class="card-grid">
                <!-- Stories list will be loaded here -->
            </div>
        </div>

        <!-- Wallet Tab -->
        <div class="admin-content" id="walletTab">
            <h3><i class="fas fa-wallet"></i> Wallet Settings</h3>
            
            <div class="form-group">
                <label>Add Funds Link</label>
                <input type="text" id="addFundsLink" placeholder="https://payment.example.com/add-funds">
            </div>

            <div class="form-group">
                <label>Withdraw Funds Link</label>
                <input type="text" id="withdrawFundsLink" placeholder="https://payment.example.com/withdraw">
            </div>

            <div class="form-group">
                <label>Minimum Withdrawal Amount</label>
                <input type="number" id="minWithdrawal" value="10" min="1">
            </div>

            <button class="btn btn-primary" onclick="updateWalletSettings()">
                <i class="fas fa-save"></i> Update Wallet Settings
            </button>
        </div>

        <!-- Reels Tab -->
        <div class="admin-content" id="reelsTab">
            <h3><i class="fas fa-film"></i> Manage Reels</h3>
            <form id="reelForm">
                <div class="form-group">
                    <label>Select Model</label>
                    <select id="reelModel" required>
                        <option value="">Select a model</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Video URL</label>
                    <input type="text" id="reelVideo" required placeholder="https://example.com/reel.mp4">
                </div>

                <div class="form-group">
                    <label>Caption</label>
                    <textarea id="reelCaption" rows="3" placeholder="Enter reel caption..."></textarea>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label>Unlock Price (Credits)</label>
                        <input type="number" id="reelPrice" value="0" min="0">
                    </div>
                    <div class="form-group">
                        <label>Initial Likes</label>
                        <input type="number" id="reelLikes" value="0" min="0">
                    </div>
                </div>

                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-plus"></i> Add Reel
                </button>
            </form>

            <h4 style="margin-top: 2rem;">Active Reels</h4>
            <div id="reelsList" class="card-grid">
                <!-- Reels list will be loaded here -->
            </div>
        </div>
    </section>
    <!-- Subscription Warning Modal -->
<div class="modal sexy-popup" id="subscriptionModal">
    <div class="modal-content">
        <img id="subscriptionModalImage" src="https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80" alt="Subscribe" class="modal-image">
        <h2>Unlock Pleasure Beyond Imagination</h2>
        <p>Darling, you're so close to experiencing pure ecstasy. Subscribe now to unlock intimate moments, exclusive content, and private shows with our most seductive models.</p>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('subscriptionModal')">
                <i class="fas fa-times"></i> Maybe Later
            </button>
            <button class="btn btn-primary" onclick="redirectToHardcodedSubscribe()">
                <i class="fas fa-gem"></i> Yes, I Want It All!
            </button>
        </div>
    </div>
</div>

<!-- Renewal Modal -->
<div class="modal sexy-popup" id="renewalModal">
    <div class="modal-content">
        <img id="renewalModalImage" src="" alt="Renew Subscription" class="modal-image">
        <h2>Don't Let the Magic End</h2>
        <p>Your journey into pleasure has expired. Renew now to continue exploring our exclusive content and intimate experiences with the world's most captivating models.</p>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('renewalModal')">
                <i class="fas fa-times"></i> Not Now
            </button>
            <button class="btn btn-primary" onclick="redirectToRenewal()">
                <i class="fas fa-sync-alt"></i> Continue the Magic
            </button>
        </div>
    </div>
</div>

<!-- Video Call Modal -->
<div class="modal" id="videoCallModal">
    <div class="modal-content">
        <h2>Book Private Video Call</h2>
        <p>Experience an intimate video call session with our model. Fill in your details below:</p>
        
        <div class="form-group">
            <label>Your Email *</label>
            <input type="email" id="userEmailInput" placeholder="Enter your email" required>
        </div>
        
        <div class="form-group">
            <label>Preferred Date & Time</label>
            <input type="datetime-local" id="callDateTime">
        </div>
        
        <div class="form-group">
            <label>Special Requests (Optional)</label>
            <textarea id="callRequests" rows="3" placeholder="Any special preferences or requests..."></textarea>
        </div>

        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('videoCallModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="bookVideoCall()">
                <i class="fas fa-video"></i> Book Session
            </button>
        </div>
    </div>
</div>

<!-- Admin Login Modal -->
<div class="modal" id="adminLoginModal">
    <div class="modal-content">
        <h2>Admin Login</h2>
        <div class="form-group">
            <label>Email</label>
            <input type="email" id="adminEmail" required placeholder="admin@camsilo.com">
        </div>
        <div class="form-group">
            <label>Password</label>
            <input type="password" id="adminPassword" required placeholder="Enter your password">
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('adminLoginModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="adminLogin()">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
        </div>
    </div>
</div>

<!-- User Login Modal -->
<div class="modal" id="userLoginModal">
    <div class="modal-content">
        <h2>User Login</h2>
        <div class="form-group">
            <label>Email</label>
            <input type="email" id="loginEmail" required placeholder="your@email.com">
        </div>
        <div class="form-group">
            <label>Password</label>
            <input type="password" id="loginPassword" required placeholder="Enter your password">
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('userLoginModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="userLogin()">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
        </div>
    </div>
</div>

<!-- Comment Modal -->
<div class="modal" id="commentModal">
    <div class="modal-content">
        <h2>Add Comment</h2>
        <div class="form-group">
            <label>Your Comment</label>
            <textarea id="commentText" rows="4" placeholder="Write your comment here..." required></textarea>
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('commentModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="submitComment()">
                <i class="fas fa-comment"></i> Post Comment
            </button>
        </div>
    </div>
</div>

<!-- Admin Comment Modal -->
<div class="modal" id="adminCommentModal">
    <div class="modal-content">
        <h2>Add Fake Comment</h2>
        <div class="form-group">
            <label>Comment Text</label>
            <textarea id="adminCommentText" rows="4" placeholder="Write a fake comment..." required></textarea>
        </div>
        <div class="form-group">
            <label>Username (Optional)</label>
            <input type="text" id="fakeUsername" placeholder="Leave empty for random username">
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('adminCommentModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="submitAdminComment()">
                <i class="fas fa-comment"></i> Add Fake Comment
            </button>
        </div>
    </div>
</div>

<!-- Public Posts Modal -->
<div class="modal public-posts-modal" id="publicPostsModal">
    <div class="modal-content">
        <h2 id="publicPostsModelName">Public Posts</h2>
        <div class="public-posts-container" id="publicPostsContainer">
            <!-- Public posts will be loaded here -->
        </div>
        <div class="modal-buttons" style="margin-top: 1.5rem;">
            <button class="btn btn-primary" onclick="closeModal('publicPostsModal')">
                <i class="fas fa-times"></i> Close
            </button>
        </div>
    </div>
</div>

<!-- Models Gallery Modal -->
<div class="modal models-gallery-modal" id="modelsGalleryModal">
    <div class="modal-content">
        <div class="models-gallery-header">
            <h2 style="margin: 0;">All Models</h2>
            <button class="btn btn-outline" onclick="closeModal('modelsGalleryModal')">
                <i class="fas fa-times"></i> Close
            </button>
        </div>
        <div class="models-gallery-grid" id="modelsGalleryGrid">
            <!-- Models will be loaded here -->
        </div>
    </div>
</div>

<!-- Add Funds Modal -->
<div class="modal" id="addFundsModal">
    <div class="modal-content">
        <h2>Add Funds to Wallet</h2>
        <div class="form-group">
            <label>Amount</label>
            <input type="number" id="fundAmount" min="1" required placeholder="Enter amount">
        </div>
        <div class="form-group">
            <label>Payment Method</label>
            <select id="paymentMethod" required>
                <option value="">Select payment method</option>
                <option value="credit">Credit Card</option>
                <option value="paypal">PayPal</option>
                <option value="crypto">Cryptocurrency</option>
            </select>
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('addFundsModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="processPayment()">
                <i class="fas fa-credit-card"></i> Add Funds
            </button>
        </div>
    </div>
</div>

<!-- Unlock Post Modal -->
<div class="modal" id="unlockPostModal">
    <div class="modal-content">
        <h2>Unlock Content</h2>
        <p>This content requires <span id="unlockPrice" style="color: var(--primary); font-weight: bold;">0</span> credits to unlock.</p>
        <p>Your current balance: <span id="currentBalance" style="color: var(--primary); font-weight: bold;">0</span> credits</p>
        <div id="insufficientFunds" style="display: none; color: var(--danger); margin-bottom: 1rem;">
            <i class="fas fa-exclamation-triangle"></i> Insufficient funds. Please add more credits to unlock this content.
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('unlockPostModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" id="unlockButton" onclick="unlockPost()">
                <i class="fas fa-unlock"></i> Unlock
            </button>
            <button class="btn btn-success" id="addFundsButton" onclick="openAddFundsModal()" style="display: none;">
                <i class="fas fa-plus"></i> Add Funds
            </button>
        </div>
    </div>
</div>

<!-- Edit Profile Modal -->
<div class="modal" id="editProfileModal">
    <div class="modal-content">
        <h2>Edit Profile</h2>
        <div class="form-group">
            <label>Display Name</label>
            <input type="text" id="editDisplayName" placeholder="Enter your display name">
        </div>
        <div class="form-group">
            <label>Bio</label>
            <textarea id="editBio" rows="4" placeholder="Tell us about yourself..."></textarea>
        </div>
        <div class="form-group">
            <label>Profile Picture URL</label>
            <input type="text" id="editProfilePic" placeholder="https://example.com/profile.jpg">
        </div>
        <div class="modal-buttons">
            <button class="btn btn-outline" onclick="closeModal('editProfileModal')">
                <i class="fas fa-times"></i> Cancel
            </button>
            <button class="btn btn-primary" onclick="saveProfile()">
                <i class="fas fa-save"></i> Save Changes
            </button>
        </div>
    </div>
</div>

<!-- Scripts -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-storage.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/2.1.4/toastr.min.js"></script>
<script src="config.js"></script>
<script>
// Firebase Initialization
const auth = firebase.auth();
const db = firebase.firestore();

// Toastr configuration
toastr.options = {
    closeButton: true,
    progressBar: true,
    positionClass: "toast-top-right",
    timeOut: 5000
};

// Firebase References
const modelsRef = db.collection('models');
const usersRef = db.collection('users');
const settingsRef = db.collection('settings').doc('website');
const postsRef = db.collection('posts');
const bookingsRef = db.collection('bookings');
const commentsRef = db.collection('comments');
const storiesRef = db.collection('stories');
const reelsRef = db.collection('reels');
const walletRef = db.collection('wallet');
const transactionsRef = db.collection('transactions');

// State Management
let currentUser = null;
let adminUser = null;
let websiteSettings = {};
let allModels = [];
let hardcodedFrontpageModels = [];
let currentEditingModel = null;
let currentEditingHardcodedModel = null;
let currentCommentModelId = null;
let currentModelId = null;
let currentPage = 0;
let stories = [];
let reels = [];
let currentReelIndex = 0;
let userWallet = { balance: 0, transactions: [] };
let startX = 0;
let currentUnlockPost = null;

// Initialize Hardcoded Models (stored in JavaScript array)
function initializeHardcodedModels() {
    // Check if we have hardcoded models in localStorage
    const storedModels = localStorage.getItem('hardcodedFrontpageModels');
    
    if (storedModels) {
        hardcodedFrontpageModels = JSON.parse(storedModels);
    } else {
        // Initial hard-coded model with your image
        hardcodedFrontpageModels = [
            {
                id: '1',
                name: 'Premium Model',
                image: 'https://i.postimg.cc/cHB5zQYM/1758636933933.jpg',
                verified: true,
                likes: 1250,
                comments: [
                    "Stunning beauty! 😍",
                    "Can't wait for your next show!",
                    "Absolutely incredible 🔥"
                ],
                publicPosts: [
                    "https://i.postimg.cc/cHB5zQYM/1758636933933.jpg|My exclusive content for you!",
                    "https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80|Behind the scenes 😉"
                ],
                commentsCount: 3,
                videoCallLink: "https://zoom.us/j/123456789",
                embedVideo: "",
                createdAt: new Date().toISOString()
            }
        ];
        saveHardcodedModels();
    }
    
    // Display models based on login status
    updateModelsDisplay();
}

// Save hard-coded models to localStorage
function saveHardcodedModels() {
    localStorage.setItem('hardcodedFrontpageModels', JSON.stringify(hardcodedFrontpageModels));
}

// Enhanced Subscription Validation Function - FIXED FOR ALL LOGGED-IN USERS
function validateSubscription() {
    // If user is not logged in, show subscription modal
    if (!currentUser && !adminUser) {
        openModal('subscriptionModal');
        return false;
    }
    
    // Admin users don't need subscription
    if (adminUser) return true;
    
    // Regular users need active subscription
    if (currentUser && !isSubscriptionActive(currentUser)) {
        openModal('renewalModal');
        return false;
    }
    
    return true;
}

// Enhanced 1-month subscription validation - FIXED
function isSubscriptionActive(user) {
    if (!user.expiresAt) return false;
    
    const now = new Date();
    const expires = user.expiresAt.toDate();
    
    // Subscription is active if it hasn't expired and user is active
    return now < expires && user.isActive !== false;
}

// Update models display based on login status
function updateModelsDisplay() {
    const modelsGrid = document.getElementById('modelsGrid');
    const modelsSectionTitle = document.getElementById('modelsSectionTitle');
    modelsGrid.innerHTML = '';

    if (currentUser || adminUser) {
        // User is logged in - show "Camsilo Models" with Firebase models
        modelsSectionTitle.textContent = 'Camsilo Models';
        
        let cardIndex = 0;
        allModels.forEach(model => {
            const modelCard = createModelCard(model);
            modelCard.style.setProperty('--card-index', cardIndex);
            cardIndex++;
            modelsGrid.appendChild(modelCard);
        });

        if (allModels.length === 0) {
            modelsGrid.innerHTML = '<p style="text-align: center; padding: 2rem; grid-column: 1 / -1;">No models available yet.</p>';
        }
    } else {
        // User is not logged in - show "Featured Models" with hard-coded models
        modelsSectionTitle.textContent = 'Featured Models';
        
        let cardIndex = 0;
        hardcodedFrontpageModels.forEach(model => {
            const modelCard = createHardcodedModelCard(model);
            modelCard.style.setProperty('--card-index', cardIndex);
            cardIndex++;
            modelsGrid.appendChild(modelCard);
        });
    }

    // Update admin hardcoded models list
    if (adminUser) {
        updateHardcodedModelsList();
    }
}

// Initialize Website
document.addEventListener('DOMContentLoaded', function() {
    initializeWebsite();
    setupScrollEffects();
    initializeHardcodedModels();
    setupSwipeNavigation();
    loadStories();
    loadReels();
    loadUserWallet();
});

// Enhanced scroll effects
function setupScrollEffects() {
    const header = document.getElementById('mainHeader');
    
    window.addEventListener('scroll', function() {
        if (window.scrollY > 100) {
            header.classList.add('header-scrolled');
        } else {
            header.classList.remove('header-scrolled');
        }
        
        // Add fade-in animation for elements when they come into view
        const elements = document.querySelectorAll('.model-card, .section-title');
        elements.forEach(element => {
            const elementTop = element.getBoundingClientRect().top;
            const elementVisible = 150;
            
            if (elementTop < window.innerHeight - elementVisible) {
                element.classList.add('fade-in');
            }
        });
    });
}

// Setup swipe navigation
function setupSwipeNavigation() {
    const pagesContainer = document.getElementById('pages');
    
    document.addEventListener('touchstart', function(e) {
        startX = e.touches[0].clientX;
    });
    
    document.addEventListener('touchend', function(e) {
        if (!startX) return;
        
        const endX = e.changedTouches[0].clientX;
        const diffX = startX - endX;
        
        // Minimum swipe distance
        if (Math.abs(diffX) > 50) {
            if (diffX > 0) {
                // Swipe left - next page
                nextPage();
            } else {
                // Swipe right - previous page
                previousPage();
            }
        }
        
        startX = 0;
    });
    
    // Show swipe indicator for mobile users
    if (window.innerWidth <= 768) {
        setTimeout(() => {
            const indicator = document.getElementById('swipeIndicator');
            indicator.style.display = 'flex';
            setTimeout(() => {
                indicator.style.display = 'none';
            }, 5000);
        }, 2000);
    }
}

// Page navigation functions
function switchPage(pageIndex) {
    const pages = document.getElementById('pages');
    const totalPages = pages.children.length;
    
    if (pageIndex >= 0 && pageIndex < totalPages) {
        currentPage = pageIndex;
        pages.style.transform = `translateX(-${pageIndex * 100}%)`;
        
        // Update sidebar active item
        document.querySelectorAll('.sidebar-item').forEach((item, index) => {
            if (index === pageIndex) {
                item.classList.add('active');
            } else {
                item.classList.remove('active');
            }
        });
        
        // Hide sidebar after selection (on mobile)
        if (window.innerWidth <= 768) {
            toggleSidebar();
        }
        
        // Load page-specific content
        loadPageContent(pageIndex);
    }
}

function nextPage() {
    const totalPages = document.getElementById('pages').children.length;
    if (currentPage < totalPages - 1) {
        switchPage(currentPage + 1);
    }
}

function previousPage() {
    if (currentPage > 0) {
        switchPage(currentPage - 1);
    }
}

function loadPageContent(pageIndex) {
    switch(pageIndex) {
        case 0: // Home
            updateModelsDisplay();
            break;
        case 1: // Models
            loadAllModels();
            break;
        case 2: // Videos
            loadCurrentReel();
            break;
        case 3: // Wallet
            loadUserWallet();
            break;
        case 4: // Profile
            loadUserProfile();
            break;
    }
}

// Sidebar functions
function toggleSidebar() {
    const sidebar = document.getElementById('sidebar');
    sidebar.classList.toggle('active');
}

// Stories functions
async function loadStories() {
    try {
        const snapshot = await storiesRef.where('active', '==', true).get();
        stories = [];
        
        snapshot.forEach(doc => {
            const story = { id: doc.id, ...doc.data() };
            stories.push(story);
        });
        
        updateStoriesDisplay();
    } catch (error) {
        console.error('Error loading stories:', error);
    }
}

function updateStoriesDisplay() {
    const storiesScroll = document.getElementById('storiesScroll');
    storiesScroll.innerHTML = '';
    
    if (stories.length > 0 && (currentUser || adminUser)) {
        document.getElementById('storiesContainer').style.display = 'block';
        
        stories.forEach(story => {
            const model = allModels.find(m => m.id === story.modelId) || 
                         hardcodedFrontpageModels.find(m => m.id === story.modelId);
            
            if (model) {
                const storyItem = document.createElement('div');
                storyItem.className = 'story-item';
                storyItem.innerHTML = `
                    <img src="${model.image}" alt="${model.name}" class="story-avatar">
                    <div class="story-name">${model.name}</div>
                `;
                storyItem.onclick = () => openStory(story, model);
                storiesScroll.appendChild(storyItem);
            }
        });
    } else {
        document.getElementById('storiesContainer').style.display = 'none';
    }
}

function openStory(story, model) {
    document.getElementById('expandedStoryAvatar').src = model.image;
    document.getElementById('expandedStoryName').textContent = model.name;
    document.getElementById('expandedStoryMedia').src = story.mediaUrl;
    
    document.getElementById('storyExpanded').style.display = 'block';
    currentModelId = model.id;
}

function closeStory() {
    document.getElementById('storyExpanded').style.display = 'none';
}

function viewModelProfileFromStory() {
    closeStory();
    // Navigate to model profile - implementation depends on your profile page structure
    toastr.info('Opening model profile...');
}

function sendTipToModel() {
    closeStory();
    openAddFundsModal();
    toastr.info('Redirecting to tip payment...');
}

// Reels functions
async function loadReels() {
    try {
        const snapshot = await reelsRef.orderBy('createdAt', 'desc').get();
        reels = [];
        
        snapshot.forEach(doc => {
            const reel = { id: doc.id, ...doc.data() };
            reels.push(reel);
        });
        
        if (reels.length > 0) {
            loadCurrentReel();
        }
    } catch (error) {
        console.error('Error loading reels:', error);
    }
}

function loadCurrentReel() {
    if (reels.length === 0) return;
    
    const reel = reels[currentReelIndex];
    const model = allModels.find(m => m.id === reel.modelId) || 
                 hardcodedFrontpageModels.find(m => m.id === reel.modelId);
    
    if (model) {
        const reelContainer = document.getElementById('reelContainer');
        reelContainer.innerHTML = `
            <video src="${reel.videoUrl}" class="reel-video" autoplay muted loop controlsList="nodownload" oncontextmenu="return false;"></video>
        `;
        
        document.getElementById('reelModelAvatar').src = model.image;
        document.getElementById('reelModelName').textContent = model.name;
        document.getElementById('reelModelCaption').textContent = reel.caption;
        document.getElementById('reelLikes').textContent = reel.likes || 0;
        
        // Prevent video download
        const video = reelContainer.querySelector('video');
        video.addEventListener('contextmenu', (e) => e.preventDefault());
    }
}

function nextReel() {
    if (reels.length > 0) {
        currentReelIndex = (currentReelIndex + 1) % reels.length;
        loadCurrentReel();
    }
}

function previousReel() {
    if (reels.length > 0) {
        currentReelIndex = (currentReelIndex - 1 + reels.length) % reels.length;
        loadCurrentReel();
    }
}

function likeReel() {
    if (!validateSubscription()) return;
    
    const reel = reels[currentReelIndex];
    if (reel) {
        // Update likes in Firebase
        reelsRef.doc(reel.id).update({
            likes: (reel.likes || 0) + 1
        });
        
        // Update local state
        reel.likes = (reel.likes || 0) + 1;
        document.getElementById('reelLikes').textContent = reel.likes;
        
        toastr.success('Liked! ❤️');
    }
}

function tipReelModel() {
    if (!validateSubscription()) return;
    openAddFundsModal();
}

function viewReelModelProfile() {
    if (!validateSubscription()) return;
    
    const reel = reels[currentReelIndex];
    if (reel) {
        // Navigate to model profile
        toastr.info(`Opening ${reel.modelName}'s profile...`);
    }
}

// Wallet functions
async function loadUserWallet() {
    if (!currentUser && !adminUser) return;
    
    try {
        const walletDoc = await walletRef.doc(currentUser ? currentUser.uid : 'admin').get();
        if (walletDoc.exists) {
            userWallet = walletDoc.data();
        } else {
            // Initialize wallet
            userWallet = {
                balance: 0,
                transactions: []
            };
            await walletRef.doc(currentUser ? currentUser.uid : 'admin').set(userWallet);
        }
        
        // Load transaction history
        const transactionsSnapshot = await transactionsRef
            .where('userId', '==', currentUser ? currentUser.uid : 'admin')
            .orderBy('createdAt', 'desc')
            .limit(10)
            .get();
        
        userWallet.transactions = [];
        transactionsSnapshot.forEach(doc => {
            userWallet.transactions.push({ id: doc.id, ...doc.data() });
        });
        
        updateWalletDisplay();
    } catch (error) {
        console.error('Error loading wallet:', error);
    }
}

function updateWalletDisplay() {
    document.getElementById('walletBalance').textContent = `$${userWallet.balance.toFixed(2)}`;
    
    const transactionHistory = document.getElementById('transactionHistory');
    transactionHistory.innerHTML = '';
    
    if (userWallet.transactions.length === 0) {
        transactionHistory.innerHTML = '<p style="text-align: center; padding: 1rem;">No transactions yet.</p>';
    } else {
        userWallet.transactions.forEach(transaction => {
            const transactionItem = document.createElement('div');
            transactionItem.className = 'history-item';
            
            const amountClass = transaction.type === 'credit' ? 'success' : 'danger';
            const amountSign = transaction.type === 'credit' ? '+' : '-';
            
            transactionItem.innerHTML = `
                <div>
                    <div style="font-weight: bold;">${transaction.description}</div>
                    <div style="font-size: 0.8rem; color: rgba(255,255,255,0.7);">
                        ${new Date(transaction.createdAt?.toDate()).toLocaleDateString()}
                    </div>
                </div>
                <div class="text-${amountClass}" style="font-weight: bold;">
                    ${amountSign}$${Math.abs(transaction.amount).toFixed(2)}
                </div>
            `;
            transactionHistory.appendChild(transactionItem);
        });
    }
}

function openAddFundsModal() {
    if (!validateSubscription()) return;
    openModal('addFundsModal');
}

async function processPayment() {
    const amount = parseFloat(document.getElementById('fundAmount').value);
    const paymentMethod = document.getElementById('paymentMethod').value;
    
    if (!amount || amount <= 0 || !paymentMethod) {
        toastr.error('Please enter a valid amount and select payment method');
        return;
    }

    try {
        // In a real app, you would process payment here
        // For demo, we'll just add the funds
        
        // Update wallet balance
        const newBalance = userWallet.balance + amount;
        await walletRef.doc(currentUser ? currentUser.uid : 'admin').update({
            balance: newBalance
        });
        
        // Record transaction
        await transactionsRef.add({
            userId: currentUser ? currentUser.uid : 'admin',
            type: 'credit',
            amount: amount,
            description: `Added funds via ${paymentMethod}`,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        // Update local state
        userWallet.balance = newBalance;
        userWallet.transactions.unshift({
            type: 'credit',
            amount: amount,
            description: `Added funds via ${paymentMethod}`,
            createdAt: new Date()
        });
        
        updateWalletDisplay();
        closeModal('addFundsModal');
        toastr.success(`Successfully added $${amount.toFixed(2)} to your wallet!`);
        
    } catch (error) {
        console.error('Error processing payment:', error);
        toastr.error('Failed to process payment');
    }
}

// Profile functions
async function loadUserProfile() {
    if (!currentUser && !adminUser) return;
    
    try {
        // In a real app, you would load user profile from Firebase
        // For demo, we'll use mock data
        document.getElementById('userProfileName').textContent = currentUser?.email?.split('@')[0] || 'Admin User';
        document.getElementById('userProfileBio').textContent = 'Welcome to my profile!';
        document.getElementById('userProfileAvatar').src = 'https://images.unsplash.com/photo-1535713875002-d1d0cf377fde?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80';
        
        // Load user posts
        loadUserPosts();
    } catch (error) {
        console.error('Error loading user profile:', error);
    }
}

function loadUserPosts() {
    // In a real app, you would load user posts from Firebase
    // For demo, we'll show empty state
    document.getElementById('userPostsCount').textContent = '0';
    document.getElementById('userFollowersCount').textContent = '0';
    document.getElementById('userFollowingCount').textContent = '0';
    
    const userProfilePosts = document.getElementById('userProfilePosts');
    userProfilePosts.innerHTML = '<p style="text-align: center; padding: 2rem; grid-column: 1 / -1;">No posts yet.</p>';
}

function editProfile() {
    if (!validateSubscription()) return;
    
    document.getElementById('editDisplayName').value = document.getElementById('userProfileName').textContent;
    document.getElementById('editBio').value = document.getElementById('userProfileBio').textContent;
    document.getElementById('editProfilePic').value = document.getElementById('userProfileAvatar').src;
    
    openModal('editProfileModal');
}

function saveProfile() {
    const displayName = document.getElementById('editDisplayName').value;
    const bio = document.getElementById('editBio').value;
    const profilePic = document.getElementById('editProfilePic').value;
    
    // Update UI
    document.getElementById('userProfileName').textContent = displayName;
    document.getElementById('userProfileBio').textContent = bio;
    document.getElementById('userProfileAvatar').src = profilePic;
    
    // In a real app, you would save to Firebase here
    
    closeModal('editProfileModal');
    toastr.success('Profile updated successfully!');
}

// Post unlocking functions
function unlockPost(postId, price) {
    if (!validateSubscription()) return;
    
    currentUnlockPost = { id: postId, price: price };
    
    document.getElementById('unlockPrice').textContent = price;
    document.getElementById('currentBalance').textContent = userWallet.balance;
    
    const insufficientFunds = document.getElementById('insufficientFunds');
    const unlockButton = document.getElementById('unlockButton');
    const addFundsButton = document.getElementById('addFundsButton');
    
    if (userWallet.balance >= price) {
        insufficientFunds.style.display = 'none';
        unlockButton.style.display = 'block';
        addFundsButton.style.display = 'none';
    } else {
        insufficientFunds.style.display = 'block';
        unlockButton.style.display = 'none';
        addFundsButton.style.display = 'block';
    }
    
    openModal('unlockPostModal');
}

async function processUnlock() {
    if (!currentUnlockPost) return;
    
    try {
        // Deduct from wallet
        const newBalance = userWallet.balance - currentUnlockPost.price;
        await walletRef.doc(currentUser ? currentUser.uid : 'admin').update({
            balance: newBalance
        });
        
        // Record transaction
        await transactionsRef.add({
            userId: currentUser ? currentUser.uid : 'admin',
            type: 'debit',
            amount: currentUnlockPost.price,
            description: `Unlocked premium content`,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });
        
        // Update local state
        userWallet.balance = newBalance;
        userWallet.transactions.unshift({
            type: 'debit',
            amount: currentUnlockPost.price,
            description: `Unlocked premium content`,
            createdAt: new Date()
        });
        
        updateWalletDisplay();
        closeModal('unlockPostModal');
        toastr.success('Content unlocked successfully!');
        
        // In a real app, you would mark the post as unlocked for this user
        
    } catch (error) {
        console.error('Error unlocking post:', error);
        toastr.error('Failed to unlock content');
    }
}
        // Enhanced Model Card with new features
    function createModelCard(model) {
        const card = document.createElement('div');
        card.className = 'model-card';
        
        // Get comments for this model
        const modelComments = model.comments || [];
        const publicPosts = model.publicPosts || [];
        
        card.innerHTML = `
            <div class="model-image-container">
                <img src="${model.image}" alt="${model.name}" class="model-image" onerror="this.src='https://images.unsplash.com/photo-1511285605577-4d62fb50d2f7?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'">
                <div class="model-badge">
                    <i class="fas fa-crown"></i> ${model.contentType === 'private' ? 'Premium' : 'Public'}
                </div>
            </div>
            <div class="model-info">
                <div class="model-name">
                    <h3>${model.name}</h3>
                    ${model.verified ? '<i class="fas fa-check-circle verified"></i>' : ''}
                </div>
                
                ${model.embedVideo ? `
                    <div style="margin: 1rem 0;">
                        <iframe width="100%" height="200" src="${model.embedVideo}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                ` : ''}

                <div class="model-stats">
                    <div class="likes">
                        <button class="like-btn ${model.userLiked ? 'liked' : ''}" onclick="handleLike('${model.id}')">
                            <i class="fas fa-heart"></i>
                        </button>
                        <span>${model.likes || 0}</span>
                    </div>
                    <div class="comments">
                        <button class="comment-btn" onclick="openCommentModal('${model.id}')">
                            <i class="fas fa-comment"></i>
                        </button>
                        <span>${modelComments.length}</span>
                    </div>
                </div>

                ${publicPosts.length > 0 ? `
                    <button class="btn btn-outline" style="width: 100%; margin-bottom: 1rem;" onclick="openPublicPostsModal('${model.id}')">
                        <i class="fas fa-images"></i> View Public Posts (${publicPosts.length})
                    </button>
                ` : ''}

                ${modelComments.length > 0 ? `
                    <div class="comments-section">
                        ${modelComments.slice(0, model.commentsCount || 3).map(comment => `
                            <div class="comment">${comment}</div>
                        `).join('')}
                    </div>
                ` : ''}

                ${adminUser ? `
                    <div class="fake-interaction-controls">
                        <button class="btn btn-sm btn-warning" onclick="boostLikes('${model.id}')">
                            <i class="fas fa-rocket"></i> Boost Likes
                        </button>
                        <button class="btn btn-sm btn-primary" onclick="openAdminCommentModal('${model.id}')">
                            <i class="fas fa-comment"></i> Add Fake Comment
                        </button>
                    </div>
                ` : ''}

                <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                    <button class="book-btn" onclick="openVideoCallModal('${model.id}')" style="flex: 1;">
                        <i class="fas fa-video"></i> Book Show
                    </button>
                    <button class="btn btn-outline" onclick="openChatPage()" style="flex: 1;">
                        <i class="fas fa-comments"></i> Chat
                    </button>
                </div>
            </div>
        `;
        return card;
    }

    // Create Hard-coded Model Card for Front Page - FOR NON-SUBSCRIBED USERS ONLY
    function createHardcodedModelCard(model) {
        const card = document.createElement('div');
        card.className = 'model-card';
        
        // Get comments for this model
        const modelComments = model.comments || [];
        const publicPosts = model.publicPosts || [];
        
        card.innerHTML = `
            <div class="model-image-container">
                <img src="${model.image}" alt="${model.name}" class="model-image" onerror="this.src='https://images.unsplash.com/photo-1511285605577-4d62fb50d2f7?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80'">
                <div class="model-badge">
                    <i class="fas fa-star"></i> Featured
                </div>
            </div>
            <div class="model-info">
                <div class="model-name">
                    <h3>${model.name}</h3>
                    ${model.verified ? '<i class="fas fa-check-circle verified"></i>' : ''}
                </div>
                
                ${model.embedVideo ? `
                    <div style="margin: 1rem 0;">
                        <iframe width="100%" height="200" src="${model.embedVideo}" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                    </div>
                ` : ''}

                <div class="model-stats">
                    <div class="likes">
                        <button class="like-btn" onclick="handleHardcodedModelInteraction()">
                            <i class="fas fa-heart"></i>
                        </button>
                        <span>${model.likes || 0}</span>
                    </div>
                    <div class="comments">
                        <button class="comment-btn" onclick="handleHardcodedModelInteraction()">
                            <i class="fas fa-comment"></i>
                        </button>
                        <span>${modelComments.length}</span>
                    </div>
                </div>

                ${publicPosts.length > 0 ? `
                    <button class="btn btn-outline" style="width: 100%; margin-bottom: 1rem;" onclick="handleHardcodedModelInteraction()">
                        <i class="fas fa-images"></i> View Public Posts (${publicPosts.length})
                    </button>
                ` : ''}

                ${modelComments.length > 0 ? `
                    <div class="comments-section">
                        ${modelComments.slice(0, model.commentsCount || 3).map(comment => `
                            <div class="comment">${comment}</div>
                        `).join('')}
                    </div>
                ` : ''}

                ${adminUser ? `
                    <div class="fake-interaction-controls">
                        <button class="btn btn-sm btn-warning" onclick="boostHardcodedLikes('${model.id}')">
                            <i class="fas fa-rocket"></i> Boost Likes
                        </button>
                        <button class="btn btn-sm btn-primary" onclick="openAdminHardcodedCommentModal('${model.id}')">
                            <i class="fas fa-comment"></i> Add Fake Comment
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteHardcodedModel('${model.id}')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                ` : ''}

                <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                    <button class="book-btn" onclick="handleHardcodedModelInteraction()" style="flex: 1;">
                        <i class="fas fa-video"></i> Book Show
                    </button>
                    <button class="btn btn-outline" onclick="handleHardcodedModelInteraction()" style="flex: 1;">
                        <i class="fas fa-comments"></i> Chat
                    </button>
                </div>
            </div>
        `;
        return card;
    }

    // Handle Hard-coded Model Interaction - Show subscription popup for non-subscribed users
    function handleHardcodedModelInteraction() {
        openModal('subscriptionModal');
    }

    // Open Chat Page (External) - chat1.html - FOR ALL LOGGED-IN USERS
    function openChatPage() {
        if (!validateSubscription()) return;
        
        // Open external chat page - chat1.html
        window.open('chat1.html', '_blank');
    }

    // Open Models Gallery - FOR ALL LOGGED-IN USERS
    function openModelsGallery() {
        if (!validateSubscription()) return;
        
        openModal('modelsGalleryModal');
        loadModelsGallery();
    }

    // Load Models for Gallery (Firebase Models Only) - FOR ALL LOGGED-IN USERS
    function loadModelsGallery() {
        const galleryGrid = document.getElementById('modelsGalleryGrid');
        galleryGrid.innerHTML = '';

        // Only show Firebase models to logged-in users
        allModels.forEach(model => {
            const galleryCard = document.createElement('div');
            galleryCard.className = 'gallery-model-card';
            
            galleryCard.innerHTML = `
                <img src="${model.image}" alt="${model.name}" class="gallery-model-image">
                <div class="gallery-model-info">
                    <h3>${model.name} ${model.verified ? '<i class="fas fa-check-circle verified"></i>' : ''}</h3>
                    <p>${model.contentType === 'private' ? 'Premium Model' : 'Public Model'}</p>
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="openVideoCallModal('${model.id}')" style="flex: 1;">
                            <i class="fas fa-video"></i> Book
                        </button>
                        <button class="btn btn-outline" onclick="openChatPage()" style="flex: 1;">
                            <i class="fas fa-comments"></i> Chat
                        </button>
                    </div>
                </div>
            `;
            galleryGrid.appendChild(galleryCard);
        });

        // Show message if no models
        if (allModels.length === 0) {
            galleryGrid.innerHTML = '<p style="text-align: center; padding: 2rem;">No models available yet.</p>';
        }
    }

    // Handle Like - FOR ALL LOGGED-IN USERS
    async function handleLike(modelId) {
        if (!validateSubscription()) return;

        try {
            const model = allModels.find(m => m.id === modelId);
            
            // Check if user already liked this model
            const likeDoc = await db.collection('likes').doc(`${modelId}_${currentUser ? currentUser.uid : 'admin'}`).get();
            if (likeDoc.exists) {
                toastr.info('You already liked this model!');
                return;
            }

            const newLikes = (model.likes || 0) + 1;
            
            // Update model likes
            await modelsRef.doc(modelId).update({
                likes: newLikes,
                lastLiked: firebase.firestore.FieldValue.serverTimestamp()
            });

            // Record the like to prevent duplicate likes
            await db.collection('likes').doc(`${modelId}_${currentUser ? currentUser.uid : 'admin'}`).set({
                modelId: modelId,
                userId: currentUser ? currentUser.uid : 'admin',
                createdAt: firebase.firestore.FieldValue.serverTimestamp()
            });

            // Update local state
            model.likes = newLikes;
            model.userLiked = true;
            
            // Update UI
            await loadModels();
            updateModelsDisplay();
            toastr.success('Liked! ❤️');

        } catch (error) {
            console.error('Error liking model:', error);
            toastr.error('Failed to like model');
        }
    }

    // Boost Likes (Admin Only)
    async function boostLikes(modelId) {
        if (!adminUser) return;
        
        try {
            const model = allModels.find(m => m.id === modelId);
            const boostAmount = Math.floor(Math.random() * 50) + 10; // Random boost between 10-60
            const newLikes = (model.likes || 0) + boostAmount;
            
            await modelsRef.doc(modelId).update({
                likes: newLikes
            });

            // Update local state
            model.likes = newLikes;
            
            // Update UI
            await loadModels();
            updateModelsDisplay();
            toastr.success(`Boosted ${model.name}'s likes by ${boostAmount}!`);
        } catch (error) {
            console.error('Error boosting likes:', error);
            toastr.error('Failed to boost likes');
        }
    }

    // Boost Hard-coded Model Likes (Admin Only)
    function boostHardcodedLikes(modelId) {
        if (!adminUser) return;
        
        try {
            const model = hardcodedFrontpageModels.find(m => m.id === modelId);
            const boostAmount = Math.floor(Math.random() * 50) + 10; // Random boost between 10-60
            const newLikes = (model.likes || 0) + boostAmount;
            
            // Update model likes
            model.likes = newLikes;
            
            // Save to localStorage
            saveHardcodedModels();
            
            // Update UI
            updateModelsDisplay();
            toastr.success(`Boosted ${model.name}'s likes by ${boostAmount}!`);
        } catch (error) {
            console.error('Error boosting hardcoded model likes:', error);
            toastr.error('Failed to boost likes');
        }
    }

    // Comment Functions - FOR ALL LOGGED-IN USERS
    function openCommentModal(modelId) {
        if (!validateSubscription()) return;
        
        currentCommentModelId = modelId;
        document.getElementById('commentText').value = '';
        openModal('commentModal');
    }

    async function submitComment() {
        const commentText = document.getElementById('commentText').value.trim();
        
        if (!commentText) {
            toastr.error('Please enter a comment');
            return;
        }

        try {
            const model = allModels.find(m => m.id === currentCommentModelId);
            const currentComments = model.comments || [];
            
            // Add new comment
            currentComments.unshift(commentText);
            
            // Update model with new comments
            await modelsRef.doc(currentCommentModelId).update({
                comments: currentComments
            });

            toastr.success('Comment added successfully!');
            closeModal('commentModal');
            await loadModels();
            updateModelsDisplay();
            
        } catch (error) {
            console.error('Error adding comment:', error);
            toastr.error('Failed to add comment');
        }
    }

    // Admin Fake Comment Functions
    function openAdminCommentModal(modelId) {
        currentCommentModelId = modelId;
        document.getElementById('adminCommentText').value = '';
        document.getElementById('fakeUsername').value = '';
        openModal('adminCommentModal');
    }

    async function submitAdminComment() {
        const commentText = document.getElementById('adminCommentText').value.trim();
        
        if (!commentText) {
            toastr.error('Please enter a comment');
            return;
        }

        try {
            const model = allModels.find(m => m.id === currentCommentModelId);
            const currentComments = model.comments || [];
            
            // Generate fake username if not provided
            let username = document.getElementById('fakeUsername').value.trim();
            if (!username) {
                const fakeNames = ['HotFan123', 'SecretAdmirer', 'LoyalViewer', 'NightOwl', 'DreamClient', 'MysteryMan'];
                username = fakeNames[Math.floor(Math.random() * fakeNames.length)];
            }
            
            // Add fake comment with username
            const fakeComment = `${username}: ${commentText}`;
            currentComments.unshift(fakeComment);
            
            // Update model with new comments
            await modelsRef.doc(currentCommentModelId).update({
                comments: currentComments
            });

            toastr.success('Fake comment added successfully!');
            closeModal('adminCommentModal');
            await loadModels();
            updateModelsDisplay();
            
        } catch (error) {
            console.error('Error adding fake comment:', error);
            toastr.error('Failed to add fake comment');
        }
    }

    // Admin Hard-coded Fake Comment Functions
    function openAdminHardcodedCommentModal(modelId) {
        currentCommentModelId = modelId;
        document.getElementById('adminCommentText').value = '';
        document.getElementById('fakeUsername').value = '';
        openModal('adminCommentModal');
    }

    function submitAdminHardcodedComment() {
        const commentText = document.getElementById('adminCommentText').value.trim();
        
        if (!commentText) {
            toastr.error('Please enter a comment');
            return;
        }

        try {
            const model = hardcodedFrontpageModels.find(m => m.id === currentCommentModelId);
            const currentComments = model.comments || [];
            
            // Generate fake username if not provided
            let username = document.getElementById('fakeUsername').value.trim();
            if (!username) {
                const fakeNames = ['HotFan123', 'SecretAdmirer', 'LoyalViewer', 'NightOwl', 'DreamClient', 'MysteryMan'];
                username = fakeNames[Math.floor(Math.random() * fakeNames.length)];
            }
            
            // Add fake comment with username
            const fakeComment = `${username}: ${commentText}`;
            currentComments.unshift(fakeComment);
            
            // Update model with new comments
            model.comments = currentComments;
            
            // Save to localStorage
            saveHardcodedModels();
            
            // Update UI
            updateModelsDisplay();
            toastr.success('Fake comment added successfully!');
            closeModal('adminCommentModal');
            
        } catch (error) {
            console.error('Error adding fake comment to hardcoded model:', error);
            toastr.error('Failed to add fake comment');
        }
    }

    // Open Public Posts Modal - FOR ALL LOGGED-IN USERS
    function openPublicPostsModal(modelId) {
        if (!validateSubscription()) return;

        const model = allModels.find(m => m.id === modelId);
        if (!model) return;

        const publicPosts = model.publicPosts || [];
        const container = document.getElementById('publicPostsContainer');
        const modelNameElement = document.getElementById('publicPostsModelName');
        
        modelNameElement.textContent = `${model.name}'s Public Posts`;
        container.innerHTML = '';

        if (publicPosts.length === 0) {
            container.innerHTML = '<p>No public posts available.</p>';
        } else {
            publicPosts.forEach(post => {
                const [image, description] = post.split('|');
                const postElement = document.createElement('div');
                postElement.className = 'public-post-card';
                postElement.innerHTML = `
                    <img src="${image}" alt="Public post" class="public-post-image" onerror="this.style.display='none'">
                    <div class="public-post-content">
                        <p class="public-post-description">${description || 'No description'}</p>
                        <div class="public-post-stats">
                            <div class="likes">
                                <button class="like-btn" onclick="handleLike('${model.id}')">
                                    <i class="fas fa-heart"></i>
                                </button>
                                <span>0</span>
                            </div>
                            <div class="comments">
                                <button class="comment-btn" onclick="openCommentModal('${model.id}')">
                                    <i class="fas fa-comment"></i>
                                </button>
                                <span>0</span>
                            </div>
                        </div>
                    </div>
                `;
                container.appendChild(postElement);
            });
        }

        openModal('publicPostsModal');
    }

    // Video Call Booking - FOR ALL LOGGED-IN USERS
    function openVideoCallModal(modelId) {
        if (!validateSubscription()) return;
        
        currentModelId = modelId;
        openModal('videoCallModal');
    }

    async function bookVideoCall() {
        const email = document.getElementById('userEmailInput').value;
        const datetime = document.getElementById('callDateTime').value;
        const requests = document.getElementById('callRequests').value;

        if (!email) {
            toastr.error('Please enter your email');
            return;
        }

        try {
            const model = allModels.find(m => m.id === currentModelId);
            
            await bookingsRef.add({
                modelId: currentModelId,
                modelName: model.name,
                userEmail: email,
                callDateTime: datetime,
                specialRequests: requests,
                status: 'pending',
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                userId: currentUser ? currentUser.uid : null
            });

            toastr.success('Video call booking request sent! We will contact you soon.');
            closeModal('videoCallModal');
            
            // Reset form
            document.getElementById('userEmailInput').value = '';
            document.getElementById('callDateTime').value = '';
            document.getElementById('callRequests').value = '';

        } catch (error) {
            console.error('Error booking video call:', error);
            toastr.error('Failed to book video call');
        }
    }

    // Admin Functions
    function openAdminLogin() {
        openModal('adminLoginModal');
    }

    async function adminLogin() {
        const email = document.getElementById('adminEmail').value;
        const password = document.getElementById('adminPassword').value;

        if (!email || !password) {
            toastr.error('Please enter email and password');
            return;
        }

        try {
            const userCredential = await auth.signInWithEmailAndPassword(email, password);
            const user = userCredential.user;
            
            // Verify admin role
            const userDoc = await usersRef.doc(user.uid).get();
            if (userDoc.exists && userDoc.data().role === 'admin') {
                toastr.success('Admin login successful!');
                closeModal('adminLoginModal');
                // Auto-refresh after successful login
                setTimeout(() => {
                    window.location.reload();
                }, 1000);
            } else {
                await auth.signOut();
                toastr.error('Access denied. Admin privileges required.');
            }
        } catch (error) {
            console.error('Admin login error:', error);
            toastr.error('Login failed: ' + error.message);
        }
    }

    function showAdminPanel() {
        document.getElementById('adminPanel').style.display = 'block';
        loadUsersList();
        loadPostsList();
        loadSessionsList();
        updateHardcodedModelsList();
        loadAdminStories();
        loadAdminReels();
    }

    function hideAdminPanel() {
        document.getElementById('adminPanel').style.display = 'none';
    }

    async function adminLogout() {
        try {
            await auth.signOut();
            toastr.info('Logged out successfully');
            // Auto-refresh after logout
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        } catch (error) {
            console.error('Logout error:', error);
        }
    }

    function switchAdminTab(tabName) {
        // Hide all tabs
        document.querySelectorAll('.admin-content').forEach(tab => {
            tab.classList.remove('active');
        });
        document.querySelectorAll('.admin-tab').forEach(button => {
            button.classList.remove('active');
        });

        // Show selected tab
        document.getElementById(tabName + 'Tab').classList.add('active');
        event.target.classList.add('active');

        // Load specific data for certain tabs
        if (tabName === 'sessions') {
            loadSessionsList();
        } else if (tabName === 'users') {
            loadUsersList();
        } else if (tabName === 'posts') {
            loadPostsList();
        } else if (tabName === 'hardcodedFrontpageModels') {
            updateHardcodedModelsList();
        } else if (tabName === 'stories') {
            loadAdminStories();
        } else if (tabName === 'reels') {
            loadAdminReels();
        }
    }

    // Model Management
    async function handleModelSubmit(e) {
        e.preventDefault();
        
        const modelData = {
            name: document.getElementById('modelName').value,
            image: document.getElementById('modelImage').value,
            verified: document.getElementById('modelVerified').value === 'true',
            likes: parseInt(document.getElementById('modelLikes').value) || 0,
            comments: document.getElementById('modelComments').value.split('\n').filter(c => c.trim()),
            publicPosts: document.getElementById('modelPublicPosts').value.split('\n').filter(p => p.trim()),
            commentsCount: parseInt(document.getElementById('modelCommentsCount').value) || 3,
            videoCallLink: document.getElementById('videoCallLink').value,
            contentType: document.getElementById('contentType').value,
            embedVideo: document.getElementById('embedVideo').value,
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            updatedAt: firebase.firestore.FieldValue.serverTimestamp()
        };

        try {
            if (currentEditingModel) {
                // Update existing model
                await modelsRef.doc(currentEditingModel).update(modelData);
                toastr.success('Model updated successfully!');
                currentEditingModel = null;
                
                // Reset button text
                const submitBtn = document.querySelector('#modelForm button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-save"></i> Add Model';
            } else {
                // Add new model
                await modelsRef.add(modelData);
                toastr.success('Model added successfully!');
            }
            
            document.getElementById('modelForm').reset();
            await loadModels();
            updateModelsDisplay();
            
        } catch (error) {
            console.error('Error saving model:', error);
            toastr.error('Failed to save model: ' + error.message);
        }
    }

    function editModel(modelId) {
        const model = allModels.find(m => m.id === modelId);
        if (!model) return;

        currentEditingModel = modelId;
        
        // Populate form
        document.getElementById('modelName').value = model.name;
        document.getElementById('modelImage').value = model.image;
        document.getElementById('modelVerified').value = model.verified ? 'true' : 'false';
        document.getElementById('modelLikes').value = model.likes || 0;
        document.getElementById('modelCommentsCount').value = model.commentsCount || 3;
        document.getElementById('modelComments').value = model.comments ? model.comments.join('\n') : '';
        document.getElementById('modelPublicPosts').value = model.publicPosts ? model.publicPosts.join('\n') : '';
        document.getElementById('videoCallLink').value = model.videoCallLink || '';
        document.getElementById('contentType').value = model.contentType || 'public';
        document.getElementById('embedVideo').value = model.embedVideo || '';

        // Change button text
        const submitBtn = document.querySelector('#modelForm button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-save"></i> Update Model';
        
        toastr.info('Editing model: ' + model.name);
    }

    async function deleteModel(modelId) {
        if (!confirm('Are you sure you want to delete this model? This action cannot be undone.')) {
            return;
        }

        try {
            await modelsRef.doc(modelId).delete();
            toastr.success('Model deleted successfully!');
            await loadModels();
            updateModelsDisplay();
        } catch (error) {
            console.error('Error deleting model:', error);
            toastr.error('Failed to delete model');
        }
    }

    function updateAdminModelsList() {
        const modelsList = document.getElementById('modelsList');
        modelsList.innerHTML = '';

        allModels.forEach(model => {
            const modelCard = document.createElement('div');
            modelCard.className = 'card';
            modelCard.innerHTML = `
                <img src="${model.image}" alt="${model.name}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;">
                <h4>${model.name} ${model.verified ? '<i class="fas fa-check-circle verified"></i>' : ''}</h4>
                <p><strong>Likes:</strong> ${model.likes || 0}</p>
                <p><strong>Comments:</strong> ${model.comments ? model.comments.length : 0}</p>
                <p><strong>Public Posts:</strong> ${model.publicPosts ? model.publicPosts.length : 0}</p>
                <p><strong>Type:</strong> ${model.contentType === 'private' ? 'Private' : 'Public'}</p>
                <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                    <button class="btn btn-primary" onclick="editModel('${model.id}')" style="flex: 1;">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-danger" onclick="deleteModel('${model.id}')" style="flex: 1;">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            `;
            modelsList.appendChild(modelCard);
        });
    }

    // Hard-coded Front Page Models Management
    function handleHardcodedModelSubmit(e) {
        e.preventDefault();
        
        const modelData = {
            id: currentEditingHardcodedModel || 'model_' + Date.now(),
            name: document.getElementById('hardcodedModelName').value,
            image: document.getElementById('hardcodedModelImage').value,
            verified: document.getElementById('hardcodedModelVerified').value === 'true',
            likes: parseInt(document.getElementById('hardcodedModelLikes').value) || 0,
            comments: document.getElementById('hardcodedModelComments').value.split('\n').filter(c => c.trim()),
            publicPosts: document.getElementById('hardcodedModelPublicPosts').value.split('\n').filter(p => p.trim()),
            commentsCount: parseInt(document.getElementById('hardcodedModelCommentsCount').value) || 3,
            videoCallLink: document.getElementById('hardcodedVideoCallLink').value,
            embedVideo: document.getElementById('hardcodedEmbedVideo').value,
            createdAt: currentEditingHardcodedModel ? 
                hardcodedFrontpageModels.find(m => m.id === currentEditingHardcodedModel).createdAt : 
                new Date().toISOString()
        };

        try {
            if (currentEditingHardcodedModel) {
                // Update existing hardcoded model
                const index = hardcodedFrontpageModels.findIndex(m => m.id === currentEditingHardcodedModel);
                if (index !== -1) {
                    hardcodedFrontpageModels[index] = modelData;
                    toastr.success('Hard-coded model updated successfully!');
                }
                currentEditingHardcodedModel = null;
                
                // Reset button text
                const submitBtn = document.querySelector('#hardcodedModelForm button[type="submit"]');
                submitBtn.innerHTML = '<i class="fas fa-save"></i> Add Hard-coded Model';
            } else {
                // Add new hardcoded model
                hardcodedFrontpageModels.push(modelData);
                toastr.success('Hard-coded model added successfully!');
            }
            
            // Save to localStorage
            saveHardcodedModels();
            
            document.getElementById('hardcodedModelForm').reset();
            updateModelsDisplay();
            
        } catch (error) {
            console.error('Error saving hardcoded model:', error);
            toastr.error('Failed to save hardcoded model: ' + error.message);
        }
    }

    function editHardcodedModel(modelId) {
        const model = hardcodedFrontpageModels.find(m => m.id === modelId);
        if (!model) return;

        currentEditingHardcodedModel = modelId;
        
        // Populate form
        document.getElementById('hardcodedModelName').value = model.name;
        document.getElementById('hardcodedModelImage').value = model.image;
        document.getElementById('hardcodedModelVerified').value = model.verified ? 'true' : 'false';
        document.getElementById('hardcodedModelLikes').value = model.likes || 0;
        document.getElementById('hardcodedModelCommentsCount').value = model.commentsCount || 3;
        document.getElementById('hardcodedModelComments').value = model.comments ? model.comments.join('\n') : '';
        document.getElementById('hardcodedModelPublicPosts').value = model.publicPosts ? model.publicPosts.join('\n') : '';
        document.getElementById('hardcodedVideoCallLink').value = model.videoCallLink || '';
        document.getElementById('hardcodedEmbedVideo').value = model.embedVideo || '';

        // Change button text
        const submitBtn = document.querySelector('#hardcodedModelForm button[type="submit"]');
        submitBtn.innerHTML = '<i class="fas fa-save"></i> Update Hard-coded Model';
        
        toastr.info('Editing hard-coded model: ' + model.name);
    }

    function deleteHardcodedModel(modelId) {
        if (!confirm('Are you sure you want to delete this hard-coded model? This action cannot be undone.')) {
            return;
        }

        try {
            // Remove from array
            hardcodedFrontpageModels = hardcodedFrontpageModels.filter(m => m.id !== modelId);
            
            // Save to localStorage
            saveHardcodedModels();
            
            toastr.success('Hard-coded model deleted successfully!');
            updateModelsDisplay();
        } catch (error) {
            console.error('Error deleting hard-coded model:', error);
            toastr.error('Failed to delete hard-coded model');
        }
    }

    function updateHardcodedModelsList() {
        const hardcodedModelsList = document.getElementById('hardcodedModelsList');
        hardcodedModelsList.innerHTML = '';

        hardcodedFrontpageModels.forEach(model => {
            const modelCard = document.createElement('div');
            modelCard.className = 'card';
            modelCard.innerHTML = `
                <img src="${model.image}" alt="${model.name}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;">
                <h4>${model.name} ${model.verified ? '<i class="fas fa-check-circle verified"></i>' : ''}</h4>
                <p><strong>Likes:</strong> ${model.likes || 0}</p>
                <p><strong>Comments:</strong> ${model.comments ? model.comments.length : 0}</p>
                <p><strong>Public Posts:</strong> ${model.publicPosts ? model.publicPosts.length : 0}</p>
                <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                    <button class="btn btn-primary" onclick="editHardcodedModel('${model.id}')" style="flex: 1;">
                        <i class="fas fa-edit"></i> Edit
                    </button>
                    <button class="btn btn-danger" onclick="deleteHardcodedModel('${model.id}')" style="flex: 1;">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                </div>
            `;
            hardcodedModelsList.appendChild(modelCard);
        });
    }

    // Session Management
    async function loadSessionsList() {
        try {
            const snapshot = await bookingsRef.orderBy('createdAt', 'desc').get();
            const sessionsList = document.getElementById('sessionsList');
            sessionsList.innerHTML = '';

            if (snapshot.empty) {
                sessionsList.innerHTML = '<p>No session requests found.</p>';
                return;
            }

            snapshot.forEach(doc => {
                const session = { id: doc.id, ...doc.data() };
                const sessionCard = document.createElement('div');
                sessionCard.className = 'session-card';
                
                const statusClass = `status-${session.status}`;
                const formattedDate = session.callDateTime ? 
                    new Date(session.callDateTime).toLocaleString() : 'Not specified';
                
                sessionCard.innerHTML = `
                    <div class="session-header">
                        <h4>${session.modelName}</h4>
                        <span class="session-status ${statusClass}">${session.status.toUpperCase()}</span>
                    </div>
                    <p><strong>Client:</strong> ${session.userEmail}</p>
                    <p><strong>Requested Time:</strong> ${formattedDate}</p>
                    ${session.specialRequests ? `<p><strong>Special Requests:</strong> ${session.specialRequests}</p>` : ''}
                    <p><strong>Submitted:</strong> ${session.createdAt ? new Date(session.createdAt.toDate()).toLocaleString() : 'N/A'}</p>
                    <div class="session-actions">
                        ${session.status === 'pending' ? `
                            <button class="btn btn-success btn-sm" onclick="updateSessionStatus('${session.id}', 'confirmed')">
                                <i class="fas fa-check"></i> Confirm
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="updateSessionStatus('${session.id}', 'cancelled')">
                                <i class="fas fa-times"></i> Deny
                            </button>
                        ` : ''}
                        ${session.status === 'confirmed' ? `
                            <button class="btn btn-warning btn-sm" onclick="updateSessionStatus('${session.id}', 'pending')">
                                <i class="fas fa-clock"></i> Mark Pending
                            </button>
                            <button class="btn btn-danger btn-sm" onclick="updateSessionStatus('${session.id}', 'cancelled')">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        ` : ''}
                        ${session.status === 'cancelled' ? `
                            <button class="btn btn-success btn-sm" onclick="updateSessionStatus('${session.id}', 'confirmed')">
                                <i class="fas fa-check"></i> Confirm
                            </button>
                            <button class="btn btn-warning btn-sm" onclick="updateSessionStatus('${session.id}', 'pending')">
                                <i class="fas fa-clock"></i> Mark Pending
                            </button>
                        ` : ''}
                        <button class="btn btn-danger btn-sm" onclick="deleteSession('${session.id}')">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                sessionsList.appendChild(sessionCard);
            });
        } catch (error) {
            console.error('Error loading sessions:', error);
            toastr.error('Failed to load session requests');
        }
    }

    async function updateSessionStatus(sessionId, status) {
        try {
            await bookingsRef.doc(sessionId).update({
                status: status,
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            
            toastr.success(`Session ${status} successfully!`);
            await loadSessionsList();
        } catch (error) {
            console.error('Error updating session:', error);
            toastr.error('Failed to update session');
        }
    }

    async function deleteSession(sessionId) {
        if (!confirm('Are you sure you want to delete this session request?')) {
            return;
        }

        try {
            await bookingsRef.doc(sessionId).delete();
            toastr.success('Session request deleted successfully!');
            await loadSessionsList();
        } catch (error) {
            console.error('Error deleting session:', error);
            toastr.error('Failed to delete session request');
        }
    }

    // User Management
    async function handleUserCreate(e) {
        e.preventDefault();
        
        const email = document.getElementById('userEmail').value;
        const password = document.getElementById('userPassword').value;

        try {
            // Create user in Firebase Auth
            const userCredential = await auth.createUserWithEmailAndPassword(email, password);
            const user = userCredential.user;

            // Create user document
            const expiresAt = new Date();
            expiresAt.setMonth(expiresAt.getMonth() + 1);

            await usersRef.doc(user.uid).set({
                email: email,
                role: 'user',
                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                expiresAt: expiresAt,
                isActive: true,
                createdBy: adminUser.uid
            });

            toastr.success(`User created successfully! Login details sent to ${email}`);
            document.getElementById('userForm').reset();
            await loadUsersList();

            // Sign out the created user (admin should remain logged in)
            await auth.signOut();
            await auth.signInWithEmailAndPassword(adminUser.email, document.getElementById('adminPassword').value);

        } catch (error) {
            console.error('Error creating user:', error);
            toastr.error('Failed to create user: ' + error.message);
        }
    }

    async function loadUsersList() {
        try {
            const snapshot = await usersRef.where('role', '==', 'user').get();
            const usersList = document.getElementById('usersList');
            usersList.innerHTML = '';

            snapshot.forEach(doc => {
                const user = { id: doc.id, ...doc.data() };
                const userDiv = document.createElement('div');
                userDiv.className = 'card';
                
                const isExpired = user.expiresAt && new Date() > user.expiresAt.toDate();
                const statusClass = isExpired ? 'expired' : '';
                
                userDiv.innerHTML = `
                    <h4>${user.email}</h4>
                    <p><strong>Created:</strong> ${user.createdAt ? new Date(user.createdAt.toDate()).toLocaleDateString() : 'N/A'}</p>
                    <p><strong>Expires:</strong> <span class="${statusClass}">${user.expiresAt ? new Date(user.expiresAt.toDate()).toLocaleDateString() : 'N/A'}</span></p>
                    <p><strong>Status:</strong> ${user.isActive ? 'Active' : 'Banned'}</p>
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                        <button class="btn btn-danger" onclick="banUser('${user.id}')" style="flex: 1;" ${!user.isActive ? 'disabled' : ''}>
                            <i class="fas fa-ban"></i> ${user.isActive ? 'Ban' : 'Banned'}
                        </button>
                        <button class="btn btn-success" onclick="renewUser('${user.id}')" style="flex: 1;">
                            <i class="fas fa-sync-alt"></i> Renew
                        </button>
                    </div>
                `;
                usersList.appendChild(userDiv);
            });
        } catch (error) {
            console.error('Error loading users:', error);
            toastr.error('Failed to load users');
        }
    }

    async function banUser(userId) {
        if (!confirm('Are you sure you want to ban this user?')) {
            return;
        }

        try {
            await usersRef.doc(userId).update({ 
                isActive: false,
                bannedAt: firebase.firestore.FieldValue.serverTimestamp()
            });
            toastr.success('User banned successfully!');
            await loadUsersList();
        } catch (error) {
            console.error('Error banning user:', error);
            toastr.error('Failed to ban user');
        }
    }

    async function renewUser(userId) {
        const expiresAt = new Date();
        expiresAt.setMonth(expiresAt.getMonth() + 1);

        try {
            await usersRef.doc(userId).update({ 
                expiresAt: expiresAt,
                isActive: true
            });
            toastr.success('User subscription renewed for 1 month!');
            await loadUsersList();
        } catch (error) {
            console.error('Error renewing user:', error);
            toastr.error('Failed to renew user subscription');
        }
    }

    // Content Settings
    async function updateContentSettings() {
        try {
            await settingsRef.set({
                backgroundImage: document.getElementById('backgroundImage').value,
                subscriptionImage: document.getElementById('subscriptionImage').value,
                subscriptionLink: document.getElementById('subscriptionLink').value,
                renewalImage: document.getElementById('renewalImage').value,
                renewalLink: document.getElementById('renewalLink').value
            }, { merge: true });

            await loadWebsiteSettings();
            toastr.success('Content settings updated successfully!');
        } catch (error) {
            console.error('Error updating content settings:', error);
            toastr.error('Failed to update content settings');
        }
    }

    // Posts Management
    async function handlePostSubmit(e) {
        e.preventDefault();
        
        const postData = {
            title: document.getElementById('postTitle').value,
            content: document.getElementById('postContent').value,
            buttonText: document.getElementById('postButtonText').value,
            buttonLink: document.getElementById('postButtonLink').value,
            createdAt: firebase.firestore.FieldValue.serverTimestamp(),
            createdBy: adminUser.uid
        };

        try {
            await postsRef.add(postData);
            toastr.success('Post broadcasted to all users!');
            document.getElementById('postForm').reset();
            await loadPostsList();
        } catch (error) {
            console.error('Error broadcasting post:', error);
            toastr.error('Failed to broadcast post');
        }
    }

    async function loadPostsList() {
        try {
            const snapshot = await postsRef.orderBy('createdAt', 'desc').limit(10).get();
            const postsList = document.getElementById('postsList');
            postsList.innerHTML = '';

            snapshot.forEach(doc => {
                const post = { id: doc.id, ...doc.data() };
                const postDiv = document.createElement('div');
                postDiv.className = 'card';
                postDiv.innerHTML = `
                    <h4>${post.title}</h4>
                    <p>${post.content}</p>
                    ${post.buttonText && post.buttonLink ? `
                        <p><strong>Button:</strong> ${post.buttonText} → ${post.buttonLink}</p>
                    ` : ''}
                    <p><small>Posted: ${post.createdAt ? new Date(post.createdAt.toDate()).toLocaleString() : 'N/A'}</small></p>
                    <button class="btn btn-danger" onclick="deletePost('${post.id}')" style="margin-top: 1rem;">
                        <i class="fas fa-trash"></i> Delete
                    </button>
                `;
                postsList.appendChild(postDiv);
            });
        } catch (error) {
            console.error('Error loading posts:', error);
        }
    }

    async function deletePost(postId) {
        if (!confirm('Are you sure you want to delete this post?')) {
            return;
        }

        try {
            await postsRef.doc(postId).delete();
            toastr.success('Post deleted successfully!');
            await loadPostsList();
        } catch (error) {
            console.error('Error deleting post:', error);
            toastr.error('Failed to delete post');
        }
    }

    // Website Settings
    async function updateWebsiteSettings() {
        try {
            await settingsRef.set({
                websiteTitle: document.getElementById('websiteTitle').value,
                welcomeMessage: document.getElementById('welcomeMessage').value,
                primaryColor: document.getElementById('primaryColor').value,
                secondaryColor: document.getElementById('secondaryColor').value
            }, { merge: true });

            await loadWebsiteSettings();
            toastr.success('Website settings updated successfully!');
        } catch (error) {
            console.error('Error updating website settings:', error);
            toastr.error('Failed to update website settings');
        }
    }

    // Admin Stories Management
    async function loadAdminStories() {
        try {
            const snapshot = await storiesRef.orderBy('createdAt', 'desc').get();
            const storiesList = document.getElementById('storiesList');
            storiesList.innerHTML = '';

            // Populate model dropdown
            const storyModelSelect = document.getElementById('storyModel');
            storyModelSelect.innerHTML = '<option value="">Select a model</option>';
            
            allModels.forEach(model => {
                const option = document.createElement('option');
                option.value = model.id;
                option.textContent = model.name;
                storyModelSelect.appendChild(option);
            });

            hardcodedFrontpageModels.forEach(model => {
                const option = document.createElement('option');
                option.value = model.id;
                option.textContent = model.name + ' (Hard-coded)';
                storyModelSelect.appendChild(option);
            });

            if (snapshot.empty) {
                storiesList.innerHTML = '<p>No active stories.</p>';
                return;
            }

            snapshot.forEach(doc => {
                const story = { id: doc.id, ...doc.data() };
                const model = allModels.find(m => m.id === story.modelId) || 
                             hardcodedFrontpageModels.find(m => m.id === story.modelId);
                
                const storyCard = document.createElement('div');
                storyCard.className = 'card';
                storyCard.innerHTML = `
                    <img src="${story.mediaUrl}" alt="Story" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;">
                    <h4>${model ? model.name : 'Unknown Model'}</h4>
                    <p><strong>Active:</strong> ${story.active ? 'Yes' : 'No'}</p>
                    <p><strong>Button:</strong> ${story.buttonText || 'None'}</p>
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="editStory('${story.id}')" style="flex: 1;">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-danger" onclick="deleteStory('${story.id}')" style="flex: 1;">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                storiesList.appendChild(storyCard);
            });
        } catch (error) {
            console.error('Error loading admin stories:', error);
        }
    }

    async function handleStorySubmit(e) {
        e.preventDefault();
        
        const storyData = {
            modelId: document.getElementById('storyModel').value,
            mediaUrl: document.getElementById('storyMedia').value,
            buttonLink: document.getElementById('storyButtonLink').value,
            buttonText: document.getElementById('storyButtonText').value,
            active: true,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        };

        try {
            await storiesRef.add(storyData);
            toastr.success('Story added successfully!');
            document.getElementById('storyForm').reset();
            await loadAdminStories();
            await loadStories();
        } catch (error) {
            console.error('Error adding story:', error);
            toastr.error('Failed to add story');
        }
    }

    async function deleteStory(storyId) {
        if (!confirm('Are you sure you want to delete this story?')) {
            return;
        }

        try {
            await storiesRef.doc(storyId).delete();
            toastr.success('Story deleted successfully!');
            await loadAdminStories();
            await loadStories();
        } catch (error) {
            console.error('Error deleting story:', error);
            toastr.error('Failed to delete story');
        }
    }

    // Admin Reels Management
    async function loadAdminReels() {
        try {
            const snapshot = await reelsRef.orderBy('createdAt', 'desc').get();
            const reelsList = document.getElementById('reelsList');
            reelsList.innerHTML = '';

            // Populate model dropdown
            const reelModelSelect = document.getElementById('reelModel');
            reelModelSelect.innerHTML = '<option value="">Select a model</option>';
            
            allModels.forEach(model => {
                const option = document.createElement('option');
                option.value = model.id;
                option.textContent = model.name;
                reelModelSelect.appendChild(option);
            });

            hardcodedFrontpageModels.forEach(model => {
                const option = document.createElement('option');
                option.value = model.id;
                option.textContent = model.name + ' (Hard-coded)';
                reelModelSelect.appendChild(option);
            });

            if (snapshot.empty) {
                reelsList.innerHTML = '<p>No reels available.</p>';
                return;
            }

            snapshot.forEach(doc => {
                const reel = { id: doc.id, ...doc.data() };
                const model = allModels.find(m => m.id === reel.modelId) || 
                             hardcodedFrontpageModels.find(m => m.id === reel.modelId);
                
                const reelCard = document.createElement('div');
                reelCard.className = 'card';
                reelCard.innerHTML = `
                    <video src="${reel.videoUrl}" style="width: 100%; height: 200px; object-fit: cover; border-radius: 8px; margin-bottom: 1rem;" controls></video>
                    <h4>${model ? model.name : 'Unknown Model'}</h4>
                    <p><strong>Caption:</strong> ${reel.caption || 'None'}</p>
                    <p><strong>Price:</strong> ${reel.price || 0} credits</p>
                    <p><strong>Likes:</strong> ${reel.likes || 0}</p>
                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                        <button class="btn btn-primary" onclick="editReel('${reel.id}')" style="flex: 1;">
                            <i class="fas fa-edit"></i> Edit
                        </button>
                        <button class="btn btn-danger" onclick="deleteReel('${reel.id}')" style="flex: 1;">
                            <i class="fas fa-trash"></i> Delete
                        </button>
                    </div>
                `;
                reelsList.appendChild(reelCard);
            });
        } catch (error) {
            console.error('Error loading admin reels:', error);
        }
    }

    async function handleReelSubmit(e) {
        e.preventDefault();
        
        const reelData = {
            modelId: document.getElementById('reelModel').value,
            videoUrl: document.getElementById('reelVideo').value,
            caption: document.getElementById('reelCaption').value,
            price: parseInt(document.getElementById('reelPrice').value) || 0,
            likes: parseInt(document.getElementById('reelLikes').value) || 0,
            createdAt: firebase.firestore.FieldValue.serverTimestamp()
        };

        try {
            await reelsRef.add(reelData);
            toastr.success('Reel added successfully!');
            document.getElementById('reelForm').reset();
            await loadAdminReels();
            await loadReels();
        } catch (error) {
            console.error('Error adding reel:', error);
            toastr.error('Failed to add reel');
        }
    }

    async function deleteReel(reelId) {
        if (!confirm('Are you sure you want to delete this reel?')) {
            return;
        }

        try {
            await reelsRef.doc(reelId).delete();
            toastr.success('Reel deleted successfully!');
            await loadAdminReels();
            await loadReels();
        } catch (error) {
            console.error('Error deleting reel:', error);
            toastr.error('Failed to delete reel');
        }
    }

    // Wallet Settings
    async function updateWalletSettings() {
        try {
            await settingsRef.set({
                addFundsLink: document.getElementById('addFundsLink').value,
                withdrawFundsLink: document.getElementById('withdrawFundsLink').value,
                minWithdrawal: parseInt(document.getElementById('minWithdrawal').value) || 10
            }, { merge: true });

            toastr.success('Wallet settings updated successfully!');
        } catch (error) {
            console.error('Error updating wallet settings:', error);
            toastr.error('Failed to update wallet settings');
        }
    }

    // User Interface Functions
    function showUserInterface() {
        document.getElementById('userInfo').style.display = 'block';
        updateUserInfo();
        
        // Hide hero section when logged in
        document.getElementById('home').style.display = 'none';
        
        // Show stories and enable page navigation
        loadStories();
        document.getElementById('swipeIndicator').style.display = 'flex';
    }

    function hideUserInterface() {
        document.getElementById('userInfo').style.display = 'none';
        
        // Show hero section when logged out
        document.getElementById('home').style.display = 'block';
        
        // Hide stories and disable page navigation
        document.getElementById('storiesContainer').style.display = 'none';
        document.getElementById('swipeIndicator').style.display = 'none';
    }

    function updateUserInfo() {
        if (currentUser) {
            document.getElementById('accountCreated').textContent = 
                currentUser.createdAt ? new Date(currentUser.createdAt.toDate()).toLocaleDateString() : 'N/A';
            document.getElementById('accountExpires').textContent = 
                currentUser.expiresAt ? new Date(currentUser.expiresAt.toDate()).toLocaleDateString() : 'N/A';
            startAccountTimer();
        }
    }

    function startAccountTimer() {
        function updateTimer() {
            if (!currentUser || !currentUser.expiresAt) return;
            
            const now = new Date();
            const expires = currentUser.expiresAt.toDate();
            const diff = expires - now;

            const timerElement = document.getElementById('accountTimer');
            
            if (diff <= 0) {
                timerElement.textContent = 'SUBSCRIPTION EXPIRED';
                timerElement.className = 'account-timer expired';
                openModal('renewalModal');
                return;
            }

            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);

            timerElement.textContent = 
                `${days}d ${hours}h ${minutes}m ${seconds}s remaining`;
            timerElement.className = 'account-timer';
        }

        updateTimer();
        setInterval(updateTimer, 1000);
    }

    function checkAccountExpiry() {
        if (!currentUser || !currentUser.expiresAt) return;
        
        const now = new Date();
        const expires = currentUser.expiresAt.toDate();

        if (now > expires) {
            openModal('renewalModal');
        }
    }

    function renewAccount() {
        toastr.info('Redirecting to renewal page...');
        redirectToRenewal();
    }

    // Enhanced Modal Functions
    function openModal(modalId) {
        document.getElementById(modalId).style.display = 'block';
        document.body.style.overflow = 'hidden';
        
        // Set modal images if available
        if (modalId === 'subscriptionModal' && websiteSettings.subscriptionImage) {
            document.getElementById('subscriptionModalImage').src = websiteSettings.subscriptionImage;
        }
        if (modalId === 'renewalModal' && websiteSettings.renewalImage) {
            document.getElementById('renewalModalImage').src = websiteSettings.renewalImage;
        }
    }

    function closeModal(modalId) {
        document.getElementById(modalId).style.display = 'none';
        document.body.style.overflow = 'auto';
    }

    function openLoginModal() {
        openModal('userLoginModal');
    }

    async function userLogin() {
        const email = document.getElementById('loginEmail').value;
        const password = document.getElementById('loginPassword').value;

        try {
            await auth.signInWithEmailAndPassword(email, password);
            closeModal('userLoginModal');
            // Auto-refresh after successful login
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        } catch (error) {
            console.error('Login error:', error);
            toastr.error('Login failed: ' + error.message);
        }
    }

    // Update Auth Buttons
    function updateAuthButtons() {
        const authButtons = document.getElementById('authButtons');
        
        if (currentUser || adminUser) {
            // User is logged in (either regular user or admin) - show logout button
            authButtons.innerHTML = `
                <button class="btn btn-outline" onclick="toggleSidebar()" style="margin-right: 0.5rem;">
                    <i class="fas fa-bars"></i>
                </button>
                <button class="btn btn-danger" onclick="logout()">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </button>
            `;
        } else {
            // User is not logged in - show login button
            authButtons.innerHTML = `
                <button class="btn btn-outline" onclick="openLoginModal()">
                    <i class="fas fa-user"></i> Login
                </button>
            `;
        }
    }

    function redirectToSubscribe() {
        if (websiteSettings.subscriptionLink) {
            window.location.href = websiteSettings.subscriptionLink;
        } else {
            toastr.error('Subscription link not configured');
        }
    }

    function redirectToHardcodedSubscribe() {
        window.location.href = 'subscription1.html';
    }

    function redirectToRenewal() {
        if (websiteSettings.renewalLink) {
            window.location.href = websiteSettings.renewalLink;
        } else {
            toastr.error('Renewal link not configured');
        }
    }

    // Utility Functions
    async function logout() {
        try {
            await auth.signOut();
            toastr.info('Logged out successfully');
            // Auto-refresh after logout
            setTimeout(() => {
                window.location.reload();
            }, 1000);
        } catch (error) {
            console.error('Logout error:', error);
        }
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
        const modals = document.getElementsByClassName('modal');
        for (let modal of modals) {
            if (event.target === modal) {
                closeModal(modal.id);
            }
        }
        
        // Close story when clicking outside
        if (event.target === document.getElementById('storyExpanded')) {
            closeStory();
        }
        
        // Close sidebar when clicking outside (on mobile)
        if (window.innerWidth <= 768 && event.target === document.getElementById('sidebar')) {
            toggleSidebar();
        }
    }

    // Handle escape key to close modals
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            const modals = document.getElementsByClassName('modal');
            for (let modal of modals) {
                if (modal.style.display === 'block') {
                    closeModal(modal.id);
                }
            }
            
            // Close story with escape key
            if (document.getElementById('storyExpanded').style.display === 'block') {
                closeStory();
            }
            
            // Close sidebar with escape key
            if (document.getElementById('sidebar').classList.contains('active')) {
                toggleSidebar();
            }
        }
    });

    // Prevent content download
    document.addEventListener('contextmenu', function(e) {
        if (e.target.tagName === 'IMG' || e.target.tagName === 'VIDEO') {
            e.preventDefault();
            toastr.info('Content downloading is disabled');
        }
    });

    // Initialize UI with enhanced effects
    function initializeUI() {
        console.log('Camsilo website initialized successfully with dynamic models display');
    }

    // Call initialization
    initializeUI();
</script>
<script>
    // Missing integration functions

    async function initializeWebsite() {
        await loadWebsiteSettings();
        await loadModels();
        checkAuthState();
        setupEventListeners();
        updateAuthButtons();
        initializePageNavigation();
    }

    function setupEventListeners() {
        // Form submissions
        document.getElementById('modelForm').addEventListener('submit', handleModelSubmit);
        document.getElementById('hardcodedModelForm').addEventListener('submit', handleHardcodedModelSubmit);
        document.getElementById('userForm').addEventListener('submit', handleUserCreate);
        document.getElementById('postForm').addEventListener('submit', handlePostSubmit);
        document.getElementById('storyForm').addEventListener('submit', handleStorySubmit);
        document.getElementById('reelForm').addEventListener('submit', handleReelSubmit);
        
        // Wallet forms
        document.getElementById('addFundsModal').addEventListener('submit', function(e) {
            e.preventDefault();
            processPayment();
        });
    }

    async function loadWebsiteSettings() {
        try {
            const settingsDoc = await settingsRef.get();
            if (settingsDoc.exists) {
                websiteSettings = settingsDoc.data();
                applyWebsiteSettings();
            } else {
                // Initialize default settings
                websiteSettings = {
                    websiteTitle: 'Camsilo',
                    welcomeMessage: 'Experience the ultimate in adult entertainment with our exclusive models. Premium content, private shows, and unforgettable experiences.',
                    primaryColor: '#e91e63',
                    secondaryColor: '#9c27b0',
                    backgroundImage: 'https://images.unsplash.com/photo-1511285605577-4d62fb50d2f7?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80',
                    subscriptionImage: 'https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                    subscriptionLink: 'https://payment.example.com/subscribe',
                    renewalImage: 'https://images.unsplash.com/photo-1519699047748-de8e457a634e?ixlib=rb-4.0.3&auto=format&fit=crop&w=500&q=80',
                    renewalLink: 'https://payment.example.com/renew',
                    addFundsLink: 'https://payment.example.com/add-funds',
                    withdrawFundsLink: 'https://payment.example.com/withdraw',
                    minWithdrawal: 10
                };
                await settingsRef.set(websiteSettings);
            }
        } catch (error) {
            console.error('Error loading settings:', error);
            toastr.error('Failed to load website settings');
        }
    }

    function applyWebsiteSettings() {
        if (websiteSettings.websiteTitle) {
            document.title = websiteSettings.websiteTitle;
            document.querySelector('.logo').textContent = websiteSettings.websiteTitle;
        }
        if (websiteSettings.welcomeMessage) {
            const heroP = document.querySelector('.hero p');
            if (heroP) heroP.textContent = websiteSettings.welcomeMessage;
        }
        if (websiteSettings.backgroundImage) {
            document.querySelector('.hero').style.backgroundImage = `url(${websiteSettings.backgroundImage})`;
        }
        if (websiteSettings.primaryColor) {
            document.documentElement.style.setProperty('--primary', websiteSettings.primaryColor);
        }
        if (websiteSettings.secondaryColor) {
            document.documentElement.style.setProperty('--secondary', websiteSettings.secondaryColor);
        }
    }

    // Load Models from Firebase
    async function loadModels() {
        try {
            const snapshot = await modelsRef.orderBy('createdAt', 'desc').get();
            allModels = [];
            
            snapshot.forEach(doc => {
                const model = { id: doc.id, ...doc.data() };
                allModels.push(model);
            });

            // Update admin models list
            if (adminUser) {
                updateAdminModelsList();
            }

        } catch (error) {
            console.error('Error loading models:', error);
            toastr.error('Failed to load models');
        }
    }

    // Load all models for models page
    async function loadAllModels() {
        const allModelsGrid = document.getElementById('allModelsGrid');
        allModelsGrid.innerHTML = '';

        let cardIndex = 0;
        allModels.forEach(model => {
            const modelCard = createModelCard(model);
            modelCard.style.setProperty('--card-index', cardIndex);
            cardIndex++;
            allModelsGrid.appendChild(modelCard);
        });

        if (allModels.length === 0) {
            allModelsGrid.innerHTML = '<p style="text-align: center; padding: 2rem; grid-column: 1 / -1;">No models available yet.</p>';
        }
    }

    // Enhanced Authentication State Listener
    function checkAuthState() {
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                const userDoc = await usersRef.doc(user.uid).get();
                if (userDoc.exists) {
                    const userData = userDoc.data();
                    if (userData.role === 'admin') {
                        adminUser = { uid: user.uid, ...userData };
                        showAdminPanel();
                        updateModelsDisplay();
                        toastr.success('Welcome back, Admin!');
                    } else {
                        currentUser = { uid: user.uid, ...userData };
                        showUserInterface();
                        checkAccountExpiry();
                        updateModelsDisplay();
                        toastr.success('Welcome back!');
                    }
                } else {
                    await auth.signOut();
                }
                updateAuthButtons();
                await loadModels();
            } else {
                currentUser = null;
                adminUser = null;
                updateAuthButtons();
                hideAdminPanel();
                hideUserInterface();
                updateModelsDisplay();
                await loadModels();
            }
        });
    }

    function initializePageNavigation() {
        // Set initial page
        switchPage(0);
        
        // Add keyboard navigation
        document.addEventListener('keydown', function(e) {
            if (e.key === 'ArrowLeft') {
                previousPage();
            } else if (e.key === 'ArrowRight') {
                nextPage();
            }
        });
    }

    // Open admin panel from sidebar
    function openAdminPanel() {
        if (!adminUser) {
            openAdminLogin();
            return;
        }
        showAdminPanel();
        switchPage(0); // Return to home page
    }

    // Enhanced model profile with posts
    function createModelProfilePage(model) {
        // This would be called when navigating to a model's profile
        // For demo purposes, we'll show a toast
        toastr.info(`Opening ${model.name}'s profile...`);
        
        // In a full implementation, this would:
        // 1. Load the model's detailed profile from Firebase
        // 2. Load the model's posts
        // 3. Display followers count and other stats
        // 4. Show locked/unlocked posts based on user permissions
    }

    // Enhanced post display with locking
    function createPostElement(post, model, isLocked = false) {
        const postElement = document.createElement('div');
        postElement.className = 'profile-post';
        
        if (isLocked) {
            postElement.innerHTML = `
                <div class="post-media-container" style="position: relative;">
                    <img src="${post.mediaUrl}" alt="Post" class="post-media post-locked no-download">
                    <div class="post-lock-overlay">
                        <i class="fas fa-lock" style="font-size: 2rem;"></i>
                        <p>Unlock this content for ${post.price} credits</p>
                        <button class="btn btn-primary" onclick="unlockPost('${post.id}', ${post.price})">
                            <i class="fas fa-unlock"></i> Unlock Content
                        </button>
                    </div>
                </div>
                <div class="post-content">
                    <p class="post-caption">${post.caption}</p>
                    <div class="post-stats">
                        <div class="likes">
                            <button class="like-btn">
                                <i class="fas fa-heart"></i>
                            </button>
                            <span>${post.likes || 0}</span>
                        </div>
                        <div class="comments">
                            <button class="comment-btn">
                                <i class="fas fa-comment"></i>
                            </button>
                            <span>${post.comments ? post.comments.length : 0}</span>
                        </div>
                    </div>
                </div>
            `;
        } else {
            postElement.innerHTML = `
                <img src="${post.mediaUrl}" alt="Post" class="post-media no-download">
                <div class="post-content">
                    <p class="post-caption">${post.caption}</p>
                    <div class="post-stats">
                        <div class="likes">
                            <button class="like-btn" onclick="likePost('${post.id}')">
                                <i class="fas fa-heart"></i>
                            </button>
                            <span>${post.likes || 0}</span>
                        </div>
                        <div class="comments">
                            <button class="comment-btn" onclick="openPostCommentModal('${post.id}')">
                                <i class="fas fa-comment"></i>
                            </button>
                            <span>${post.comments ? post.comments.length : 0}</span>
                        </div>
                    </div>
                </div>
            `;
        }
        
        return postElement;
    }

    // Post interaction functions
    async function likePost(postId) {
        if (!validateSubscription()) return;
        
        try {
            // Update post likes in Firebase
            // This would be implemented based on your post structure
            toastr.success('Liked post! ❤️');
        } catch (error) {
            console.error('Error liking post:', error);
            toastr.error('Failed to like post');
        }
    }

    function openPostCommentModal(postId) {
        if (!validateSubscription()) return;
        
        // Implementation for post comments
        toastr.info('Comment feature coming soon!');
    }

    // Withdraw funds function
    function openWithdrawModal() {
        if (!validateSubscription()) return;
        
        if (userWallet.balance < (websiteSettings.minWithdrawal || 10)) {
            toastr.error(`Minimum withdrawal amount is $${websiteSettings.minWithdrawal || 10}`);
            return;
        }
        
        // In a real app, this would open a withdrawal modal
        toastr.info('Withdrawal feature coming soon!');
    }

    function openTransactionHistory() {
        // Already implemented in wallet display
        toastr.info('Transaction history loaded');
    }

    // Admin edit functions for stories and reels
    function editStory(storyId) {
        // Implementation for editing stories
        toastr.info('Edit story feature coming soon!');
    }

    function editReel(reelId) {
        // Implementation for editing reels
        toastr.info('Edit reel feature coming soon!');
    }

    // Video reel swipe functionality
    function setupReelSwipe() {
        const reelContainer = document.getElementById('reelContainer');
        let startY = 0;
        
        reelContainer.addEventListener('touchstart', function(e) {
            startY = e.touches[0].clientY;
        });
        
        reelContainer.addEventListener('touchend', function(e) {
            if (!startY) return;
            
            const endY = e.changedTouches[0].clientY;
            const diffY = startY - endY;
            
            // Minimum swipe distance
            if (Math.abs(diffY) > 50) {
                if (diffY > 0) {
                    // Swipe up - next reel
                    nextReel();
                } else {
                    // Swipe down - previous reel
                    previousReel();
                }
            }
            
            startY = 0;
        });
    }

    // Initialize reel swipe when reels are loaded
    function loadCurrentReel() {
        if (reels.length === 0) return;
        
        const reel = reels[currentReelIndex];
        const model = allModels.find(m => m.id === reel.modelId) || 
                     hardcodedFrontpageModels.find(m => m.id === reel.modelId);
        
        if (model) {
            const reelContainer = document.getElementById('reelContainer');
            reelContainer.innerHTML = `
                <video src="${reel.videoUrl}" class="reel-video" autoplay muted loop controlsList="nodownload" oncontextmenu="return false;"></video>
            `;
            
            document.getElementById('reelModelAvatar').src = model.image;
            document.getElementById('reelModelName').textContent = model.name;
            document.getElementById('reelModelCaption').textContent = reel.caption;
            document.getElementById('reelLikes').textContent = reel.likes || 0;
            
            // Prevent video download
            const video = reelContainer.querySelector('video');
            video.addEventListener('contextmenu', (e) => e.preventDefault());
            
            // Setup swipe for next/previous
            setupReelSwipe();
        }
    }

    // Final initialization
    document.addEventListener('DOMContentLoaded', function() {
        initializeWebsite();
        setupScrollEffects();
        initializeHardcodedModels();
        setupSwipeNavigation();
        loadStories();
        loadReels();
        loadUserWallet();
        
        // Add context menu prevention for all media
        document.addEventListener('contextmenu', function(e) {
            if (e.target.tagName === 'IMG' || e.target.tagName === 'VIDEO') {
                e.preventDefault();
                return false;
            }
        });
        
        // Prevent drag-and-drop download
        document.addEventListener('dragstart', function(e) {
            if (e.target.tagName === 'IMG' || e.target.tagName === 'VIDEO') {
                e.preventDefault();
                return false;
            }
        });
    });

    // Export functions to global scope for HTML onclick handlers
    window.openLoginModal = openLoginModal;
    window.openModelsGallery = openModelsGallery;
    window.renewAccount = renewAccount;
    window.openVideoCallModal = openVideoCallModal;
    window.bookVideoCall = bookVideoCall;
    window.adminLogin = adminLogin;
    window.adminLogout = adminLogout;
    window.switchAdminTab = switchAdminTab;
    window.openCommentModal = openCommentModal;
    window.submitComment = submitComment;
    window.openAdminCommentModal = openAdminCommentModal;
    window.submitAdminComment = submitAdminComment;
    window.openPublicPostsModal = openPublicPostsModal;
    window.openChatPage = openChatPage;
    window.handleLike = handleLike;
    window.boostLikes = boostLikes;
    window.boostHardcodedLikes = boostHardcodedLikes;
    window.openAdminHardcodedCommentModal = openAdminHardcodedCommentModal;
    window.submitAdminHardcodedComment = submitAdminHardcodedComment;
    window.deleteHardcodedModel = deleteHardcodedModel;
    window.editModel = editModel;
    window.deleteModel = deleteModel;
    window.editHardcodedModel = editHardcodedModel;
    window.updateSessionStatus = updateSessionStatus;
    window.deleteSession = deleteSession;
    window.banUser = banUser;
    window.renewUser = renewUser;
    window.updateContentSettings = updateContentSettings;
    window.deletePost = deletePost;
    window.updateWebsiteSettings = updateWebsiteSettings;
    window.updateWalletSettings = updateWalletSettings;
    window.logout = logout;
    window.userLogin = userLogin;
    window.openAdminLogin = openAdminLogin;
    window.closeModal = closeModal;
    window.redirectToHardcodedSubscribe = redirectToHardcodedSubscribe;
    window.redirectToRenewal = redirectToRenewal;
    window.handleHardcodedModelInteraction = handleHardcodedModelInteraction;
    window.toggleSidebar = toggleSidebar;
    window.switchPage = switchPage;
    window.openStory = openStory;
    window.closeStory = closeStory;
    window.viewModelProfileFromStory = viewModelProfileFromStory;
    window.sendTipToModel = sendTipToModel;
    window.nextReel = nextReel;
    window.previousReel = previousReel;
    window.likeReel = likeReel;
    window.tipReelModel = tipReelModel;
    window.viewReelModelProfile = viewReelModelProfile;
    window.openAddFundsModal = openAddFundsModal;
    window.processPayment = processPayment;
    window.openWithdrawModal = openWithdrawModal;
    window.openTransactionHistory = openTransactionHistory;
    window.editProfile = editProfile;
    window.saveProfile = saveProfile;
    window.unlockPost = unlockPost;
    window.processUnlock = processUnlock;
    window.openAdminPanel = openAdminPanel;
</script>
</body>
</html>
