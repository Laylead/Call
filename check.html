<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luxuria Casino | Premium Gaming Experience</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;500;600;700&family=Montserrat:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
    <style>
        /* Premium Casino Design */
        :root {
            --gold-primary: #d4af37;
            --gold-secondary: #c5a028;
            --gold-accent: #f1c40f;
            --dark-bg: #0c0b0b;
            --darker-bg: #080808;
            --card-bg: rgba(30, 28, 24, 0.7);
            --card-border: rgba(212, 175, 55, 0.2);
            --success: #27ae60;
            --danger: #e74c3c;
            --light: #f8f8f8;
            --transition: all 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
            --shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            --glow: 0 0 15px rgba(212, 175, 55, 0.4);
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: radial-gradient(ellipse at center, #1a1a1a 0%, #0c0c0c 100%);
            color: var(--light);
            min-height: 100vh;
            overflow-x: hidden;
            line-height: 1.6;
            font-family: 'Montserrat', sans-serif;
            background-image: 
                radial-gradient(at 10% 20%, rgba(212, 175, 55, 0.05) 0, transparent 40%),
                radial-gradient(at 90% 80%, rgba(212, 175, 55, 0.05) 0, transparent 40%);
            position: relative;
        }
        
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url('https://www.transparenttextures.com/patterns/black-paper.png');
            opacity: 0.3;
            pointer-events: none;
            z-index: -1;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Loading overlay */
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(12, 11, 11, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            transition: opacity 0.5s ease;
        }
        
        .loading-spinner {
            width: 70px;
            height: 70px;
            border: 5px solid rgba(212, 175, 55, 0.2);
            border-radius: 50%;
            border-top-color: var(--gold-primary);
            animation: spin 1.2s ease-in-out infinite;
            margin-bottom: 25px;
        }
        
        .loading-text {
            color: var(--gold-primary);
            font-size: 1.3rem;
            font-weight: 500;
            letter-spacing: 1px;
            font-family: 'Playfair Display', serif;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        /* Auth Container */
        .auth-container {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            padding: 20px;
            position: relative;
        }
        
        .auth-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #1a1a1a 0%, #0c0c0c 100%);
            z-index: -1;
        }
        
        .auth-box {
            background: rgba(19, 17, 14, 0.85);
            border-radius: 20px;
            padding: 50px 45px;
            width: 100%;
            max-width: 500px;
            box-shadow: var(--shadow), var(--glow);
            border: 1px solid var(--card-border);
            backdrop-filter: blur(10px);
            position: relative;
            overflow: hidden;
        }
        
        .auth-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 5px;
            background: linear-gradient(to right, var(--gold-primary), var(--gold-secondary));
        }
        
        .auth-header {
            text-align: center;
            margin-bottom: 35px;
        }
        
        .logo {
            font-size: 3rem;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
            background: linear-gradient(to right, var(--gold-primary), #f1c40f);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
            letter-spacing: 1px;
        }
        
        .auth-subtitle {
            color: var(--gold-primary);
            font-size: 1.2rem;
            font-weight: 400;
            letter-spacing: 2px;
            text-transform: uppercase;
        }
        
        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 25px;
        }
        
        .form-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .form-label {
            font-size: 1rem;
            font-weight: 500;
            color: var(--gold-primary);
            letter-spacing: 0.5px;
        }
        
        .form-input {
            padding: 16px 20px;
            border-radius: 12px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            background: rgba(30, 28, 24, 0.5);
            color: var(--light);
            font-size: 1.05rem;
            transition: var(--transition);
            font-family: 'Montserrat', sans-serif;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--gold-primary);
            background: rgba(212, 175, 55, 0.1);
            box-shadow: 0 0 0 3px rgba(212, 175, 55, 0.2);
        }
        
        .form-hint {
            color: rgba(212, 175, 55, 0.7);
            font-size: 0.85rem;
            font-weight: 400;
        }
        
        .error-message {
            color: var(--danger);
            font-size: 0.95rem;
            font-weight: 500;
            text-align: center;
            padding: 10px 0;
            min-height: 40px;
        }
        
        .auth-btn {
            background: linear-gradient(to right, var(--gold-primary), var(--gold-secondary));
            color: #0c0b0b;
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
            font-family: 'Playfair Display', serif;
            letter-spacing: 1px;
            margin-top: 10px;
        }
        
        .auth-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.5);
        }
        
        .auth-footer {
            text-align: center;
            margin-top: 30px;
            color: rgba(255, 255, 255, 0.7);
            font-size: 1rem;
        }
        
        .auth-link {
            color: var(--gold-primary);
            text-decoration: none;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            position: relative;
        }
        
        .auth-link::after {
            content: "";
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 0;
            height: 1px;
            background: var(--gold-primary);
            transition: var(--transition);
        }
        
        .auth-link:hover::after {
            width: 100%;
        }
        
        /* Dashboard */
        .dashboard {
            display: none;
            min-height: 100vh;
            padding-bottom: 50px;
            position: relative;
        }
        
        .dashboard-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: radial-gradient(ellipse at center, #1a1a1a 0%, #0c0c0c 100%);
            z-index: -2;
        }
        
        header {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-between;
            align-items: center;
            gap: 25px;
            padding: 25px 0;
            margin-bottom: 25px;
            border-bottom: 1px solid rgba(212, 175, 55, 0.2);
        }
        
        .user-info {
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .user-avatar {
            width: 70px;
            height: 70px;
            border-radius: 50%;
            background: linear-gradient(to bottom right, var(--gold-primary), var(--gold-secondary));
            color: #0c0b0b;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 2rem;
            font-weight: 700;
            flex-shrink: 0;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
        }
        
        .user-name {
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--light);
            font-family: 'Playfair Display', serif;
            letter-spacing: 0.5px;
        }
        
        .user-email {
            font-size: 0.95rem;
            color: rgba(255, 255, 255, 0.7);
        }
        
        .balance-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }
        
        .balance-box {
            background: rgba(19, 17, 14, 0.8);
            border-radius: 16px;
            padding: 20px 25px;
            min-width: 220px;
            border: 1px solid var(--card-border);
            display: flex;
            flex-direction: column;
            transition: var(--transition);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .balance-box::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--gold-primary), var(--gold-secondary));
        }
        
        .balance-box:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow), var(--glow);
        }
        
        .balance-box#refreshBalanceBtn {
            cursor: pointer;
            align-items: center;
            justify-content: center;
            background: rgba(19, 17, 14, 0.8);
        }
        
        .balance-label {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
            color: var(--gold-primary);
            margin-bottom: 10px;
            font-weight: 500;
        }
        
        .balance-value {
            font-size: 2rem;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
        }
        
        .bonus-value {
            color: var(--gold-accent);
        }
        
        .withdrawable-value {
            color: var(--gold-primary);
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
        }
        
        .tab-btn {
            background: rgba(19, 17, 14, 0.8);
            color: rgba(255, 255, 255, 0.7);
            border: 1px solid var(--card-border);
            padding: 12px 25px;
            border-radius: 12px;
            font-size: 1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            align-items: center;
            gap: 10px;
            font-family: 'Montserrat', sans-serif;
        }
        
        .tab-btn:hover {
            background: rgba(212, 175, 55, 0.1);
            color: var(--gold-primary);
            border-color: var(--gold-primary);
        }
        
        .tab-btn.active {
            background: rgba(212, 175, 55, 0.15);
            color: var(--gold-primary);
            border-color: var(--gold-primary);
            box-shadow: var(--glow);
        }
        
        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 15px;
            margin-bottom: 40px;
            overflow-x: auto;
            padding-bottom: 15px;
        }
        
        .nav-tabs::-webkit-scrollbar {
            height: 8px;
        }
        
        .nav-tabs::-webkit-scrollbar-thumb {
            background: var(--gold-primary);
            border-radius: 4px;
        }
        
        .nav-tabs .tab-btn {
            white-space: nowrap;
        }
        
        /* Game Content */
        .game-content {
            display: none;
            animation: fadeIn 0.6s ease;
        }
        
        .game-content.active {
            display: block;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .game-header {
            margin-bottom: 35px;
            text-align: center;
            padding: 20px;
            background: rgba(19, 17, 14, 0.5);
            border-radius: 16px;
            border: 1px solid var(--card-border);
            position: relative;
        }
        
        .game-header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--gold-primary), var(--gold-secondary));
        }
        
        .game-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            font-family: 'Playfair Display', serif;
            background: linear-gradient(to right, var(--gold-primary), var(--gold-accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 1px;
        }
        
        .game-subtitle {
            color: rgba(255, 255, 255, 0.8);
            font-size: 1.2rem;
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.7;
        }
        
        /* Limbo Game */
        .limbo-game {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            margin-bottom: 50px;
        }
        
        @media (max-width: 992px) {
            .limbo-game {
                grid-template-columns: 1fr;
            }
        }
        
        .limbo-display {
            background: rgba(19, 17, 14, 0.6);
            border-radius: 20px;
            padding: 40px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 350px;
            border: 1px solid var(--card-border);
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        
        .limbo-display::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: linear-gradient(to right, var(--gold-primary), var(--gold-secondary));
        }
        
        .limbo-multiplier {
            font-size: 5rem;
            font-weight: 800;
            color: var(--gold-primary);
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.3);
            transition: var(--transition);
            font-family: 'Playfair Display', serif;
        }
        
        .limbo-multiplier.win {
            color: var(--gold-accent);
            text-shadow: 0 0 20px rgba(241, 196, 15, 0.4);
        }
        
        .limbo-multiplier.loss {
            color: var(--danger);
            text-shadow: 0 0 20px rgba(231, 76, 60, 0.3);
        }
        
        .limbo-controls {
            background: rgba(19, 17, 14, 0.6);
            border-radius: 20px;
            padding: 35px;
            border: 1px solid var(--card-border);
            display: flex;
            flex-direction: column;
            gap: 25px;
            box-shadow: var(--shadow);
        }
        
        .bet-controls {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .bet-amount, .target-multiplier {
            padding: 16px 20px;
            border-radius: 12px;
            border: 1px solid rgba(212, 175, 55, 0.3);
            background: rgba(30, 28, 24, 0.5);
            color: var(--light);
            font-size: 1.1rem;
            transition: var(--transition);
            width: 100%;
        }
        
        .balance-toggle {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px 0;
        }
        
        .balance-toggle input {
            width: 24px;
            height: 24px;
            accent-color: var(--gold-primary);
        }
        
        .play-btn {
            background: linear-gradient(to right, var(--gold-primary), var(--gold-secondary));
            color: #0c0b0b;
            border: none;
            padding: 18px;
            border-radius: 12px;
            font-size: 1.2rem;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 12px;
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);
            font-family: 'Playfair Display', serif;
            letter-spacing: 1px;
            margin-top: 10px;
        }
        
        .play-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(212, 175, 55, 0.5);
        }
        
        /* History */
        .history-container {
            background: rgba(19, 17, 14, 0.6);
            border-radius: 20px;
            padding: 30px;
            border: 1px solid var(--card-border);
            box-shadow: var(--shadow);
        }
        
        .history-title {
            display: flex;
            align-items: center;
            gap: 15px;
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--card-border);
            color: var(--gold-primary);
            font-family: 'Playfair Display', serif;
        }
        
        .history-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }
        
        .history-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px;
            border-radius: 12px;
            background: rgba(30, 28, 24, 0.5);
            font-size: 1rem;
            transition: var(--transition);
            border: 1px solid var(--card-border);
        }
        
        .history-item:hover {
            background: rgba(212, 175, 55, 0.1);
            transform: translateY(-3px);
        }
        
        .history-win {
            color: var(--gold-accent);
            font-weight: 600;
        }
        
        .history-loss {
            color: var(--danger);
            font-weight: 600;
        }
        
        /* Win Animation */
        .win-animation {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1;
        }
        
        .confetti {
            position: absolute;
            width: 12px;
            height: 12px;
            background: var(--gold-accent);
            border-radius: 2px;
            animation: confettiFall 2s ease-out forwards;
        }
        
        @keyframes confettiFall {
            0% {
                transform: translateY(-20px) rotate(0deg);
                opacity: 1;
            }
            100% {
                transform: translateY(300px) rotate(720deg);
                opacity: 0;
            }
        }
        
        /* Footer */
        .casino-footer {
            text-align: center;
            padding: 30px 0;
            margin-top: 50px;
            border-top: 1px solid rgba(212, 175, 55, 0.2);
            color: rgba(255, 255, 255, 0.6);
            font-size: 0.9rem;
        }
        
        .footer-logo {
            font-family: 'Playfair Display', serif;
            font-size: 2rem;
            margin-bottom: 15px;
            background: linear-gradient(to right, var(--gold-primary), var(--gold-accent));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: 2px;
        }
        
        /* Security badge */
        .security-badge {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: rgba(19, 17, 14, 0.8);
            padding: 14px 20px;
            border-radius: 12px;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 10px;
            border: 1px solid var(--card-border);
            backdrop-filter: blur(5px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
            z-index: 1000;
            color: var(--gold-primary);
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .balance-container {
                justify-content: center;
            }
            
            header {
                flex-direction: column;
                align-items: center;
                text-align: center;
            }
            
            .user-info {
                flex-direction: column;
                text-align: center;
            }
            
            .header-actions {
                width: 100%;
                justify-content: center;
            }
            
            .game-title {
                font-size: 2rem;
            }
            
            .game-subtitle {
                font-size: 1rem;
            }
        }
        
        /* Terms modal */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        
        .modal-content {
            background: var(--dark-bg);
            border-radius: 16px;
            padding: 30px;
            max-width: 800px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
            border: 1px solid var(--card-border);
            box-shadow: var(--shadow);
        }
        
        .modal-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            color: var(--gold-primary);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-title {
            font-size: 1.8rem;
            margin-bottom: 20px;
            color: var(--gold-primary);
            font-family: 'Playfair Display', serif;
        }
        
        .modal-text {
            line-height: 1.7;
            margin-bottom: 20px;
        }
        
        /* Responsive text for smaller screens */
        @media (max-width: 480px) {
            .auth-box {
                padding: 30px 20px;
            }
            
            .logo {
                font-size: 2.5rem;
            }
            
            .auth-subtitle {
                font-size: 1rem;
            }
            
            .user-avatar {
                width: 50px;
                height: 50px;
                font-size: 1.5rem;
            }
            
            .user-name {
                font-size: 1.2rem;
            }
            
            .balance-box {
                min-width: 100%;
            }
            
            .balance-value {
                font-size: 1.5rem;
            }
            
            .limbo-multiplier {
                font-size: 3.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Loading overlay -->
    <div class="loading-overlay" id="loadingOverlay">
        <div class="loading-spinner"></div>
        <div class="loading-text">Luxuria Casino</div>
    </div>
    
    <!-- Authentication Section -->
    <div class="auth-container" id="authSection">
        <div class="auth-bg"></div>
        <div class="auth-box" id="authBox">
            <div class="auth-header">
                <div class="logo">Luxuria</div>
                <p class="auth-subtitle">Premium Casino Experience</p>
            </div>
            
            <div id="loginForm">
                <form class="auth-form" id="loginFormElement">
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" id="loginEmail" placeholder="you@example.com" required autocomplete="email">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" id="loginPassword" placeholder="••••••••" required autocomplete="current-password">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">2FA Code (optional)</label>
                        <input type="text" class="form-input" id="login2FA" placeholder="123456" maxlength="6">
                    </div>
                    
                    <div class="error-message" id="loginError"></div>
                    
                    <button type="submit" class="auth-btn" id="loginBtn">
                        <i class="fas fa-sign-in-alt"></i> Sign In
                    </button>
                </form>
                
                <div class="auth-footer">
                    <p>Don't have an account? <a class="auth-link" id="showRegister">Sign Up</a></p>
                    <p><a class="auth-link" id="forgotPassword">Forgot Password?</a></p>
                </div>
            </div>
            
            <div id="registerForm" style="display: none;">
                <form class="auth-form" id="registerFormElement">
                    <div class="form-group">
                        <label class="form-label">Full Name</label>
                        <input type="text" class="form-input" id="registerName" placeholder="John Doe" required autocomplete="name">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Email Address</label>
                        <input type="email" class="form-input" id="registerEmail" placeholder="you@example.com" required autocomplete="email">
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Password</label>
                        <input type="password" class="form-input" id="registerPassword" placeholder="••••••••" required autocomplete="new-password">
                        <small class="form-hint">Minimum 8 characters with uppercase, lowercase, and number</small>
                    </div>
                    
                    <div class="form-group">
                        <label class="form-label">Confirm Password</label>
                        <input type="password" class="form-input" id="registerConfirm" placeholder="••••••••" required autocomplete="new-password">
                    </div>
                    
                    <div class="form-group">
                        <input type="checkbox" id="acceptTerms" required>
                        <label for="acceptTerms">I agree to the <a href="#" id="termsLink">Terms & Conditions</a> and <a href="#" id="privacyLink">Privacy Policy</a></label>
                    </div>
                    
                    <div class="error-message" id="registerError"></div>
                    
                    <button type="submit" class="auth-btn" id="registerBtn">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                </form>
                
                <div class="auth-footer">
                    <p>Already have an account? <a class="auth-link" id="showLogin">Sign In</a></p>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Main Dashboard -->
    <div class="dashboard" id="dashboard">
        <div class="dashboard-bg"></div>
        <div class="container">
            <header>
                <div class="user-info">
                    <div class="user-avatar" id="userAvatar">JD</div>
                    <div>
                        <div class="user-name" id="userName">John Doe</div>
                        <div class="user-email" id="userEmail">john.doe@example.com</div>
                    </div>
                </div>
                
                <div class="balance-container">
                    <div class="balance-box">
                        <div class="balance-label">
                            <i class="fas fa-coins"></i> BONUS BALANCE
                        </div>
                        <div class="balance-value bonus-value">$<span id="bonusBalance">50.00</span></div>
                    </div>
                    <div class="balance-box">
                        <div class="balance-label">
                            <i class="fas fa-wallet"></i> WITHDRAWABLE BALANCE
                        </div>
                        <div class="balance-value withdrawable-value">$<span id="withdrawableBalance">125.50</span></div>
                    </div>
                    <button class="balance-box" id="refreshBalanceBtn">
                        <i class="fas fa-sync-alt"></i> Refresh
                    </button>
                </div>
                
                <div class="header-actions">
                    <button class="tab-btn" id="signOutBtn">
                        <i class="fas fa-sign-out-alt"></i> Sign Out
                    </button>
                </div>
            </header>
            
            <div class="nav-tabs">
                <button class="tab-btn active" data-tab="limbo">
                    <i class="fas fa-chart-line"></i> Limbo
                </button>
                <button class="tab-btn" data-tab="wheel">
                    <i class="fas fa-trophy"></i> Wheel of Fortune
                </button>
                <button class="tab-btn" data-tab="burst">
                    <i class="fas fa-wind"></i> Balloon Burst
                </button>
                <button class="tab-btn" data-tab="account">
                    <i class="fas fa-user-cog"></i> Account
                </button>
            </div>
            
            <div class="game-container">
                <!-- Limbo Game -->
                <div class="game-content active" id="limboGame">
                    <div class="game-header">
                        <h2 class="game-title">LIMBO</h2>
                        <p class="game-subtitle">Predict the multiplier and win big! Set your target multiplier and see if you can beat the odds.</p>
                    </div>
                    <div class="limbo-game">
                        <div class="limbo-display">
                            <div class="limbo-multiplier" id="limboMultiplier">1.00x</div>
                            <div class="win-animation" id="limboWinAnimation"></div>
                        </div>
                        <div class="limbo-controls">
                            <div class="bet-controls">
                                <input type="number" class="bet-amount" id="limboBetAmount" placeholder="Bet Amount" value="5.00" min="0.1" step="0.1">
                                <input type="number" class="target-multiplier" id="limboTarget" placeholder="Target Multiplier" value="2.00" min="1.01" step="0.01">
                            </div>
                            <div class="balance-toggle">
                                <input type="checkbox" id="useBonusBalance">
                                <label for="useBonusBalance">Use Bonus Balance</label>
                            </div>
                            <button class="play-btn" id="playLimbo">
                                <i class="fas fa-play"></i> PLAY NOW
                            </button>
                        </div>
                    </div>
                    <div class="history-container">
                        <div class="history-title">
                            <i class="fas fa-history"></i> Recent Games
                        </div>
                        <div class="history-items" id="limboHistory">
                            <!-- History will be populated dynamically -->
                        </div>
                    </div>
                </div>
                
                <!-- Wheel of Fortune Game -->
                <div class="game-content" id="wheelGame">
                    <div class="game-header">
                        <h2 class="game-title">WHEEL OF FORTUNE</h2>
                        <p class="game-subtitle">Spin the wheel for a chance to win big! Prizes range from 2x to 100x your bet.</p>
                    </div>
                    <div style="text-align: center; padding: 40px;">
                        <div style="font-size: 1.2rem; margin-bottom: 30px; color: var(--gold-primary);">
                            This game is coming soon!
                        </div>
                        <div style="font-size: 4rem; color: var(--gold-accent);">
                            <i class="fas fa-spinner fa-spin"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Balloon Burst Game -->
                <div class="game-content" id="burstGame">
                    <div class="game-header">
                        <h2 class="game-title">BALLOON BURST</h2>
                        <p class="game-subtitle">Inflate the balloon to increase your multiplier, but don't let it pop!</p>
                    </div>
                    <div style="text-align: center; padding: 40px;">
                        <div style="font-size: 1.2rem; margin-bottom: 30px; color: var(--gold-primary);">
                            This game is coming soon!
                        </div>
                        <div style="font-size: 4rem; color: var(--gold-accent);">
                            <i class="fas fa-wind"></i>
                        </div>
                    </div>
                </div>
                
                <!-- Account Settings -->
                <div class="game-content" id="accountGame">
                    <div class="game-header">
                        <h2 class="game-title">ACCOUNT SETTINGS</h2>
                        <p class="game-subtitle">Manage your account details and preferences</p>
                    </div>
                    <div style="max-width: 600px; margin: 0 auto;">
                        <div class="history-container">
                            <div class="history-title">
                                <i class="fas fa-user"></i> Profile Information
                            </div>
                            <div style="padding: 20px;">
                                <div style="display: flex; align-items: center; gap: 20px; margin-bottom: 25px;">
                                    <div class="user-avatar" id="accountAvatar">JD</div>
                                    <div>
                                        <div class="user-name" id="accountName">John Doe</div>
                                        <div class="user-email" id="accountEmail">john.doe@example.com</div>
                                    </div>
                                </div>
                                
                                <div style="margin-bottom: 30px;">
                                    <div style="font-weight: 500; margin-bottom: 10px; color: var(--gold-primary);">Account Created</div>
                                    <div id="accountCreated">January 1, 2023</div>
                                </div>
                                
                                <div style="margin-bottom: 30px;">
                                    <div style="font-weight: 500; margin-bottom: 10px; color: var(--gold-primary);">Last Login</div>
                                    <div id="lastLogin">Today at 14:30</div>
                                </div>
                                
                                <button class="auth-btn" style="width: 100%;">
                                    <i class="fas fa-key"></i> Change Password
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="casino-footer">
                <div class="footer-logo">Luxuria</div>
                <p>© 2023 Luxuria Casino. All rights reserved. Gambling can be addictive, please play responsibly.</p>
            </div>
        </div>
    </div>
    
    <!-- Security badge -->
    <div class="security-badge">
        <i class="fas fa-shield-alt"></i> 256-bit SSL Encryption
    </div>
    
    <!-- Terms Modal -->
    <div class="modal-overlay" id="termsModal">
        <div class="modal-content">
            <button class="modal-close" id="closeTerms">
                <i class="fas fa-times"></i>
            </button>
            <h3 class="modal-title">Terms & Conditions</h3>
            <div class="modal-text">
                <p>Welcome to Luxuria Casino! These terms and conditions outline the rules and regulations for the use of our platform.</p>
                
                <h4 style="color: var(--gold-primary); margin: 20px 0 10px;">1. Acceptance of Terms</h4>
                <p>By accessing this website we assume you accept these terms and conditions. Do not continue to use Luxuria Casino if you do not agree to all of the terms and conditions stated on this page.</p>
                
                <h4 style="color: var(--gold-primary); margin: 20px 0 10px;">2. Eligibility</h4>
                <p>You must be at least 18 years of age to use this website. By using this website and by agreeing to these terms and conditions you warrant and represent that you are at least 18 years of age.</p>
                
                <h4 style="color: var(--gold-primary); margin: 20px 0 10px;">3. Account Responsibility</h4>
                <p>You are responsible for maintaining the confidentiality of your account and password and for restricting access to your computer. You agree to accept responsibility for all activities that occur under your account or password.</p>
                
                <h4 style="color: var(--gold-primary); margin: 20px 0 10px;">4. Responsible Gambling</h4>
                <p>We promote responsible gambling and support organizations that help problem gamblers. Please set your own limits and gamble responsibly.</p>
                
                <h4 style="color: var(--gold-primary); margin: 20px 0 10px;">5. Amendments</h4>
                <p>We reserve the right to amend these terms and conditions at any time. Any changes will be posted on this page.</p>
            </div>
            <button class="auth-btn" id="acceptTermsBtn">
                <i class="fas fa-check"></i> I Accept
            </button>
        </div>
    </div>
    
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBlh428ba5aSFt6x2pPkVjeEk5D6AbIU7Y",
            authDomain: "kheemz-fb9b6.firebaseapp.com",
            projectId: "kheemz-fb9b6",
            storageBucket: "kheemz-fb9b6.appspot.com",
            messagingSenderId: "593310501630",
            appId: "1:593310501630:web:c241a05e0d7c4a810173af",
            measurementId: "G-Q50WK6G76P"
        };
        
        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // Game state
        const gameState = {
            bonusBalance: 50.00,
            withdrawableBalance: 125.50,
            currentGame: 'limbo',
            gamesPlayed: 0,
            user: null,
            gameHistory: {
                limbo: [],
                wheel: [],
                burst: []
            }
        };
        
        // Show loading overlay
        function showLoading() {
            document.getElementById('loadingOverlay').style.display = 'flex';
        }
        
        // Hide loading overlay
        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }
        
        // Format currency
        function formatCurrency(amount) {
            return amount.toFixed(2);
        }
        
        // Update UI with current balances
        function updateBalances() {
            document.getElementById('bonusBalance').textContent = formatCurrency(gameState.bonusBalance);
            document.getElementById('withdrawableBalance').textContent = formatCurrency(gameState.withdrawableBalance);
        }
        
        // Create win animation
        function createWinAnimation(elementId) {
            const winAnimation = document.getElementById(elementId);
            winAnimation.innerHTML = '';
            for (let i = 0; i < 50; i++) {
                const confetti = document.createElement('div');
                confetti.classList.add('confetti');
                confetti.style.left = Math.random() * 100 + '%';
                confetti.style.top = Math.random() * 100 + '%';
                confetti.style.backgroundColor = `hsl(${Math.random() * 60 + 30}, 100%, 50%)`; // Gold colors
                confetti.style.animation = `confettiFall ${1 + Math.random() * 3}s forwards`;
                winAnimation.appendChild(confetti);
            }
            
            setTimeout(() => {
                winAnimation.innerHTML = '';
            }, 3000);
        }
        
        // Show toast notifications
        function setupToastr() {
            toastr.options = {
                closeButton: true,
                progressBar: true,
                positionClass: 'toast-bottom-right',
                timeOut: 5000,
                extendedTimeOut: 2000
            };
        }
        
        // Initialize the game
        function initGame() {
            setupToastr();
            
            // Update balances
            updateBalances();
            
            // Tab switching
            document.querySelectorAll('.tab-btn[data-tab]').forEach(button => {
                button.addEventListener('click', () => {
                    // Remove active class from all buttons
                    document.querySelectorAll('.tab-btn').forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    // Add active class to clicked button
                    button.classList.add('active');
                    
                    // Hide all game content
                    document.querySelectorAll('.game-content').forEach(content => {
                        content.classList.remove('active');
                    });
                    
                    // Show selected game content
                    const gameId = button.getAttribute('data-tab');
                    document.getElementById(`${gameId}Game`).classList.add('active');
                    gameState.currentGame = gameId;
                });
            });
            
            // Play Limbo game
            document.getElementById('playLimbo').addEventListener('click', playLimbo);
            
            // Sign out button
            document.getElementById('signOutBtn').addEventListener('click', signOut);
            
            // Refresh balance button
            document.getElementById('refreshBalanceBtn').addEventListener('click', function() {
                showLoading();
                setTimeout(() => {
                    hideLoading();
                    toastr.success('Balances refreshed');
                }, 1000);
            });
            
            // Toggle between login and register forms
            document.getElementById('showRegister').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('loginForm').style.display = 'none';
                document.getElementById('registerForm').style.display = 'block';
                document.getElementById('registerError').textContent = '';
            });
            
            document.getElementById('showLogin').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('registerForm').style.display = 'none';
                document.getElementById('loginForm').style.display = 'block';
                document.getElementById('loginError').textContent = '';
            });
            
            // Terms and conditions modal
            document.getElementById('termsLink').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('termsModal').classList.add('active');
            });
            
            document.getElementById('privacyLink').addEventListener('click', function(e) {
                e.preventDefault();
                document.getElementById('termsModal').classList.add('active');
            });
            
            document.getElementById('closeTerms').addEventListener('click', function() {
                document.getElementById('termsModal').classList.remove('active');
            });
            
            document.getElementById('acceptTermsBtn').addEventListener('click', function() {
                document.getElementById('termsModal').classList.remove('active');
                document.getElementById('acceptTerms').checked = true;
            });
            
            // Close modal when clicking outside
            document.getElementById('termsModal').addEventListener('click', function(e) {
                if (e.target === this) {
                    this.classList.remove('active');
                }
            });
            
            // Initialize history
            updateHistory();
        }
        
        // Update game history
        function updateHistory() {
            const historyContainer = document.getElementById('limboHistory');
            historyContainer.innerHTML = '';
            
            gameState.gameHistory.limbo.forEach(game => {
                const historyItem = document.createElement('div');
                historyItem.classList.add('history-item');
                
                if (game.win) {
                    historyItem.innerHTML = `
                        <span><i class="fas fa-arrow-up"></i> WIN ${game.multiplier.toFixed(2)}x</span>
                        <span class="history-win">+$${formatCurrency(game.winAmount)}</span>
                    `;
                } else {
                    historyItem.innerHTML = `
                        <span><i class="fas fa-arrow-down"></i> LOSS ${game.multiplier.toFixed(2)}x</span>
                        <span class="history-loss">-$${formatCurrency(game.bet)}</span>
                    `;
                }
                
                historyContainer.appendChild(historyItem);
            });
        }
        
        // Sign out function
        function signOut() {
            auth.signOut().then(() => {
                document.getElementById('authSection').style.display = 'flex';
                document.getElementById('dashboard').style.display = 'none';
                toastr.info('You have been signed out');
            }).catch((error) => {
                console.error('Sign out error:', error);
                toastr.error('Could not sign out. Please try again.');
            });
        }
        
        // Enhanced Limbo game function
        function playLimbo() {
            const betAmount = parseFloat(document.getElementById('limboBetAmount').value);
            const targetMultiplier = parseFloat(document.getElementById('limboTarget').value);
            const useBonus = document.getElementById('useBonusBalance').checked;
            const multiplierElement = document.getElementById('limboMultiplier');
            
            // Validate bet
            if (isNaN(betAmount) {
                toastr.error('Please enter a valid bet amount');
                return;
            }
            
            if (betAmount <= 0) {
                toastr.error('Bet amount must be greater than zero');
                return;
            }
            
            if (targetMultiplier < 1.01) {
                toastr.error('Target multiplier must be at least 1.01x');
                return;
            }
            
            // Check balance
            if (useBonus && betAmount > gameState.bonusBalance) {
                toastr.error('Not enough bonus balance');
                return;
            }
            
            if (!useBonus && betAmount > gameState.withdrawableBalance) {
                toastr.error('Not enough withdrawable balance');
                return;
            }
            
            // Simulate server request
            showLoading();
            const playBtn = document.getElementById('playLimbo');
            playBtn.disabled = true;
            
            setTimeout(() => {
                // Deduct bet amount
                if (useBonus) {
                    gameState.bonusBalance -= betAmount;
                } else {
                    gameState.withdrawableBalance -= betAmount;
                }
                updateBalances();
                
                // Generate random multiplier (0.1x to 100x)
                const minMultiplier = 0.1;
                const maxMultiplier = 100;
                const winProbability = 1 - (targetMultiplier / maxMultiplier);
                const win = Math.random() < winProbability;
                
                const actualMultiplier = win ? 
                    Math.max(targetMultiplier, (minMultiplier + Math.random() * (maxMultiplier - minMultiplier))) : 
                    (minMultiplier + Math.random() * (targetMultiplier - minMultiplier - 0.01));
                
                // Reset multiplier display
                multiplierElement.textContent = '1.00x';
                multiplierElement.className = 'limbo-multiplier';
                
                // Animate multiplier
                let current = 1.00;
                const interval = setInterval(() => {
                    current += 0.05;
                    multiplierElement.textContent = current.toFixed(2) + 'x';
                    
                    if (current >= actualMultiplier) {
                        clearInterval(interval);
                        multiplierElement.textContent = actualMultiplier.toFixed(2) + 'x';
                        
                        // Calculate win
                        const winAmount = win ? betAmount * targetMultiplier : 0;
                        
                        // Update balances
                        if (win) {
                            gameState.withdrawableBalance += winAmount;
                            
                            // Show win animation and styling
                            multiplierElement.classList.add('win');
                            createWinAnimation('limboWinAnimation');
                            toastr.success(`You won $${formatCurrency(winAmount)}!`);
                        } else {
                            multiplierElement.classList.add('loss');
                            toastr.info('Better luck next time!');
                        }
                        
                        // Add to history
                        gameState.gameHistory.limbo.unshift({
                            bet: betAmount,
                            target: targetMultiplier,
                            multiplier: actualMultiplier,
                            win: win,
                            winAmount: winAmount,
                            timestamp: new Date().toLocaleString()
                        });
                        
                        // Keep only the last 10 history items
                        if (gameState.gameHistory.limbo.length > 10) {
                            gameState.gameHistory.limbo.pop();
                        }
                        
                        updateHistory();
                        updateBalances();
                        
                        // Increment games played
                        gameState.gamesPlayed++;
                        
                        playBtn.disabled = false;
                        hideLoading();
                        
                        // Save game result to Firestore
                        if (gameState.user) {
                            const gameData = {
                                game: 'limbo',
                                bet: betAmount,
                                target: targetMultiplier,
                                multiplier: actualMultiplier,
                                win: win,
                                winAmount: winAmount,
                                timestamp: firebase.firestore.FieldValue.serverTimestamp()
                            };
                            
                            db.collection('users').doc(gameState.user.uid).collection('games').add(gameData)
                                .then(() => console.log('Game saved to Firestore'))
                                .catch(error => console.error('Error saving game:', error));
                        }
                    }
                }, 20);
            }, 1500); // Simulate server delay
        }
        
        // Enhanced sign-in with Firebase
        document.getElementById('loginFormElement').addEventListener('submit', (e) => {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            const twoFACode = document.getElementById('login2FA').value;
            const errorElement = document.getElementById('loginError');
            
            showLoading();
            
            // Firebase authentication
            auth.signInWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    gameState.user = user;
                    
                    // Save user to Firestore
                    const userRef = db.collection('users').doc(user.uid);
                    userRef.get().then(doc => {
                        if (!doc.exists) {
                            // Create new user document
                            userRef.set({
                                name: user.email.split('@')[0],
                                email: user.email,
                                bonusBalance: 50.00,
                                withdrawableBalance: 0.00,
                                createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                                lastLogin: firebase.firestore.FieldValue.serverTimestamp(),
                                gamesPlayed: 0
                            });
                        } else {
                            // Update last login
                            userRef.update({
                                lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                            });
                        }
                        
                        // Load user data
                        return userRef.get();
                    }).then(doc => {
                        if (doc.exists) {
                            const userData = doc.data();
                            gameState.bonusBalance = userData.bonusBalance;
                            gameState.withdrawableBalance = userData.withdrawableBalance;
                            gameState.gamesPlayed = userData.gamesPlayed || 0;
                            
                            // Load game history
                            db.collection('users').doc(user.uid).collection('games')
                                .where('game', '==', 'limbo')
                                .orderBy('timestamp', 'desc')
                                .limit(10)
                                .get()
                                .then(querySnapshot => {
                                    gameState.gameHistory.limbo = [];
                                    querySnapshot.forEach(doc => {
                                        const game = doc.data();
                                        gameState.gameHistory.limbo.push({
                                            bet: game.bet,
                                            target: game.target,
                                            multiplier: game.multiplier,
                                            win: game.win,
                                            winAmount: game.winAmount,
                                            timestamp: game.timestamp.toDate().toLocaleString()
                                        });
                                    });
                                    
                                    hideLoading();
                                    document.getElementById('authSection').style.display = 'none';
                                    document.getElementById('dashboard').style.display = 'block';
                                    
                                    // Set user info
                                    document.getElementById('userName').textContent = userData.name;
                                    document.getElementById('userEmail').textContent = user.email;
                                    document.getElementById('userAvatar').textContent = userData.name[0].toUpperCase();
                                    
                                    document.getElementById('accountName').textContent = userData.name;
                                    document.getElementById('accountEmail').textContent = user.email;
                                    document.getElementById('accountAvatar').textContent = userData.name[0].toUpperCase();
                                    document.getElementById('accountCreated').textContent = userData.createdAt ? userData.createdAt.toDate().toLocaleDateString() : 'Unknown';
                                    document.getElementById('lastLogin').textContent = userData.lastLogin ? userData.lastLogin.toDate().toLocaleString() : 'Just now';
                                    
                                    // Initialize game
                                    initGame();
                                });
                        } else {
                            hideLoading();
                            toastr.error('User data not found');
                        }
                    });
                })
                .catch((error) => {
                    hideLoading();
                    const errorCode = error.code;
                    let errorMessage = "Login failed. Please try again.";
                    
                    if (errorCode === 'auth/user-not-found') {
                        errorMessage = "No account found with this email.";
                    } else if (errorCode === 'auth/wrong-password') {
                        errorMessage = "Incorrect password.";
                    } else if (errorCode === 'auth/too-many-requests') {
                        errorMessage = "Too many login attempts. Try again later.";
                    }
                    
                    errorElement.textContent = errorMessage;
                    toastr.error(errorMessage);
                });
        });
        
        // Enhanced registration with Firebase
        document.getElementById('registerFormElement').addEventListener('submit', (e) => {
            e.preventDefault();
            const name = document.getElementById('registerName').value;
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirm = document.getElementById('registerConfirm').value;
            const errorElement = document.getElementById('registerError');
            
            if (password !== confirm) {
                errorElement.textContent = 'Passwords do not match';
                toastr.error('Passwords do not match');
                return;
            }
            
            if (password.length < 8) {
                errorElement.textContent = 'Password must be at least 8 characters';
                toastr.error('Password must be at least 8 characters');
                return;
            }
            
            if (!/[A-Z]/.test(password)) {
                errorElement.textContent = 'Password must contain an uppercase letter';
                toastr.error('Password must contain an uppercase letter');
                return;
            }
            
            if (!/[a-z]/.test(password)) {
                errorElement.textContent = 'Password must contain a lowercase letter';
                toastr.error('Password must contain a lowercase letter');
                return;
            }
            
            if (!/[0-9]/.test(password)) {
                errorElement.textContent = 'Password must contain a number';
                toastr.error('Password must contain a number');
                return;
            }
            
            showLoading();
            
            // Firebase user creation
            auth.createUserWithEmailAndPassword(email, password)
                .then((userCredential) => {
                    const user = userCredential.user;
                    gameState.user = user;
                    
                    // Create user document in Firestore
                    db.collection('users').doc(user.uid).set({
                        name: name,
                        email: email,
                        bonusBalance: 50.00,
                        withdrawableBalance: 0.00,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastLogin: firebase.firestore.FieldValue.serverTimestamp(),
                        gamesPlayed: 0
                    }).then(() => {
                        hideLoading();
                        toastr.success('Account created successfully!');
                        
                        // Update UI
                        document.getElementById('authSection').style.display = 'none';
                        document.getElementById('dashboard').style.display = 'block';
                        
                        // Set user info
                        document.getElementById('userName').textContent = name;
                        document.getElementById('userEmail').textContent = email;
                        document.getElementById('userAvatar').textContent = name[0].toUpperCase();
                        
                        document.getElementById('accountName').textContent = name;
                        document.getElementById('accountEmail').textContent = email;
                        document.getElementById('accountAvatar').textContent = name[0].toUpperCase();
                        document.getElementById('accountCreated').textContent = new Date().toLocaleDateString();
                        document.getElementById('lastLogin').textContent = 'Just now';
                        
                        // Set initial balances
                        gameState.bonusBalance = 50.00;
                        gameState.withdrawableBalance = 0.00;
                        updateBalances();
                        
                        // Initialize game
                        initGame();
                    }).catch(error => {
                        hideLoading();
                        console.error('Error creating user document:', error);
                        toastr.error('Failed to create user account. Please try again.');
                    });
                })
                .catch((error) => {
                    hideLoading();
                    const errorCode = error.code;
                    let errorMessage = "Registration failed. Please try again.";
                    
                    if (errorCode === 'auth/email-already-in-use') {
                        errorMessage = "Email is already registered.";
                    } else if (errorCode === 'auth/invalid-email') {
                        errorMessage = "Invalid email address.";
                    } else if (errorCode === 'auth/weak-password') {
                        errorMessage = "Password is too weak.";
                    }
                    
                    errorElement.textContent = errorMessage;
                    toastr.error(errorMessage);
                });
        });
        
        // Initialize when page loads
        window.addEventListener('load', () => {
            // Hide loading after 1.5 seconds
            setTimeout(() => {
                document.getElementById('loadingOverlay').style.display = 'none';
            }, 1500);
            
            // Check if user is already signed in
            auth.onAuthStateChanged((user) => {
                if (user) {
                    gameState.user = user;
                    
                    // Load user data from Firestore
                    db.collection('users').doc(user.uid).get()
                        .then(doc => {
                            if (doc.exists) {
                                const userData = doc.data();
                                gameState.bonusBalance = userData.bonusBalance;
                                gameState.withdrawableBalance = userData.withdrawableBalance;
                                gameState.gamesPlayed = userData.gamesPlayed || 0;
                                
                                // Set user info
                                document.getElementById('userName').textContent = userData.name;
                                document.getElementById('userEmail').textContent = user.email;
                                document.getElementById('userAvatar').textContent = userData.name[0].toUpperCase();
                                
                                document.getElementById('accountName').textContent = userData.name;
                                document.getElementById('accountEmail').textContent = user.email;
                                document.getElementById('accountAvatar').textContent = userData.name[0].toUpperCase();
                                document.getElementById('accountCreated').textContent = userData.createdAt ? userData.createdAt.toDate().toLocaleDateString() : 'Unknown';
                                document.getElementById('lastLogin').textContent = userData.lastLogin ? userData.lastLogin.toDate().toLocaleString() : 'Just now';
                                
                                // Load game history
                                db.collection('users').doc(user.uid).collection('games')
                                    .where('game', '==', 'limbo')
                                    .orderBy('timestamp', 'desc')
                                    .limit(10)
                                    .get()
                                    .then(querySnapshot => {
                                        gameState.gameHistory.limbo = [];
                                        querySnapshot.forEach(doc => {
                                            const game = doc.data();
                                            gameState.gameHistory.limbo.push({
                                                bet: game.bet,
                                                target: game.target,
                                                multiplier: game.multiplier,
                                                win: game.win,
                                                winAmount: game.winAmount,
                                                timestamp: game.timestamp.toDate().toLocaleString()
                                            });
                                        });
                                        
                                        document.getElementById('authSection').style.display = 'none';
                                        document.getElementById('dashboard').style.display = 'block';
                                        initGame();
                                    });
                            } else {
                                // Create user document if it doesn't exist
                                db.collection('users').doc(user.uid).set({
                                    name: user.email.split('@')[0],
                                    email: user.email,
                                    bonusBalance: 50.00,
                                    withdrawableBalance: 0.00,
                                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                                    lastLogin: firebase.firestore.FieldValue.serverTimestamp(),
                                    gamesPlayed: 0
                                }).then(() => {
                                    document.getElementById('authSection').style.display = 'none';
                                    document.getElementById('dashboard').style.display = 'block';
                                    initGame();
                                });
                            }
                        });
                } else {
                    document.getElementById('authSection').style.display = 'flex';
                }
            });
        });
    </script>
</body>
</html>
